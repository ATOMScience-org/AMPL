

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pipeline package &mdash; ATOM Data-Driven Modeling Pipeline 1.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="utils package" href="utils.html" />
    <link rel="prev" title="atomsci" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ATOM Data-Driven Modeling Pipeline
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="guide/getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide/tests.html">Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide/running_ampl.html">Running AMPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide/advanced_ampl_usage.html">Advanced AMPL Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide/advanced_installation.html">Advanced Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide/advanced_testing.html">Advanced Testing</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">atomsci</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">pipeline package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.ave_splitter">pipeline.ave_splitter module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.chem_diversity">pipeline.chem_diversity module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.compare_models">pipeline.compare_models module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.dist_metrics">pipeline.dist_metrics module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.diversity_plots">pipeline.diversity_plots module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.featurization">pipeline.featurization module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.model_datasets">pipeline.model_datasets module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.model_pipeline">pipeline.model_pipeline module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.model_tracker">pipeline.model_tracker module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.model_wrapper">pipeline.model_wrapper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.parameter_parser">pipeline.parameter_parser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.perf_data">pipeline.perf_data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.perf_plots">pipeline.perf_plots module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.splitting">pipeline.splitting module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline.transformations">pipeline.transformations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pipeline">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils package</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ATOM Data-Driven Modeling Pipeline</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">atomsci</a> &raquo;</li>
        
      <li>pipeline package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/pipeline.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pipeline-package">
<h1>pipeline package<a class="headerlink" href="#pipeline-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pipeline.ave_splitter">
<span id="pipeline-ave-splitter-module"></span><h2>pipeline.ave_splitter module<a class="headerlink" href="#module-pipeline.ave_splitter" title="Permalink to this headline">¶</a></h2>
<p>Code to split a DeepChem dataset in such a way as to minimize the AVE bias, as described in <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jcim.7b00403">this paper by Wallach &amp; Heifets</a></p>
<p>Although the AVEMinSplitter class and its methods are public, you will typically not call them directly. Instead, they are invoked by
setting <cite>splitter</cite> to ‘ave_min’ in the model parameters when you train a model.</p>
<dl class="py class">
<dt id="pipeline.ave_splitter.AVEMinSplitter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.ave_splitter.</span></code><code class="sig-name descname"><span class="pre">AVEMinSplitter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jaccard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/ave_splitter.html#AVEMinSplitter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.ave_splitter.AVEMinSplitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">deepchem.splits.splitters.Splitter</span></code></p>
<p>Class for splitting a DeepChem dataset in order to minimize the Asymmetric Validation Embedding bias.</p>
<p>Uses distances between feature vectors and binary classifications to compute
the AVE bias for a candidate split and find a split that minimizes the bias.</p>
<dl>
<dt>Attributes:</dt><dd><p>metric (str): Name of the metric to be used to compute distances between feature vectors.</p>
<p>verbose (bool): Ignored.</p>
<p>num_workers (int): Number of threads to use to parallelize computations.</p>
<p>max_iter (int): Maximmum number of iterations to execute to try to minimize bias.</p>
<p>ndist (int): Number of points to use to approximate CDF of distance distribution.</p>
<p>debug_mode (bool): If true, generate extra plots and log messages for debugging.</p>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.ave_splitter.AVEMinSplitter.split">
<code class="sig-name descname"><span class="pre">split</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_valid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_every_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/ave_splitter.html#AVEMinSplitter.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.ave_splitter.AVEMinSplitter.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split dataset into training and validation sets that minimize the AVE bias. A test set is not generated;
to do a 3-way split, call this function twice.</p>
<dl>
<dt>Args:</dt><dd><p>dataset (dc.Dataset): The DeepChem dataset to be split</p>
<p>frac_train (float): The approximate fraction of compounds to put in the training set</p>
<p>frac_valid (float): The approximate fraction of compounds to put in the validation or test set</p>
<p>frac_test (float): Ignored; included only for compatibility with the DeepChem Splitter API</p>
<p>log_every_n (int or None): Ignored</p>
<p>verbose (bool): Ignored</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: Lists of indices of compounds assigned to the training and validation/test sets.</p>
<p>The third element of the tuple is an empty list, because this function only does a 2-way split.</p>
</dd>
<dt>Todo:</dt><dd><p>Change code to do a 3-way split in one call, rather than requiring the distance matrices to be computed twice.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pipeline.ave_splitter.analyze_split">
<code class="sig-prename descclassname"><span class="pre">pipeline.ave_splitter.</span></code><code class="sig-name descname"><span class="pre">analyze_split</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'compound_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdkit_smiles'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'active'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/ave_splitter.html#analyze_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.ave_splitter.analyze_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the AVE bias for the training/validation and training/test set splits of the given dataset.</p>
<p>Also show the active frequencies in each subset and for the dataset as a whole.
id_col, smiles_col and active_col are defaults to be used in case they aren’t found in the dataset metadata; if found
the metadata values are used instead.</p>
<dl>
<dt>Args:</dt><dd><p>params (argparse.Namespace): Pipeline parameters.</p>
<p>id_col (str): Dataset column containing compound IDs.</p>
<p>smiles_col (str): Dataset column containing SMILES strings.</p>
<p>active_col (str): Dataset column containing binary classifications.</p>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>: Table of split subsets showing sizes, numbers and fractions of active compounds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.ave_splitter.permutation">
<code class="sig-prename descclassname"><span class="pre">pipeline.ave_splitter.</span></code><code class="sig-name descname"><span class="pre">permutation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.ave_splitter.permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly permute a sequence, or return a permuted range.</p>
<p>If <cite>x</cite> is a multi-dimensional array, it is only shuffled along its
first index.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>New code should use the <code class="docutils literal notranslate"><span class="pre">permutation</span></code> method of a <code class="docutils literal notranslate"><span class="pre">default_rng()</span></code>
instance instead; please see the <span class="xref std std-ref">random-quick-start</span>.</p>
</div>
<dl class="simple">
<dt>x<span class="classifier">int or array_like</span></dt><dd><p>If <cite>x</cite> is an integer, randomly permute <code class="docutils literal notranslate"><span class="pre">np.arange(x)</span></code>.
If <cite>x</cite> is an array, make a copy and shuffle the elements
randomly.</p>
</dd>
</dl>
<dl class="simple">
<dt>out<span class="classifier">ndarray</span></dt><dd><p>Permuted sequence or array range.</p>
</dd>
</dl>
<p>Generator.permutation: which should be used for new code.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">array([1, 7, 4, 3, 0, 9, 2, 5, 8, 6]) # random</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="go">array([15,  1,  9,  4, 12]) # random</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">array([[6, 7, 8], # random</span>
<span class="go">       [0, 1, 2],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pipeline.ave_splitter.shuffle">
<code class="sig-prename descclassname"><span class="pre">pipeline.ave_splitter.</span></code><code class="sig-name descname"><span class="pre">shuffle</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.ave_splitter.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify a sequence in-place by shuffling its contents.</p>
<p>This function only shuffles the array along the first axis of a
multi-dimensional array. The order of sub-arrays is changed but
their contents remains the same.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>New code should use the <code class="docutils literal notranslate"><span class="pre">shuffle</span></code> method of a <code class="docutils literal notranslate"><span class="pre">default_rng()</span></code>
instance instead; please see the <span class="xref std std-ref">random-quick-start</span>.</p>
</div>
<dl class="simple">
<dt>x<span class="classifier">array_like</span></dt><dd><p>The array or list to be shuffled.</p>
</dd>
</dl>
<p>None</p>
<p>Generator.shuffle: which should be used for new code.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">[1 7 5 2 9 4 3 6 0 8] # random</span>
</pre></div>
</div>
<p>Multi-dimensional arrays are only shuffled along the first axis:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">array([[3, 4, 5], # random</span>
<span class="go">       [6, 7, 8],</span>
<span class="go">       [0, 1, 2]])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pipeline.chem_diversity">
<span id="pipeline-chem-diversity-module"></span><h2>pipeline.chem_diversity module<a class="headerlink" href="#module-pipeline.chem_diversity" title="Permalink to this headline">¶</a></h2>
<p>Functions to generate matrices or vectors of distances between compounds</p>
<dl class="py function">
<dt id="pipeline.chem_diversity.calc_dist_diskdataset">
<code class="sig-prename descclassname"><span class="pre">pipeline.chem_diversity.</span></code><code class="sig-name descname"><span class="pre">calc_dist_diskdataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_met</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nearest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">metric_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/chem_diversity.html#calc_dist_diskdataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.chem_diversity.calc_dist_diskdataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of distances, either between all compounds in a single dataset or between two datasets, given
as DeepChem Dataset objects.</p>
<dl>
<dt>Args:</dt><dd><p>feat_type (str): How the data was featurized. Current options are ‘ECFP’ or ‘descriptors’.</p>
<p>dist_met (str): What distance metric to use. Current options include tanimoto, cosine, cityblock, euclidean, or any
other metric supported by scipy.spatial.distance.pdist().</p>
<p>dataset1 (deepchem.Dataset): Dataset containing features of compounds to be compared.</p>
<p>dataset2 (deepchem.Dataset, optional): Second dataset, if two datasets are to be compared.</p>
<p>calc_type (str): Type of summarization to perform on rows of distance matrix. See function calc_summary for options.</p>
<p>num_nearest (int): Additional parameter for calc_types nearest, nth_nearest and avg_n_nearest.</p>
<p>metric_kwargs: Additional arguments to be passed to functions that calculate metrics.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Vector or matrix of distances between feature vectors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.chem_diversity.calc_dist_feat_array">
<code class="sig-prename descclassname"><span class="pre">pipeline.chem_diversity.</span></code><code class="sig-name descname"><span class="pre">calc_dist_feat_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_met</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nearest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">metric_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/chem_diversity.html#calc_dist_feat_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.chem_diversity.calc_dist_feat_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector or array of distances, either between all compounds in a single dataset or between two datasets,
given the feature matrices for the dataset(s).</p>
<dl>
<dt>Args:</dt><dd><p>feat_type (str): How the data was featurized. Current options are ‘ECFP’ or ‘descriptors’.</p>
<p>dist_met (str): What distance metric to use. Current options include tanimoto, cosine, cityblock, euclidean, or any
other metric supported by scipy.spatial.distance.pdist().</p>
<p>feat1: feature matrix as a numpy array</p>
<p>feat2: Optional, second feature matrix</p>
<p>calc_type (str): Type of summarization to perform on rows of distance matrix. See function calc_summary for options.</p>
<p>num_nearest (int): Additional parameter for calc_types nearest, nth_nearest and avg_n_nearest.</p>
<p>metric_kwargs: Additional arguments to be passed to functions that calculate metrics.</p>
</dd>
<dt>Returns:</dt><dd><p>dists: vector or array of distances</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.chem_diversity.calc_dist_smiles">
<code class="sig-prename descclassname"><span class="pre">pipeline.chem_diversity.</span></code><code class="sig-name descname"><span class="pre">calc_dist_smiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_met</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_arr2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nearest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">metric_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/chem_diversity.html#calc_dist_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.chem_diversity.calc_dist_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of distances between compounds given as SMILES strings, either between all pairs of compounds in a
single dataset or between two datasets.</p>
<dl>
<dt>Args:</dt><dd><p>feat_type (str): How the data is to be featurized, if dist_met is not ‘mcs’. The only option supported currently is ‘ECFP’.</p>
<p>dist_met (str): What distance metric to use. Current options include ‘tanimoto’ and ‘mcs’.</p>
<p>smiles_arr1 (list): First list of SMILES strings.</p>
<p>smiles_arr2 (list): Optional, second list of SMILES strings. Can have only 1 member if wanting compound to
matrix comparison.</p>
<p>calc_type (str): Type of summarization to perform on rows of distance matrix. See function calc_summary for options.</p>
<p>num_nearest (int): Additional parameter for calc_types nearest, nth_nearest and avg_n_nearest.</p>
<p>metric_kwargs: Additional arguments to be passed to functions that calculate metrics.</p>
</dd>
<dt>Returns:</dt><dd><p>dists: vector or array of distances</p>
</dd>
<dt>Todo:</dt><dd><p>Fix the function _get_descriptors(), which is broken, and re-enable the ‘descriptors’ option for feat_type. Will need
to add a parameter to indicate what kind of descriptors should be computed.</p>
<p>Allow other metrics for ECFP features, as in calc_dist_diskdataset().</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.chem_diversity.calc_summary">
<code class="sig-prename descclassname"><span class="pre">pipeline.chem_diversity.</span></code><code class="sig-name descname"><span class="pre">calc_summary</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nearest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">within_dset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/chem_diversity.html#calc_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.chem_diversity.calc_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a summary of the distances in dist_arr, depending on calc_type.</p>
<dl>
<dt>Args:</dt><dd><p>dist_arr: (np.array): Either a 2D distance matrix, or a 1D condensed distance matrix (flattened upper triangle).</p>
<p>calc_type (str): The type of summary values to return:</p>
<blockquote>
<div><p>all:            The distance matrix itself</p>
<p>nearest:        The distances to the num_nearest nearest neighbors of each compound (except compound itself)</p>
<p>nth_nearest:    The distance to the num_nearest’th nearest neighbor</p>
<p>avg_n_nearest:  The average of the num_nearest nearest neighbor distances</p>
<p>farthest:       The distance to the farthest neighbor</p>
<p>avg:            The average of all distances for each compound</p>
</div></blockquote>
<p>num_nearest (int):  Additional parameter for calc_types nearest, nth_nearest and avg_n_nearest.</p>
<p>within_dset (bool): True if input distances are between compounds in the same dataset.</p>
</dd>
</dl>
<p>Returns:</p>
<blockquote>
<div><p>dists (np.array):  A numpy array of distances. For calc_type ‘nearest’ with num_nearest &gt; 1, this is a 2D array
with a row for each compound; otherwise it is a 1D array.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pipeline.chem_diversity.upload_distmatrix_to_DS">
<code class="sig-prename descclassname"><span class="pre">pipeline.chem_diversity.</span></code><code class="sig-name descname"><span class="pre">upload_distmatrix_to_DS</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compound_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/chem_diversity.html#upload_distmatrix_to_DS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.chem_diversity.upload_distmatrix_to_DS" title="Permalink to this definition">¶</a></dt>
<dd><p>Uploads distance matrix in the data store with the appropriate tags</p>
<dl>
<dt>Args:</dt><dd><p>dist_matrix (np.ndarray): The distance matrix.</p>
<p>feature_type (str): How the data was featurized.</p>
<p>dist_met (str): What distance metric was used.</p>
<p>compound_ids (list): list of compound ids corresponding to the distance matrix (assumes that distance matrix is square
and is the distance between all compounds in a dataset)</p>
<p>bucket (str): bucket the file will be put in</p>
<p>title (str): title of the file in (human friendly format)</p>
<p>description (str): long text box to describe file (background/use notes)</p>
<p>tags (list): List of tags to assign to datastore object.</p>
<p>key_values (dict): Dictionary of key:value pairs to include in the datastore object’s metadata.</p>
<p>filepath (str): local path where you want to store the pickled dataframe</p>
<dl class="simple">
<dt>dataset_key (str): If updating a file already in the datastore enter the corresponding dataset_key.</dt><dd><p>If not, leave as ‘none’ and the dataset_key will be automatically generated.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.compare_models">
<span id="pipeline-compare-models-module"></span><h2>pipeline.compare_models module<a class="headerlink" href="#module-pipeline.compare_models" title="Permalink to this headline">¶</a></h2>
<p>Functions for comparing and visualizing model performance. Most of these functions rely on ATOM’s model tracker and
datastore services, which are not part of the standard AMPL installation, but a few functions will work on collections of
models saved as local files.</p>
<dl class="py function">
<dt id="pipeline.compare_models.copy_best_filesystem_models">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">copy_best_filesystem_models</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#copy_best_filesystem_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.copy_best_filesystem_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify the best models for each dataset within a result directory tree (e.g. from a hyperparameter search).
Copy the associated model tarballs to a destination directory.</p>
<dl>
<dt>Args:</dt><dd><p>result_dir (str): Path to model training result directory.</p>
<p>dest_dir (str): Path of directory wherre model tarballs will be copied to.</p>
<p>pred_type (str): Prediction type (‘classification’ or ‘regression’) of models to copy</p>
<p>force_update (bool): If true, overwrite tarball files that already exist in dest_dir.</p>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of performance metrics for best models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.extract_collection_perf_metrics">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">extract_collection_perf_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collection_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#extract_collection_perf_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.extract_collection_perf_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain list of training datasets with models in the given collection. Get performance metrics for
models on each dataset and save them as CSV files in the given output directory.</p>
<dl>
<dt>Args:</dt><dd><p>collection_name (str): Name of model tracker collection to search for models.</p>
<p>output_dir (str): Directory where tables of performance metrics will be written.</p>
<p>pred_type (str): Prediction type (‘classification’ or ‘regression’) of models to query.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_best_models_info">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_best_models_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PK_pipeline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/usr/local/data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortlist_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dset_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_best_models_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_best_models_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Tabulate parameters and performance metrics for the best models, according to a given metric, trained against
each specified dataset.</p>
<dl>
<dt>Args:</dt><dd><p>col_names (list of str): List of model tracker collections to search.</p>
<p>bucket (str): Datastore bucket for training datasets.</p>
<p>pred_type (str): Type of models (regression or classification).</p>
<p>result_dir (list of str): Result directories of the models, if model tracker is not supported.</p>
<p>PK_pipeline (bool): Are we being called from PK pipeline?</p>
<p>output_dir (str): Directory to write output table to.</p>
<p>shortlist_key (str): Datastore key for table of datasets to query models for.</p>
<p>input_dset_keys (str or list of str): List of datastore keys for datasets to query models for. Either shortlist_key
or input_dset_keys must be specified, but not both.</p>
<p>save_results (bool): If True, write the table of results to a CSV file.</p>
<p>subset (str): Input dataset subset (‘train’, ‘valid’, or ‘test’) for which metrics are used to select best models.</p>
<p>metric_type (str): Type of performance metric (r2_score, roc_auc_score, etc.) to use to select best models.</p>
<p>selection_type (str): Score criterion (‘max’ or ‘min’) to use to select best models.</p>
<p>other_filters (dict): Additional selection criteria to include in model query.</p>
</dd>
<dt>Returns:</dt><dd><p>top_models_df (DataFrame): Table of parameters and metrics for best models for each dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_best_perf_table">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_best_perf_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_uuid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PK_pipe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_best_perf_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_best_perf_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract parameters and training run performance metrics for a single model. The model may be
specified either by a metadata dictionary, a model_uuid or a result directory; in the model_uuid case, the function
queries the model tracker DB for the model metadata. For models saved in the filesystem, can query the performance
data from the original result directory, but not from a saved tarball.</p>
<dl>
<dt>Args:</dt><dd><p>metric_type (str): Performance metric to include in result dictionary.</p>
<p>col_name (str): Collection name containing model, if model is specified by model_uuid.</p>
<p>result_dir (str): result directory of the model, if Model tracker is not supported and metadata_dict not provided.</p>
<p>model_uuid (str): UUID of model to query, if metadata_dict is not provided.</p>
<p>metadata_dict (dict): Full metadata dictionary for a model, including training metrics and
dataset metadata.</p>
<p>PK_pipe (bool): If True, include some additional parameters in the result dictionary specific to PK models.</p>
</dd>
<dt>Returns:</dt><dd><p>model_info (dict): Dictionary of parameter or metric name - value pairs.</p>
</dd>
<dt>Todo:</dt><dd><p>Add support for models saved as local tarball files.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_collection_datasets">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_collection_datasets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collection_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_collection_datasets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_collection_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of unique training datasets used for all models in a given collection.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>collection_name (str): Name of model tracker collection to search for models.</p>
</dd>
<dt>Returns:</dt><dd><p>list: List of model training (dataset_key, bucket) tuples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_dataset_models">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_dataset_models</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collection_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_dataset_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_dataset_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the model tracker for all models saved in the model tracker DB under the given collection names. Returns a dictionary
mapping (dataset_key,bucket) pairs to the list of (collection,model_uuid) pairs trained on the corresponding datasets.</p>
<dl>
<dt>Args:</dt><dd><p>collection_names (list): List of names of model tracker collections to search for models.</p>
<p>filter_dict (dict): Additional filter criteria to use in model query.</p>
</dd>
<dt>Returns:</dt><dd><p>dict: Dictionary mapping training set (dataset_key, bucket) tuples to (collection, model_uuid) pairs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_filesystem_perf_results">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_filesystem_perf_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_filesystem_perf_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_filesystem_perf_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve metadata and performance metrics for models stored in the filesystem from a hyperparameter search run.</p>
<dl>
<dt>Args:</dt><dd><p>result_dir (str): Root directory for results from a hyperparameter search training run.</p>
<p>pred_type (str): Prediction type (‘classification’ or ‘regression’) of models to query.</p>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of metadata fields and performance metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_multitask_perf_from_files">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_multitask_perf_from_files</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_multitask_perf_from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_multitask_perf_from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve model metadata and performance metrics stored in the filesystem from a multitask hyperparameter search.
Format the per-task performance metrics in a table with a row for each task and columns for each model/subset
combination.</p>
<dl>
<dt>Args:</dt><dd><p>result_dir (str): Path to root result directory containing output from a hyperparameter search run.</p>
<p>pred_type (str): Prediction type (‘classification’ or ‘regression’) of models to query.</p>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of model metadata fields and performance metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_multitask_perf_from_files_new">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_multitask_perf_from_files_new</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_multitask_perf_from_files_new"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_multitask_perf_from_files_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve model metadata and performance metrics stored in the filesystem from a multitask hyperparameter search.
Format the per-task performance metrics in a table with a row for each task and columns for each model/subset
combination.</p>
<dl>
<dt>Args:</dt><dd><p>result_dir (str): Path to root result directory containing output from a hyperparameter search run.</p>
<p>pred_type (str): Prediction type (‘classification’ or ‘regression’) of models to query.</p>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of model metadata fields and performance metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_multitask_perf_from_tracker">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_multitask_perf_from_tracker</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collection_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_responses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_subsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exhaustive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_multitask_perf_from_tracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_multitask_perf_from_tracker" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve full metadata and metrics from model tracker for all models in a collection and format them
into a table, including per-task performance metrics for multitask models.</p>
<p>Meant for multitask NN models, but works for single task models as well.</p>
<p>By AKP. Works for model tracker as of 10/2020</p>
<dl>
<dt>Args:</dt><dd><p>collection_name (str): Name of model tracker collection to search for models.</p>
<dl class="simple">
<dt>response_cols (list, str or None): Names of tasks (response columns) to query performance results for.</dt><dd><p>If None, checks to see if the entire collection has the same response cols.
Otherwise, should be list of strings or a comma-separated string.
asks for clarification. Note: make sure response cols are listed in same order as in metadata.
Recommended: None first, then clarify.</p>
</dd>
<dt>expand_responses (list, str or None): Names of tasks / response columns you want to include results for in</dt><dd><p>the final dataframe. Useful if you have a lot of tasks and only want to look at the performance of a
few of them. Must also be a list or comma separated string, and must be a subset of response_cols.
If None, will expand all responses.</p>
</dd>
<dt>expand_subsets (list, str or None): Dataset subsets (‘train’, ‘valid’ and/or ‘test’) to show metrics for.</dt><dd><p>Again, must be list or comma separated string, or None to expand all.</p>
</dd>
<dt>exhaustive (bool): If True, return large dataframe with all model tracker metadata minus any columns not</dt><dd><p>in expand_responses. If False, return trimmed dataframe with most relevant columns.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of model metadata fields and performance metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_summary_metadata_table">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_summary_metadata_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uuids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_summary_metadata_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_summary_metadata_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Tabulate metadata fields and performance metrics for a set of models identified by specific model_uuids.</p>
<dl>
<dt>Args:</dt><dd><p>uuids (list): List of model UUIDs to query.</p>
<dl class="simple">
<dt>collections (list or str): Names of collections in model tracker DB to get models from. If collections is</dt><dd><p>a string, it must identify one collection to search for all models. If a list, it must be of the same
length as <cite>uuids</cite>. If not provided, all collections will be searched.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of metadata fields and performance metrics for models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_summary_perf_tables">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_summary_perf_tables</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collection_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_summary_perf_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_summary_perf_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model parameters and performance metrics from model tracker for all models saved in the model tracker DB under
the given collection names (or result directory if Model tracker is not available) with the given prediction type.
Tabulate the parameters and metrics including:</p>
<blockquote>
<div><p>dataset (assay name, target, parameter, key, bucket)
dataset size (train/valid/test/total)
number of training folds
model type (NN or RF)
featurizer
transformation type
metrics: r2_score, mae_score and rms_score for regression, or ROC AUC for classification</p>
</div></blockquote>
<dl>
<dt>Args:</dt><dd><p>collection_names (list): Names of model tracker collections to search for models.</p>
<p>filter_dict (dict): Additional filter criteria to use in model query.</p>
<p>result_dir (str or list): Directories to search for models; must be provided if the model tracker DB is not available.</p>
<p>prediction_type (str): Type of models (classification or regression) to query.</p>
<p>verbose (bool): If true, print status messages as collections are processed.</p>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of model metadata fields and performance metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_tarball_perf_table">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_tarball_perf_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_tarball</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_tarball_perf_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_tarball_perf_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve model metadata and performance metrics for a model saved as a tarball (.tar.gz) file.</p>
<dl>
<dt>Args:</dt><dd><p>model_tarball (str): Path of model tarball file, named as model.tar.gz.</p>
<p>pred_type (str): Prediction type (‘classification’ or ‘regression’) of model.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple (pd.DataFrame, dict): Table of performance metrics and a dictionary of model metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_training_datasets">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_training_datasets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collection_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_training_datasets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_training_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the model tracker DB for all the unique dataset keys and buckets used to train models in the given
collections.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>collection_names (list): List of names of model tracker collections to search for models.</p>
</dd>
<dt>Returns:</dt><dd><p>dict: Dictionary mapping collection names to lists of (dataset_key, bucket) tuples for training sets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_training_perf_table">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_training_perf_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_training_perf_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_training_perf_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Load performance metrics from model tracker for all models saved in the model tracker DB under
a given collection that were trained against a particular dataset. Identify training parameters
that vary between models, and generate plots of performance vs particular combinations of
parameters.</p>
<dl>
<dt>Args:</dt><dd><p>dataset_key (str): Training dataset key.</p>
<p>bucket (str): Training dataset bucket.</p>
<p>collection_name (str): Name of model tracker collection to search for models.</p>
<p>pred_type (str): Prediction type (‘classification’ or ‘regression’) of models to query.</p>
<p>other_filters (dict): Other filter criteria to use in querying models.</p>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of models and performance metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.compare_models.get_umap_nn_model_perf_table">
<code class="sig-prename descclassname"><span class="pre">pipeline.compare_models.</span></code><code class="sig-name descname"><span class="pre">get_umap_nn_model_perf_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/compare_models.html#get_umap_nn_model_perf_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.compare_models.get_umap_nn_model_perf_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Load performance metrics from model tracker for all NN models with the given prediction_type saved in
the model tracker DB under a given collection that were trained against a particular dataset. Show
parameter settings for UMAP transformer for models where they are available.</p>
<dl>
<dt>Args:</dt><dd><p>dataset_key (str): Dataset key for training dataset.</p>
<p>bucket (str): Dataset bucket for training dataset.</p>
<p>collection_name (str): Name of model tracker collection to search for models.</p>
<p>pred_type (str): Prediction type (‘classification’ or ‘regression’) of models to query.</p>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of model performance metrics.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.dist_metrics">
<span id="pipeline-dist-metrics-module"></span><h2>pipeline.dist_metrics module<a class="headerlink" href="#module-pipeline.dist_metrics" title="Permalink to this headline">¶</a></h2>
<p>Distance metrics for compounds: Tanimoto and maximum common substructure (MCS)</p>
<dl class="py function">
<dt id="pipeline.dist_metrics.mcs">
<code class="sig-prename descclassname"><span class="pre">pipeline.dist_metrics.</span></code><code class="sig-name descname"><span class="pre">mcs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/dist_metrics.html#mcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.dist_metrics.mcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum common substructure (MCS) distances between pairs of molecules.</p>
<p>The MCS distance between molecules m1 and m2 is one minus the average of fMCS(m1,m2) and fMCS(m2,m1),
where fMCS(m1,m2) is the fraction of m1’s atoms that are part of the largest common substructure of m1 and m2.</p>
<dl>
<dt>Args:</dt><dd><p>mols1 (Sequence of <cite>rdkit.Mol</cite>): First list of molecules.</p>
<dl class="simple">
<dt>mols2 (Sequence of <cite>rdkit.Mol</cite>, optional): Second list of molecules.</dt><dd><p>If not provided, computes MCS distances between pairs of molecules in mols1.
Otherwise, computes a matrix of distances between pairs of molecules from mols1 and mols2.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Matrix of pairwise distances between molecules.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.dist_metrics.tanimoto">
<code class="sig-prename descclassname"><span class="pre">pipeline.dist_metrics.</span></code><code class="sig-name descname"><span class="pre">tanimoto</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fps1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/dist_metrics.html#tanimoto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.dist_metrics.tanimoto" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Tanimoto distances between sets of ECFP fingerprints.</p>
<dl>
<dt>Args:</dt><dd><p>fps1 (Sequence): First list of ECFP fingerprint vectors.</p>
<dl class="simple">
<dt>fps2 (Sequence, optional): Second list of ECFP fingerprint vectors.</dt><dd><p>If not provided, computes distances between pairs of fingerprints in fps1.
Otherwise, computes a matrix of distances between pairs of fingerprints in fps1 and fps2.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Matrix of pairwise distances between fingerprints.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.dist_metrics.tanimoto_single">
<code class="sig-prename descclassname"><span class="pre">pipeline.dist_metrics.</span></code><code class="sig-name descname"><span class="pre">tanimoto_single</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/dist_metrics.html#tanimoto_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.dist_metrics.tanimoto_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a vector of Tanimoto distances between a single fingerprint and each fingerprint in a list .</p>
<dl>
<dt>Args:</dt><dd><p>fp : Fingerprint to be compared.</p>
<p>fps (Sequence): List of ECFP fingerprint vectors.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Vector of distances between fp and each fingerprint in fps.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.diversity_plots">
<span id="pipeline-diversity-plots-module"></span><h2>pipeline.diversity_plots module<a class="headerlink" href="#module-pipeline.diversity_plots" title="Permalink to this headline">¶</a></h2>
<p>Plotting routines for visualizing chemical diversity of datasets</p>
<dl class="py function">
<dt id="pipeline.diversity_plots.diversity_plots">
<code class="sig-prename descclassname"><span class="pre">pipeline.diversity_plots.</span></code><code class="sig-name descname"><span class="pre">diversity_plots</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datastore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecfp_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umap_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'compound_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdkit_smiles'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_base_smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_for_mcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/diversity_plots.html#diversity_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.diversity_plots.diversity_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot visualizations of diversity for an arbitrary table of compounds. At minimum, the file should contain
columns for a compound ID and a SMILES string. Produces a clustered heatmap display of Tanimoto distances between
compounds along with a 2D UMAP projection plot based on ECFP fingerprints, with points colored according to the response
variable.</p>
<dl>
<dt>Args:</dt><dd><p>dset_key (str): Datastore key or filepath for dataset.</p>
<p>datastore (bool): Whether to load dataset from datastore or from filesystem.</p>
<p>bucket (str): Name of datastore bucket containing dataset.</p>
<p>title_prefix (str): Prefix for plot titles.</p>
<p>ecfp_radius (int): Radius for ECFP fingerprint calculation.</p>
<p>umap_file (str, optional): Path to file to write UMAP coordinates to.</p>
<dl class="simple">
<dt>out_dir (str, optional):  Output directory for plots and tables. If provided, plots will be output as PDF files rather</dt><dd><p>than in the current notebook, and some additional CSV files will be generated.</p>
</dd>
</dl>
<p>id_col (str): Column in dataset containing compound IDs.</p>
<p>smiles_col (str): Column in dataset containing SMILES strings.</p>
<p>is_base_smiles (bool): True if SMILES strings do not need to be salt-stripped and standardized.</p>
<p>response_col (str): Column in dataset containing response values.</p>
<dl class="simple">
<dt>max_for_mcs (int): Maximum dataset size for plots based on MCS distance. If the number of compounds is less than this</dt><dd><p>value, an additional cluster heatmap and UMAP projection plot will be produced based on maximum common substructure
distance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.diversity_plots.plot_dataset_dist_distr">
<code class="sig-prename descclassname"><span class="pre">pipeline.diversity_plots.</span></code><code class="sig-name descname"><span class="pre">plot_dataset_dist_distr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">metric_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/diversity_plots.html#plot_dataset_dist_distr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.diversity_plots.plot_dataset_dist_distr" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a density plot showing the distribution of distances between dataset feature
vectors, using the specified feature type and distance metric.</p>
<dl>
<dt>Args:</dt><dd><p>dataset (deepchem.Dataset): A dataset object. At minimum, it should contain a 2D numpy array ‘X’ of feature vectors.</p>
<p>feat_type (str): Type of features (‘ECFP’ or ‘descriptors’).</p>
<p>dist_metric (str): Name of metric to be used to compute distances; can be anything supported by scipy.spatial.distance.pdist.</p>
<p>task_name (str): Abbreviated name to describe dataset in plot title.</p>
<p>metric_kwargs: Additional arguments to pass to metric.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: Distance matrix.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.featurization">
<span id="pipeline-featurization-module"></span><h2>pipeline.featurization module<a class="headerlink" href="#module-pipeline.featurization" title="Permalink to this headline">¶</a></h2>
<p>Classes providing different methods of featurizing compounds and other data entities</p>
<dl class="py class">
<dt id="pipeline.featurization.ATOMAtomTypeEState">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">ATOMAtomTypeEState</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sLi'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ATOMAtomTypeEState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ATOMAtomTypeEState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mordred.EState.AtomTypeEState</span></code></p>
<p>EState descriptors restricted to those that can be computed for most compounds</p>
<dl class="py attribute">
<dt id="pipeline.featurization.ATOMAtomTypeEState.my_es_types">
<code class="sig-name descname"><span class="pre">my_es_types</span></code><em class="property"> <span class="pre">=</span> <span class="pre">['sCH3',</span> <span class="pre">'dCH2',</span> <span class="pre">'ssCH2',</span> <span class="pre">'dsCH',</span> <span class="pre">'aaCH',</span> <span class="pre">'sssCH',</span> <span class="pre">'tsC',</span> <span class="pre">'dssC',</span> <span class="pre">'aasC',</span> <span class="pre">'aaaC',</span> <span class="pre">'ssssC',</span> <span class="pre">'sNH2',</span> <span class="pre">'ssNH',</span> <span class="pre">'aaNH',</span> <span class="pre">'tN',</span> <span class="pre">'dsN',</span> <span class="pre">'aaN',</span> <span class="pre">'sssN',</span> <span class="pre">'ddsN',</span> <span class="pre">'aasN',</span> <span class="pre">'sOH',</span> <span class="pre">'dO',</span> <span class="pre">'ssO',</span> <span class="pre">'aaO',</span> <span class="pre">'sF',</span> <span class="pre">'dS',</span> <span class="pre">'ssS',</span> <span class="pre">'aaS',</span> <span class="pre">'ddssS',</span> <span class="pre">'sCl',</span> <span class="pre">'sBr']</span></em><a class="headerlink" href="#pipeline.featurization.ATOMAtomTypeEState.my_es_types" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pipeline.featurization.ATOMAtomTypeEState.parameter_names">
<code class="sig-name descname"><span class="pre">parameter_names</span></code><em class="property"> <span class="pre">=</span> <span class="pre">('type',</span> <span class="pre">'estate')</span></em><a class="headerlink" href="#pipeline.featurization.ATOMAtomTypeEState.parameter_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.ATOMAtomTypeEState.preset">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">preset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ATOMAtomTypeEState.preset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ATOMAtomTypeEState.preset" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate preset descriptor instances.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Iterable[Descriptor]: preset descriptors</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.featurization.ATOMMolecularDistanceEdge">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">ATOMMolecularDistanceEdge</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">valence1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valence2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ATOMMolecularDistanceEdge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ATOMMolecularDistanceEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mordred.MolecularDistanceEdge.MolecularDistanceEdge</span></code></p>
<p>MolecularDistanceEdge descriptors restricted to those that can be computed for most compounds</p>
<dl class="py attribute">
<dt id="pipeline.featurization.ATOMMolecularDistanceEdge.parameter_names">
<code class="sig-name descname"><span class="pre">parameter_names</span></code><em class="property"> <span class="pre">=</span> <span class="pre">('valence1',</span> <span class="pre">'valence2',</span> <span class="pre">'element')</span></em><a class="headerlink" href="#pipeline.featurization.ATOMMolecularDistanceEdge.parameter_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.ATOMMolecularDistanceEdge.preset">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">preset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ATOMMolecularDistanceEdge.preset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ATOMMolecularDistanceEdge.preset" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate preset descriptor instances.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Iterable[Descriptor]: preset descriptors</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.featurization.ComputedDescriptorFeaturization">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">ComputedDescriptorFeaturization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ComputedDescriptorFeaturization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ComputedDescriptorFeaturization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.featurization.DescriptorFeaturization" title="pipeline.featurization.DescriptorFeaturization"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.featurization.DescriptorFeaturization</span></code></a></p>
<p>Subclass for featurizers that support online computation of descriptors, usually given SMILES
strings or RDKit Mol objects as input rather than compound IDs. The computed descriptors may be cached
and combined with tables of precomputed descriptors to speed up access. Featurized datasets may be
persisted to the filesystem or datastore.</p>
<dl>
<dt>Attributes:</dt><dd><p>Set in __init_:</p>
<p>feat_type (str): Type of featurizer, set in super.(__init__)</p>
<p>descriptor_type (str): The type of descriptor</p>
<p>descriptor_key (str): The path to the descriptor featurization matrix if it saved to a file, or the key to
the file in the Datastore</p>
<p>descriptor_base (str/path): The base path to the descriptor featurization matrix</p>
<p>precomp_descr_table (pd.DataFrame): initialized as empty df, will be overridden to contain full descriptor table</p>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.featurization.ComputedDescriptorFeaturization.compute_descriptors">
<code class="sig-name descname"><span class="pre">compute_descriptors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ComputedDescriptorFeaturization.compute_descriptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ComputedDescriptorFeaturization.compute_descriptors" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute descriptors for the SMILES strings given in smiles_df.</p>
<dl>
<dt>Args:</dt><dd><p>smiles_df: DataFrame containing SMILES strings to compute descriptors for.</p>
<p>params (Namespace): Argparse Namespace argument containing the parameters</p>
</dd>
<dt>Returns:</dt><dd><p>ret_df (DataFrame): Data frame containing the compound IDs, SMILES string and descriptor columns as
specified in the current parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.ComputedDescriptorFeaturization.compute_moe_descriptors">
<code class="sig-name descname"><span class="pre">compute_moe_descriptors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ComputedDescriptorFeaturization.compute_moe_descriptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ComputedDescriptorFeaturization.compute_moe_descriptors" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute MOE descriptors for the given list of SMILES strings</p>
<dl>
<dt>Args:</dt><dd><p>smiles_strs (iterable): SMILES strings to compute descriptors for.</p>
<p>params (Namespace): Argparse Namespace argument containing the parameters.</p>
</dd>
<dt>Returns:</dt><dd><p>(tuple): Tuple containing:</p>
<blockquote>
<div><p>desc_df (DataFrame): Data frame containing computed descriptors</p>
<p>is_valid (ndarray of bool): True for each input SMILES string that was valid according to RDKit</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.ComputedDescriptorFeaturization.compute_mordred_descriptors">
<code class="sig-name descname"><span class="pre">compute_mordred_descriptors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ComputedDescriptorFeaturization.compute_mordred_descriptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ComputedDescriptorFeaturization.compute_mordred_descriptors" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Mordred descriptors for the given list of SMILES strings</p>
<dl>
<dt>Args:</dt><dd><p>smiles_strs (iterable): SMILES strings to compute descriptors for.</p>
<p>params (Namespace): Argparse Namespace argument containing the parameters.</p>
</dd>
<dt>Returns:</dt><dd><p>(tuple): Tuple containing:</p>
<blockquote>
<div><p>desc_df (DataFrame): Data frame containing computed descriptors</p>
<p>is_valid (ndarray of bool): True for each input SMILES string that was valid according to RDKit</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.ComputedDescriptorFeaturization.compute_rdkit_descriptors">
<code class="sig-name descname"><span class="pre">compute_rdkit_descriptors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdkit_smiles'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ComputedDescriptorFeaturization.compute_rdkit_descriptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ComputedDescriptorFeaturization.compute_rdkit_descriptors" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute RDKit descriptors for the given list of SMILES strings</p>
<dl>
<dt>Args:</dt><dd><p>smiles_strs: SMILES strings to compute descriptors for.</p>
</dd>
<dt>Returns:</dt><dd><p>(tuple): Tuple containing:</p>
<blockquote>
<div><p>desc_df (DataFrame): Data frame containing computed descriptors</p>
<p>is_valid (ndarray of bool): True for each input SMILES string that was valid according to RDKit</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.ComputedDescriptorFeaturization.featurize_data">
<code class="sig-name descname"><span class="pre">featurize_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ComputedDescriptorFeaturization.featurize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ComputedDescriptorFeaturization.featurize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform featurization on the given dataset, by computing descriptors from SMILES strings or matching them
to SMILES in precomputed table.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): A table of data to be featurized. At minimum, should include columns.
for the compound ID and assay value; for some featurizers, must also contain a SMILES string column.</p>
<p>model_dataset (ModelDataset): Object containing the dataset to be featurized</p>
</dd>
<dt>Returns:</dt><dd><p>Tuple of (features, ids, vals, attr).</p>
<p>features (np.array): Feature matrix.</p>
<p>ids (pd.DataFrame): compound IDs or SMILES strings if needed for splitting.</p>
<p>attr (pd.DataFrame): dataframe containing SMILES strings indexed by compound IDs.</p>
<p>vals (np.array): array of response values</p>
</dd>
<dt>Raises:</dt><dd><p>Exception: if features is None, featurization failed for the dataset</p>
</dd>
<dt>Side effects:</dt><dd><p>Loads a precomputed descriptor table and sets self.precomp_descr_table to point to it, if one is
specified by params.descriptor_key.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.ComputedDescriptorFeaturization.get_featurized_dset_name">
<code class="sig-name descname"><span class="pre">get_featurized_dset_name</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ComputedDescriptorFeaturization.get_featurized_dset_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ComputedDescriptorFeaturization.get_featurized_dset_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a name for the featurized dataset, for use in filenames or dataset keys.
Does not include any path information. May be derived from dataset_name.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset_name (str): Name of the dataset</p>
</dd>
<dt>Returns:</dt><dd><p>(str): A name for the feauturized dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.ComputedDescriptorFeaturization.scale_moe_descriptors">
<code class="sig-name descname"><span class="pre">scale_moe_descriptors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desc_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descr_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#ComputedDescriptorFeaturization.scale_moe_descriptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.ComputedDescriptorFeaturization.scale_moe_descriptors" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale selected descriptors computed by MOE by dividing their values by the atom count per molecule.</p>
<dl>
<dt>Args:</dt><dd><p>desc_df (DataFrame): Data frame containing computed descriptors.</p>
<p>descr_type (str): Descriptor type, used to look up expected set of descriptor columns.</p>
</dd>
<dt>Returns:</dt><dd><p>scaled_df (DataFrame): Data frame with scaled descriptors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.featurization.DescriptorFeaturization">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">DescriptorFeaturization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.featurization.PersistentFeaturization" title="pipeline.featurization.PersistentFeaturization"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.featurization.PersistentFeaturization</span></code></a></p>
<p>Subclass for featurizers that map sets of (usually) precomputed descriptors to compound IDs; the resulting merged
dataset is persisted to the filesystem or datastore.
Attributes:</p>
<blockquote>
<div><p>Set in __init_:
feat_type (str): Type of featurizer, set in super.(__init__)</p>
<p>descriptor_type (str): The type of descriptor</p>
<p>descriptor_key (str): The path to the descriptor featurization matrix if it saved to a file,
or the key to the file in the Datastore</p>
<p>descriptor_base (str/path): The base path to the descriptor featurization matrix</p>
<p>precomp_descr_table (pd.DataFrame): initialized as an empty DataFrame, will be overridden to contain the
full descriptor table</p>
</div></blockquote>
<dl>
<dt>Class attributes:</dt><dd><p>supported_descriptor_types</p>
<p>all_desc_col</p>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.create_feature_transformer">
<code class="sig-name descname"><span class="pre">create_feature_transformer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.create_feature_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.create_feature_transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a scaling and centering transformation to the feature matrix of the given dataset, and return a
DeepChem transformer object holding its parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset (deepchem.Dataset): featurized dataset</p>
</dd>
<dt>Returns:</dt><dd><p>(list of DeepChem transformer objects): list of transformers for the feature matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pipeline.featurization.DescriptorFeaturization.desc_type_cols">
<code class="sig-name descname"><span class="pre">desc_type_cols</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{}</span></em><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.desc_type_cols" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pipeline.featurization.DescriptorFeaturization.desc_type_scaled">
<code class="sig-name descname"><span class="pre">desc_type_scaled</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{}</span></em><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.desc_type_scaled" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pipeline.featurization.DescriptorFeaturization.desc_type_source">
<code class="sig-name descname"><span class="pre">desc_type_source</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{}</span></em><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.desc_type_source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.extract_prefeaturized_data">
<code class="sig-name descname"><span class="pre">extract_prefeaturized_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merged_dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.extract_prefeaturized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.extract_prefeaturized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to retrieve prefeaturized data for the given dataset.</p>
<dl>
<dt>Args:</dt><dd><p>merged_dset_df (pd.DataFrame): dataset merged with the featurizers</p>
<p>model_dataset (ModelDataset): Object containing the dataset to be featurized
# TODO: Remove model_dataset call once params.response_cols is properly set</p>
</dd>
<dt>Returns:</dt><dd><p>Tuple of (features, ids, vals, attr).</p>
<p>features (np.array): Feature matrix.</p>
<p>ids (pd.DataFrame): compound IDs or SMILES strings if needed for splitting.</p>
<p>attr (pd.DataFrame): dataframe containing SMILES strings indexed by compound IDs.</p>
<p>vals (np.array): array of response values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.featurize_data">
<code class="sig-name descname"><span class="pre">featurize_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.featurize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.featurize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform featurization on the given dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): A table of data to be featurized. At minimum, should include columns.
for the compound ID and assay value; for some featurizers, must also contain a SMILES string column.</p>
<p>model_dataset (ModelDataset): Object containing the dataset to be featurized
# TODO: Remove model_dataset call once params.response_cols is properly set</p>
</dd>
<dt>Returns:</dt><dd><p>Tuple of (features, ids, vals, attr).</p>
<p>features (np.array): Feature matrix.</p>
<p>ids (pd.DataFrame): compound IDs or SMILES strings if needed for splitting.</p>
<p>attr (pd.DataFrame): dataframe containing SMILES strings indexed by compound IDs.</p>
<p>vals (np.array): array of response values</p>
</dd>
<dt>Raises:</dt><dd><p>Exception: if features is None, feautirzation failed for the dataset</p>
</dd>
<dt>Side effects:</dt><dd><p>Overwrites the attribute precomp_descr_table (pd.DataFrame) with the appropriate descriptor table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.get_feature_columns">
<code class="sig-name descname"><span class="pre">get_feature_columns</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.get_feature_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.get_feature_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of feature column names associated with this Featurization instance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None</p>
</dd>
<dt>Returns:</dt><dd><p>(list): List of column names of the features, pulled from DescriptorFeaturization attributes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.get_feature_count">
<code class="sig-name descname"><span class="pre">get_feature_count</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.get_feature_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.get_feature_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of feature columns associated with this Featurization instance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None</p>
</dd>
<dt>Returns:</dt><dd><p>(int): Number of feature columns associated with DescriptorFeaturization</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.get_feature_specific_metadata">
<code class="sig-name descname"><span class="pre">get_feature_specific_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.get_feature_specific_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.get_feature_specific_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of parameter settings for this Featurization object that are specific
to the feature type.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>params (Namespace): Argparse Namespace argument containing the parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.get_featurized_data_subdir">
<code class="sig-name descname"><span class="pre">get_featurized_data_subdir</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.get_featurized_data_subdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.get_featurized_data_subdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of a subdirectory (without any leading path information) in which to store
featurized data, if it goes to the filesystem.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>(str): ‘scaled_descriptors’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.get_featurized_dset_name">
<code class="sig-name descname"><span class="pre">get_featurized_dset_name</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.get_featurized_dset_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.get_featurized_dset_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a name for the featurized dataset, for use in filenames or dataset keys.
Does not include any path information. May be derived from dataset_name.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset_name (str): Name of the dataset</p>
</dd>
<dt>Returns:</dt><dd><p>(str): A name for the feauturized dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.load_descriptor_spec">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">load_descriptor_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desc_spec_bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc_spec_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.load_descriptor_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.load_descriptor_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a descriptor specification table from the datastore or the filesystem.
The table is a CSV file with the following columns:</p>
<p>descr_type:     A string specifying a descriptor source/program and a subset of descriptor columns</p>
<p>source:         Name of the program/package that generates the descriptors</p>
<p>scaled:         Binary indicator for whether subset of descriptor values are scaled by molecule’s atom count</p>
<p>descriptors:    A semicolon separated list of descriptor columns.</p>
<p>The values in the table are used to set class variables desc_type_cols, desc_type_source and desc_type_scaled.</p>
<dl>
<dt>Args:</dt><dd><p>desc_spec_bucket : bucket where descriptor spec is located</p>
<p>desc_spec_key: data store key, or full file path to locate descriptor spec object</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Side effects:</dt><dd><p>Sets the following class variables:</p>
<p>cls.desc_type_cols -&gt; map from decriptor types to their associated descriptor column names</p>
<p>cls.desc_type_source -&gt; map from decriptor types to the program/package that generates them</p>
<p>cls.desc_type_scaled -&gt; map from decriptor types to boolean indicators of whether some descriptor
values are scaled.</p>
<p>cls.supported_descriptor_types  -&gt; the list of available descriptor types</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DescriptorFeaturization.load_descriptor_table">
<code class="sig-name descname"><span class="pre">load_descriptor_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DescriptorFeaturization.load_descriptor_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.load_descriptor_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the table of precomputed feature values for the descriptor type specified in params, from
the datastore_key or path specified by params.descriptor_key and params.descriptor_bucket. Will try
to load the table from the local filesystem if possible, but the table should at least have a
metadata record in the datastore. The local file path is the same as descriptor_key on twintron-blue,
and may be taken from the LC_path metadata property if it is set.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>params (Namespace): Parameters for the current pipeline instance.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Side effects:</dt><dd><p>Overwrites the attribute precomp_descr_table (pd.DataFrame) with the loaded descriptor table.
Sets attributes desc_id_col and desc_smiles_col, if possible, based on the datastore metadata for the
descriptor table. Otherwise, sets them to reasonable defaults. Note that not all descriptor tables
contain SMILES strings, but one is required if the table is to be used with ComputedDescriptorFeaturization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pipeline.featurization.DescriptorFeaturization.supported_descriptor_types">
<code class="sig-name descname"><span class="pre">supported_descriptor_types</span></code><em class="property"> <span class="pre">=</span> <span class="pre">[]</span></em><a class="headerlink" href="#pipeline.featurization.DescriptorFeaturization.supported_descriptor_types" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.featurization.DynamicFeaturization">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">DynamicFeaturization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.featurization.Featurization" title="pipeline.featurization.Featurization"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.featurization.Featurization</span></code></a></p>
<p>Featurization subclass that supports on-the-fly featurization. Can be used when it is inexpensive to
compute the features. Most DeepChem featurizers are handled through this class.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>Set in __init__</dt><dd><p>feat_type (str): Type of featurizer in [‘ecfp’,’graphconv’,’molvae’]
featurization_obj: The DeepChem or MoleculeVAEFeaturizer object as determined by feat_type and params</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.create_feature_transformer">
<code class="sig-name descname"><span class="pre">create_feature_transformer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.create_feature_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.create_feature_transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a scaling and centering transformation to the feature matrix of the given dataset, and return a
DeepChem transformer object holding its parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset (deepchem.Dataset): featurized dataset</p>
</dd>
<dt>Returns:</dt><dd><p>Empty list since we will not be transforming the features of a DynamicFeaturization object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.extract_prefeaturized_data">
<code class="sig-name descname"><span class="pre">extract_prefeaturized_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merged_dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.extract_prefeaturized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.extract_prefeaturized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to extract prefeaturized data for the given dataset. For dynamic featurizers, we don’t save
this data, so this method always returns None.</p>
<dl>
<dt>Args:</dt><dd><p>merged_dset_df (DataFrame): dataset merged with the featurizers</p>
<p>model_dataset (ModelDataset): Object containing the dataset to be featurized</p>
</dd>
<dt>Returns:</dt><dd><p>None, None, None, None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.featurize">
<code class="sig-name descname"><span class="pre">featurize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.featurize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.featurize" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls DeepChem featurize() object</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.featurize_data">
<code class="sig-name descname"><span class="pre">featurize_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.featurize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.featurize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform featurization on the given dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): A table of data to be featurized. At minimum, should include columns
for the compound ID and assay value; for some featurizers, must also contain a SMILES string column.
# TODO: remove model_dataset after ensuring response_cols are set correctly.</p>
<p>model_dataset (ModelDataset): Contains the dataset to be featurized</p>
</dd>
<dt>Returns:</dt><dd><p>Tuple of (features, ids, vals, attr).</p>
<p>features (np.array): Feature matrix.</p>
<p>ids (pd.DataFrame): compound IDs or SMILES strings if needed for splitting.</p>
<p>vals (np.array): array of response values.</p>
<p>attr (pd.DataFrame): dataframe containing SMILES strings indexed by compound IDs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.get_feature_columns">
<code class="sig-name descname"><span class="pre">get_feature_columns</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.get_feature_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.get_feature_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of feature column names associated with this Featurization instance.
For DynamicFeaturization, the column names are essentially meaningless, so these will
be “c0, c1, … etc.”.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None</p>
</dd>
<dt>Returns:</dt><dd><p>(list): List of column names in the format [‘c0’,’c1’, …] of the length of the features</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.get_feature_count">
<code class="sig-name descname"><span class="pre">get_feature_count</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.get_feature_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.get_feature_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of feature columns associated with this Featurization instance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None</p>
</dd>
<dt>Returns:</dt><dd><p>(int): The number of feature columns for the DynamicFeaturization subclass, feat_type specific</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.get_feature_specific_metadata">
<code class="sig-name descname"><span class="pre">get_feature_specific_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.get_feature_specific_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.get_feature_specific_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of parameter settings for this Featurization object that are specific
to the feature type.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>params (Namespace): Argparse Namespace object containing the parameter list</p>
</dd>
<dt>Returns</dt><dd><p>dict: Dictionary containing featurizer specific metadata as a subdict under the keys
[‘ecfp_specific’,’autoencoder_specific’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.get_featurized_data_subdir">
<code class="sig-name descname"><span class="pre">get_featurized_data_subdir</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.get_featurized_data_subdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.get_featurized_data_subdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of a subdirectory (without any leading path information) in which to store
featurized data, if it goes to the filesystem.</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>Exception: This method is not supported by the DynamicFeaturization subclass</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.DynamicFeaturization.get_featurized_dset_name">
<code class="sig-name descname"><span class="pre">get_featurized_dset_name</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#DynamicFeaturization.get_featurized_dset_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.DynamicFeaturization.get_featurized_dset_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a name for the featurized dataset, for use in filenames or dataset keys.
Does not include any path information. May be derived from dataset_name.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset_name (str): Name of the dataset</p>
</dd>
<dt>Raises:</dt><dd><p>Exception: This method is not supported by the DynamicFeaturization subclass</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.featurization.Featurization">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">Featurization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for featurization code</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>feat_type (str): Type of featurizer, set in __init__</p>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.featurization.Featurization.create_feature_transformer">
<code class="sig-name descname"><span class="pre">create_feature_transformer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization.create_feature_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization.create_feature_transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a scaling and centering transformation to the feature matrix of the given dataset, and return a
DeepChem transformer object holding its parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset (deepchem.Dataset): featurized dataset</p>
</dd>
<dt>Returns:</dt><dd><p>Empty list</p>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: Must be implemented by concrete subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.Featurization.extract_prefeaturized_data">
<code class="sig-name descname"><span class="pre">extract_prefeaturized_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merged_dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization.extract_prefeaturized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization.extract_prefeaturized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts dataset features, values, IDs and attributes from the given prefeaturized data frame.
Args:</p>
<blockquote>
<div><p>merged_dset_df (DataFrame): Data frame for the dataset.</p>
<p>model_dataset (ModelDataset): Backpointer to the ModelDataset object for the dataset to be featurized.</p>
</div></blockquote>
<dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: Must be implemented by concrete subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.Featurization.featurize_data">
<code class="sig-name descname"><span class="pre">featurize_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization.featurize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization.featurize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform featurization on the given dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): A table of data to be featurized. At minimum, should include columns.
for the compound ID and assay value; for some featurizers, must also contain a SMILES string column.</p>
<p>model_dataset (ModelDataset): Dataset to be featurized.</p>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: Must be implemented by concrete subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.Featurization.get_feature_columns">
<code class="sig-name descname"><span class="pre">get_feature_columns</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization.get_feature_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization.get_feature_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of feature column names associated with this Featurization instance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None</p>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: Must be implemented by concrete subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.Featurization.get_feature_count">
<code class="sig-name descname"><span class="pre">get_feature_count</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization.get_feature_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization.get_feature_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of feature columns associated with this Featurization instance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None</p>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: Must be implemented by concrete subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.Featurization.get_feature_specific_metadata">
<code class="sig-name descname"><span class="pre">get_feature_specific_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization.get_feature_specific_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization.get_feature_specific_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of parameter settings for this Featurization object that are specific
to the feature type.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>params (Namespace): Contains parameters used to instantiate the featurizer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.Featurization.get_featurized_data_subdir">
<code class="sig-name descname"><span class="pre">get_featurized_data_subdir</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization.get_featurized_data_subdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization.get_featurized_data_subdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of a subdirectory (without any leading path information) in which to store
featurized data, if it goes to the filesystem.</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: Must be implemented by concrete subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.Featurization.get_featurized_dset_name">
<code class="sig-name descname"><span class="pre">get_featurized_dset_name</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#Featurization.get_featurized_dset_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.Featurization.get_featurized_dset_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a name for the featurized dataset, for use in filenames or dataset keys.
Does not include any path information. May be derived from dataset_name.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset_name (str): Name of the dataset</p>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: Must be implemented by concrete subclasses</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.featurization.PersistentFeaturization">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">PersistentFeaturization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#PersistentFeaturization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.PersistentFeaturization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.featurization.Featurization" title="pipeline.featurization.Featurization"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.featurization.Featurization</span></code></a></p>
<p>Subclass for featurizers that support persistent storage of featurized data. Used when computing or mapping
the features is CPU- or memory-intensive, e.g. descriptors. Currently DescriptorFeaturization is the only subclass,
but others are planned (e.g., UMAPDescriptorFeaturization).</p>
<dl class="py method">
<dt id="pipeline.featurization.PersistentFeaturization.create_feature_transformer">
<code class="sig-name descname"><span class="pre">create_feature_transformer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#PersistentFeaturization.create_feature_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.PersistentFeaturization.create_feature_transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a scaling and centering transformation to the feature matrix of the given dataset, and return a
DeepChem transformer object holding its parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset (deepchem.Dataset): featurized dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.PersistentFeaturization.extract_prefeaturized_data">
<code class="sig-name descname"><span class="pre">extract_prefeaturized_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merged_dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#PersistentFeaturization.extract_prefeaturized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.PersistentFeaturization.extract_prefeaturized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to extract prefeaturized data for the given dataset.</p>
<dl>
<dt>Args:</dt><dd><p>merged_dset_df (DataFrame): dataset merged with the featurizers</p>
<p>model_dataset (ModelDataset): Object containing the dataset to be featurized</p>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: Currently, only DescriptorFeaturization is supported, is not a generic method</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.featurization.PersistentFeaturization.featurize_data">
<code class="sig-name descname"><span class="pre">featurize_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#PersistentFeaturization.featurize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.PersistentFeaturization.featurize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform featurization on the given dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): A table of data to be featurized. At minimum, should include columns.
for the compound ID and assay value; for some featurizers, must also contain a SMILES string column.</p>
<p>model_dataset (ModelDataset): Object containing the dataset to be featurized</p>
</dd>
<dt>Returns:</dt><dd><dl>
<dt>Tuple of (features, ids, vals, attr).</dt><dd><p>features (np.array): Feature matrix.</p>
<p>ids (pd.DataFrame): compound IDs or SMILES strings if needed for splitting.</p>
<p>attr (pd.DataFrame): dataframe containing SMILES strings indexed by compound IDs.</p>
<p>vals (np.array): array of response values.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: Currently, only DescriptorFeaturization is supported, is not a generic method</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.compute_2d_mordred_descrs">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">compute_2d_mordred_descrs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#compute_2d_mordred_descrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.compute_2d_mordred_descrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute 2D Mordred descriptors only</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mols: List of RDKit mol objects for molecules to compute descriptors for.</p>
</dd>
<dt>Returns:</dt><dd><p>res_df: DataFrame containing Mordred descriptors for molecules.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.compute_all_moe_descriptors">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">compute_all_moe_descriptors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#compute_all_moe_descriptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.compute_all_moe_descriptors" title="Permalink to this definition">¶</a></dt>
<dd><p>Run MOE to compute all 317 standard descriptors.</p>
<dl>
<dt>Args:</dt><dd><p>smiles_df (DataFrame): Table containing SMILES strings and compound IDs</p>
<p>params (Namespace): Parsed model parameters, used to identify SMILES and compund ID columns.</p>
</dd>
<dt>Returns:</dt><dd><p>descr_df (DataFrame): Table containing the input SMILES strings and compound IDs, the “washed” SMILES
string prepared by MOE, a sequence index, and columns for each MOE descriptor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.compute_all_mordred_descrs">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">compute_all_mordred_descrs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#compute_all_mordred_descrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.compute_all_mordred_descrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all Mordred descriptors, including 3D ones</p>
<dl>
<dt>Args:</dt><dd><p>mols: List of RDKit mol objects for molecules to compute descriptors for.</p>
<p>max_cpus: Max number of cores to use for computing descriptors. None means use all available cores.</p>
<p>quiet: If True, avoid displaying progress indicators for computations.</p>
</dd>
<dt>Returns:</dt><dd><p>res_df: DataFrame containing Mordred descriptors for molecules.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.compute_all_rdkit_descrs">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">compute_all_rdkit_descrs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mol'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#compute_all_rdkit_descrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.compute_all_rdkit_descrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all RDKit descriptors</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mols: List of RDKit Mol objects to compute descriptors for.</p>
</dd>
<dt>Returns:</dt><dd><p>res_df (DataFrame): Data frame containing computed descriptors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.compute_mordred_descriptors_from_smiles">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">compute_mordred_descriptors_from_smiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdkit_smiles'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#compute_mordred_descriptors_from_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.compute_mordred_descriptors_from_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute 2D and 3D Mordred descriptors for the given list of SMILES strings.</p>
<dl>
<dt>Args:</dt><dd><p>smiles_strs:    A list or array of SMILES strings</p>
<dl class="simple">
<dt>max_cpus:       The maximum number of cores to use for computing descriptors. The default value None means</dt><dd><p>that all available cores will be used.</p>
</dd>
</dl>
<p>quiet (bool):   If True, suppress displaying a progress indicator while computing descriptors.</p>
<p>smiles_col (str): The name of the column that will contain SMILES strings in the returned data frame.</p>
</dd>
<dt>Returns: tuple</dt><dd><dl class="simple">
<dt>desc_df (DataFrame): A table of Mordred descriptors for the input SMILES strings that were valid</dt><dd><p>(according to RDKit), together with those SMILES strings.</p>
</dd>
<dt>is_valid (ndarray of bool): An array of length the same as smiles_strs, indicating which SMILES strings</dt><dd><p>were considered valid.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.compute_rdkit_descriptors_from_smiles">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">compute_rdkit_descriptors_from_smiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdkit_smiles'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#compute_rdkit_descriptors_from_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.compute_rdkit_descriptors_from_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute 2D and 3D RDKit descriptors for the given list of SMILES strings.</p>
<dl>
<dt>Args:</dt><dd><p>smiles_strs:    A list or array of SMILES strings</p>
<dl class="simple">
<dt>max_cpus:       The maximum number of cores to use for computing descriptors. The default value None means</dt><dd><p>that all available cores will be used.</p>
</dd>
</dl>
<p>quiet (bool):   If True, suppress displaying a progress indicator while computing descriptors.</p>
<p>smiles_col (str): The name of the column that will contain SMILES strings in the returned data frame.</p>
</dd>
<dt>Returns: tuple</dt><dd><dl class="simple">
<dt>desc_df (DataFrame): A table of Mordred descriptors for the input SMILES strings that were valid</dt><dd><p>(according to RDKit), together with those SMILES strings.</p>
</dd>
<dt>is_valid (ndarray of bool): An array of length the same as smiles_strs, indicating which SMILES strings</dt><dd><p>were considered valid.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.create_featurization">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">create_featurization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#create_featurization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.create_featurization" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method to create the appropriate type of Featurization object for params.featurizer</p>
<dl class="simple">
<dt>Args:</dt><dd><p>params (argparse.Namespace: Object containing the parameter list</p>
</dd>
<dt>Returns:</dt><dd><p>Featurization object of the correct subclass as specified by params.featurizer</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If params.featurizer not in [‘ecfp’,’graphconv’,’molvae’,’computed_descriptors’,’descriptors’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.featurize_smiles">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">featurize_smiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_every_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#featurize_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.featurize_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Replacement for DeepChem 2.1 featurize_smiles_df function, which is buggy. Computes
features using featurizer for dataframe df column given by smiles_col. Returns them as
a numpy array, along with an array ‘is_valid’ indicating which rows of the input
dataframe yielded valid features.</p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.get_2d_mols">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">get_2d_mols</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_strs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#get_2d_mols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.get_2d_mols" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert SMILES strings to RDKit Mol objects without explicit hydrogens or 3D coordinates</p>
<dl class="simple">
<dt>Args:</dt><dd><p>smiles_strs (iterable of str): List of SMILES strings to convert</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple (mols, is_valid):</dt><dd><p>mols (ndarray of Mol): Mol objects for valid SMILES strings only
is_valid (ndarray of bool): True for each input SMILES string that was valid according to RDKit</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.get_3d_mols">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">get_3d_mols</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_strs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#get_3d_mols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.get_3d_mols" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert SMILES strings to Mol objects with explicit hydrogens and 3D coordinates</p>
<dl class="simple">
<dt>Args:</dt><dd><p>smiles_strs (iterable of str): List of SMILES strings to convert</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple (mols, is_valid):</dt><dd><p>mols (ndarray of Mol): Mol objects for valid SMILES strings only
is_valid (ndarray of bool): True for each input SMILES string that was valid according to RDKit</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.get_dataset_attributes">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">get_dataset_attributes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#get_dataset_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.get_dataset_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a table mapping compound IDs to SMILES strings and possibly other attributes
(e.g., dates) specified in params.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): The dataset table</p>
<p>params (Namespace): Parsed parameters. The id_col and smiles_col parameters are used
to specify the columns in dset_df containing compound IDs and SMILES strings, respectively. If
the parameter date_col is not None, it is used to specify a column of datetime strings associated
with each compound.</p>
</dd>
<dt>Returns:</dt><dd><p>attr_df (DataFrame): A table of SMILES strings and (optionally) other attributes, indexed by
compound_id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.get_mordred_calculator">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">get_mordred_calculator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['EState',</span> <span class="pre">'MolecularDistanceEdge']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_3D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#get_mordred_calculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.get_mordred_calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Mordred calculator with all descriptor modules registered except those whose names are in the exclude list.
Register ATOM versions of the classes in those modules instead.</p>
<dl>
<dt>Args:</dt><dd><p>exclude (list): List of Mordred descriptor modules to exclude.</p>
<p>ignore_3D (bool): Whether to exclude descriptors that require computing 3D structures.</p>
</dd>
<dt>Returns:</dt><dd><p>calc (mordred.Calculator): Object for performing Mordred descriptor calculations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.get_rdkit_calculator">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">get_rdkit_calculator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desc_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#get_rdkit_calculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.get_rdkit_calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Mordred calculator with only the RDKit wrapper descriptor modules registered</p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.get_user_specified_features">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">get_user_specified_features</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#get_user_specified_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.get_user_specified_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Temp fix for DC 2.3 issue. See
<a class="reference external" href="https://github.com/deepchem/deepchem/issues/1841">https://github.com/deepchem/deepchem/issues/1841</a></p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.make_weights">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">make_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#make_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.make_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>In the case of multitask learning, we must create weights for each sample labeling
it with 0 if there is not value or 1 if there is.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>vals: numpy array containing nans where there are not labels</p>
</dd>
<dt>Returns:</dt><dd><p>vals: numpy array same as input vals, but nans are replaced with 0
w: numpy array same shape as vals, where w[i,j] = 1 if vals[i,j] is nan else w[i,j] = 0</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.featurization.remove_duplicate_smiles">
<code class="sig-prename descclassname"><span class="pre">pipeline.featurization.</span></code><code class="sig-name descname"><span class="pre">remove_duplicate_smiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdkit_smiles'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/featurization.html#remove_duplicate_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.featurization.remove_duplicate_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove any rows with duplicate SMILES strings from the given dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): The dataset table.</p>
<p>smiles_col (str): The column containing SMILES strings.</p>
</dd>
<dt>Returns:</dt><dd><p>filtered_dset_df (DataFrame): The dataset filtered to remove duplicate SMILES strings.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.model_datasets">
<span id="pipeline-model-datasets-module"></span><h2>pipeline.model_datasets module<a class="headerlink" href="#module-pipeline.model_datasets" title="Permalink to this headline">¶</a></h2>
<p>Classes for dealing with datasets for data-driven modeling.</p>
<dl class="py class">
<dt id="pipeline.model_datasets.DatastoreDataset">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">DatastoreDataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#DatastoreDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.DatastoreDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.model_datasets.ModelDataset" title="pipeline.model_datasets.ModelDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.model_datasets.ModelDataset</span></code></a></p>
<p>Subclass representing a dataset for data-driven modeling that lives in the datastore.</p>
<blockquote>
<div><p>Attributes:</p>
<dl>
<dt>set in __init__:</dt><dd><p>params (Namespace object): contains all parameter information</p>
<p>log (logger object): logger for all warning messages.</p>
<p>dataset_name (str): set from the parameter object, the name of the dataset</p>
<p>output_dit (str): The root directory for saving output files</p>
<p>split_strategy (str): the flag for determining the split strategy (e.g. ‘train_test_valid’,’k-fold’)</p>
<p>featurization (Featurization object): The featurization object created by ModelDataset or input as an optional argument in the factory function.</p>
<p>splitting (Splitting object): A splitting object created by the ModelDataset intiailization method</p>
<p>combined_train_valid_data (dc.DiskDataset): A dataset object (initialized as None), of the merged train and valid splits
ds_client (datastore client):</p>
</dd>
<dt>set in get_featurized_data:</dt><dd><p>dataset: A new featurized DeepChem DiskDataset.</p>
<p>n_features: The count of features (int)</p>
<p>vals: The response col after featurization (np.array)</p>
<p>attr: A pd.dataframe containing the compound ids and smiles</p>
</dd>
<dt>set in get_dataset_tasks:</dt><dd><p>tasks (list): list of prediction task columns</p>
</dd>
<dt>set in split_dataset or load_presplit_dataset:</dt><dd><p>train_valid_dsets:  A list of tuples of (training,validation) DeepChem Datasets</p>
<p>test_dset: (dc.data.Dataset): The test dataset to be held out</p>
<p>train_valid_attr: A list of tuples of (training,validation) attribute DataFrames</p>
<p>test_attr: The attribute DataFrame for the test set, containing compound IDs and SMILES strings.</p>
</dd>
<dt>set in load_full_dataset()</dt><dd><p>dataset_key (str): The datastore key pointing to the dataset</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt id="pipeline.model_datasets.DatastoreDataset.get_dataset_tasks">
<code class="sig-name descname"><span class="pre">get_dataset_tasks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#DatastoreDataset.get_dataset_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.DatastoreDataset.get_dataset_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets self.tasks to the list of prediction task columns defined for this dataset. If the dataset is in the datastore,
these should be available in the metadata. Otherwise we guess by looking at the column names in dset_df
and excluding features, compound IDs, SMILES string columns, etc.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dset_df (pd.DataFrame): Dataset containing the prediction tasks</p>
</dd>
<dt>Returns:</dt><dd><p>Success (bool): Returns true if task names are retrieved.</p>
</dd>
<dt>Side effects:</dt><dd><p>Sets the task attribute of the DatastoreDataset object to a list of task names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.DatastoreDataset.load_dataset_split_table">
<code class="sig-name descname"><span class="pre">load_dataset_split_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#DatastoreDataset.load_dataset_split_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.DatastoreDataset.load_dataset_split_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads from the datastore a table of compound IDs assigned to each split subset of a dataset.
Called by load_presplit_dataset().</p>
<dl>
<dt>Args:</dt><dd><p>directory:    Ignored; included only for compatibility with the FileDataset version of this method.</p>
</dd>
<dt>Returns:</dt><dd><dl>
<dt>tuple(split_df, split_kv):</dt><dd><p>split_df (DataFrame): Table assigning compound IDs to split subsets and folds.
split_kv (dict): Dictionary of key-value pairs from the split table metadata; includes all the</p>
<blockquote>
<div><p>parameters that were used to define the split.</p>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.DatastoreDataset.load_featurized_data">
<code class="sig-name descname"><span class="pre">load_featurized_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#DatastoreDataset.load_featurized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.DatastoreDataset.load_featurized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads prefeaturized data from the datastore. Returns a data frame,
which is then passed to featurization.extract_prefeaturized_data() for processing.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>featurized_dset_df (pd.DataFrame): dataframe of the prefeaturized data, needs futher processing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.DatastoreDataset.load_full_dataset">
<code class="sig-name descname"><span class="pre">load_full_dataset</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#DatastoreDataset.load_full_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.DatastoreDataset.load_full_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the dataset from the datastore</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>dset_df: Dataset as a DataFrame</p>
</dd>
<dt>Raises:</dt><dd><p>Exception if dset_df is None or empty due to error in loading in dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.DatastoreDataset.save_featurized_data">
<code class="sig-name descname"><span class="pre">save_featurized_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">featurized_dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#DatastoreDataset.save_featurized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.DatastoreDataset.save_featurized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a featurized dataset to the datastore</p>
<dl class="simple">
<dt>Args:</dt><dd><p>featurized_dset_df: DataFrame containing the featurized dataset.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.DatastoreDataset.save_split_dataset">
<code class="sig-name descname"><span class="pre">save_split_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#DatastoreDataset.save_split_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.DatastoreDataset.save_split_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a table of compound IDs assigned to each split subset of a dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>directory:    Ignored; included only for compatibility with the FileDataset version of this method.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.model_datasets.FileDataset">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">FileDataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#FileDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.FileDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.model_datasets.ModelDataset" title="pipeline.model_datasets.ModelDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.model_datasets.ModelDataset</span></code></a></p>
<p>Subclass representing a dataset for data-driven modeling that lives in the filesystem.</p>
<p>Attributes:</p>
<blockquote>
<div><dl>
<dt>set in __init__:</dt><dd><p>params (Namespace object): contains all parameter information</p>
<p>log (logger object): logger for all warning messages.</p>
<p>dataset_name (str): set from the parameter object, the name of the dataset</p>
<p>output_dit (str): The root directory for saving output files</p>
<p>split_strategy (str): the flag for determining the split strategy (e.g. ‘train_test_valid’,’k-fold’)</p>
<p>featurization (Featurization object): The featurization object created by ModelDataset or input as an
optional argument in the factory function.</p>
<p>splitting (Splitting object): A splitting object created by the ModelDataset intiailization method</p>
<p>combined_train_valid_data (dc.DiskDataset): A dataset object (initialized as None), of the merged train and
valid splits</p>
<p>ds_client (datastore client):</p>
</dd>
<dt>set in get_featurized_data:</dt><dd><p>dataset: A new featurized DeepChem DiskDataset.</p>
<p>n_features: The count of features (int)</p>
<p>vals: The response col after featurization (np.array)</p>
<p>attr: A pd.dataframe containing the compound ids and smiles</p>
</dd>
<dt>set in get_dataset_tasks:</dt><dd><p>tasks (list): list of prediction task columns</p>
</dd>
<dt>set in split_dataset or load_presplit_dataset:</dt><dd><p>train_valid_dsets:  A list of tuples of (training,validation) DeepChem Datasets</p>
<p>test_dset: (dc.data.Dataset): The test dataset to be held out</p>
<p>train_valid_attr: A list of tuples of (training,validation) attribute DataFrames</p>
<p>test_attr: The attribute DataFrame for the test set, containing compound IDs and SMILES strings.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt id="pipeline.model_datasets.FileDataset.get_dataset_tasks">
<code class="sig-name descname"><span class="pre">get_dataset_tasks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#FileDataset.get_dataset_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.FileDataset.get_dataset_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of prediction task columns defined for this dataset. If the dataset is in the datastore,
these should be available in the metadata. Otherwise you can guess by looking at the column names in dset_df
and excluding features, compound IDs, SMILES string columns, etc.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dset_df (pd.DataFrame): Dataset as a DataFrame that contains columns for the prediction tasks</p>
</dd>
<dt>Returns:</dt><dd><p>sucess (boolean): True is self.tasks is set. False if not user supplied.</p>
</dd>
<dt>Side effects:</dt><dd><p>Sets the self.tasks attribute of FileDataset to be the list of prediction task columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.FileDataset.load_dataset_split_table">
<code class="sig-name descname"><span class="pre">load_dataset_split_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#FileDataset.load_dataset_split_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.FileDataset.load_dataset_split_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads from the filesystem a table of compound IDs assigned to each split subset of a dataset.
Called by load_presplit_dataset().</p>
<dl class="simple">
<dt>Args:</dt><dd><p>directory (str): Directory where the split table will be created. Defaults to the directory
of the current dataset.</p>
</dd>
<dt>Returns:</dt><dd><p>split_df (DataFrame): Table assigning compound IDs to split subsets and folds.
split_kv: None for the FileDataset version of this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.FileDataset.load_featurized_data">
<code class="sig-name descname"><span class="pre">load_featurized_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#FileDataset.load_featurized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.FileDataset.load_featurized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads prefeaturized data from the filesystem. Returns a data frame,
which is then passed to featurization.extract_prefeaturized_data() for processing.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>featurized_dset_df (pd.DataFrame): dataframe of the prefeaturized data, needs futher processing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.FileDataset.load_full_dataset">
<code class="sig-name descname"><span class="pre">load_full_dataset</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#FileDataset.load_full_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.FileDataset.load_full_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the dataset from the file system.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>dset_df: Dataset as a DataFrame loaded in from a CSV or feather file</p>
</dd>
<dt>Raises:</dt><dd><p>exception: if dataset is empty or failed to load</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.FileDataset.save_featurized_data">
<code class="sig-name descname"><span class="pre">save_featurized_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">featurized_dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#FileDataset.save_featurized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.FileDataset.save_featurized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a featurized dataset to the filesystem.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>featurized_dset_df (pd.DataFrame): Dataset as a DataFrame that contains the featurized data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.FileDataset.save_split_dataset">
<code class="sig-name descname"><span class="pre">save_split_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#FileDataset.save_split_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.FileDataset.save_split_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a table of compound IDs and split subset assignments for the current dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>directory (str): Directory where the split table will be created. Defaults to the directory
of the current dataset.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.model_datasets.MinimalDataset">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">MinimalDataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contains_responses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#MinimalDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.MinimalDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.model_datasets.ModelDataset" title="pipeline.model_datasets.ModelDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.model_datasets.ModelDataset</span></code></a></p>
<p>A lightweight dataset class that does not support persistence or splitting, and therefore can be
used for predictions with an existing model, but not for training a model. Is not expected to
contain response columns, i.e. the ground truth is assumed to be unknown.</p>
<blockquote>
<div><p>Attributes:</p>
<dl class="simple">
<dt>set in __init__:</dt><dd><p>params (Namespace object): contains all parameter information
log (logger object): logger for all warning messages.
featurization (Featurization object): The featurization object created by ModelDataset or input as an optional argument in the factory function.</p>
</dd>
<dt>set in get_featurized_data:</dt><dd><p>dataset: A new featurized DeepChem DiskDataset.
n_features: The count of features (int)
attr: A pd.dataframe containing the compound ids and smiles</p>
</dd>
<dt>set in get_dataset_tasks:</dt><dd><p>tasks (list): list of prediction task columns</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt id="pipeline.model_datasets.MinimalDataset.get_dataset_tasks">
<code class="sig-name descname"><span class="pre">get_dataset_tasks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#MinimalDataset.get_dataset_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.MinimalDataset.get_dataset_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets self.tasks to the list of prediction task columns defined for this dataset. These should be defined in
the params.response_cols list that was provided when this object was created.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dset_df (pd.DataFrame): Ignored in this version.</p>
</dd>
<dt>Returns:</dt><dd><p>Success (bool): Returns true if task names are retrieved.</p>
</dd>
<dt>Side effects:</dt><dd><p>Sets the task attribute of the MinimalDataset object to a list of task names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.MinimalDataset.get_featurized_data">
<code class="sig-name descname"><span class="pre">get_featurized_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_featurized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#MinimalDataset.get_featurized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.MinimalDataset.get_featurized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Featurizes the compound data provided in data frame dset_df, and creates an
associated DeepChem Dataset object.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): DataFrame either with compound id and smiles string or Feature matrix</p>
<p>is_featurized (Boolean): boolean specifying whether the dset_df is already featurized</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Side effects:</dt><dd><p>Sets the following attributes in the ModelDataset object:</p>
<blockquote>
<div><p>dataset: A new featurized DeepChem Dataset.</p>
<p>n_features: The count of features (int)</p>
<p>attr: A pd.dataframe containing the compound ids and smiles</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.MinimalDataset.save_featurized_data">
<code class="sig-name descname"><span class="pre">save_featurized_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">featurized_dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#MinimalDataset.save_featurized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.MinimalDataset.save_featurized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Does nothing, since a MinimalDataset object does not persist its data.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>featurized_dset_df (pd.DataFrame): Ignored.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.model_datasets.ModelDataset">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">ModelDataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class representing a dataset for data-driven modeling. Subclasses are specialized for dealing with
dataset objects persisted in the datastore or in the filesystem.</p>
<p>Attributes:</p>
<blockquote>
<div><dl>
<dt>set in __init__:</dt><dd><p>params (Namespace object): contains all parameter information</p>
<p>log (logger object): logger for all warning messages.</p>
<p>dataset_name (str): set from the parameter object, the name of the dataset</p>
<p>output_dit (str): The root directory for saving output files</p>
<p>split_strategy (str): the flag for determining the split strategy (e.g. ‘train_test_valid’,’k-fold’)</p>
<p>featurization (Featurization object): The featurization object created by ModelDataset or input as an
argument in the factory function.</p>
<p>splitting (Splitting object): A splitting object created by the ModelDataset intiailization method</p>
<p>combined_train_valid_data (dc.DiskDataset): A dataset object (initialized as None), of the merged train
and valid splits</p>
</dd>
<dt>set in get_featurized_data:</dt><dd><p>dataset: A new featurized DeepChem DiskDataset.</p>
<p>n_features: The count of features (int)</p>
<p>vals: The response col after featurization (np.array)</p>
<p>attr: A pd.dataframe containing the compound ids and smiles</p>
</dd>
<dt>set in get_dataset_tasks:</dt><dd><p>tasks (list): list of prediction task columns</p>
</dd>
<dt>set in split_dataset or load_presplit_dataset:</dt><dd><p>train_valid_dsets:  A list of tuples of (training,validation) DeepChem Datasets</p>
<p>test_dset: (dc.data.Dataset): The test dataset to be held out</p>
<p>train_valid_attr: A list of tuples of (training,validation) attribute DataFrames</p>
<p>test_attr: The attribute DataFrame for the test set, containing compound IDs and SMILES strings.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.check_task_columns">
<code class="sig-name descname"><span class="pre">check_task_columns</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.check_task_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.check_task_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the data frame dset_df contains columns for the requested prediction tasks.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dset_df (pd.DataFrame): Dataset as a DataFrame that contains columns for the prediction tasks</p>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>Exception:</dt><dd><p>If self.get_dataset_tasks(dset_df) cannot retrieve prediction tasks for the dtaset
If missing prediction task columns from the input dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.combined_training_data">
<code class="sig-name descname"><span class="pre">combined_training_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.combined_training_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.combined_training_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a DeepChem Dataset object containing data for the combined training &amp; validation compounds.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>combined_dataset (dc.data.DiskDataset): Dataset containing the combined training
and validation data.</p>
</dd>
<dt>Side effects:</dt><dd><p>Overwrites the combined_train_valid_data attribute of the ModelDataset with the combined data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.create_dataset_split_table">
<code class="sig-name descname"><span class="pre">create_dataset_split_table</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.create_dataset_split_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.create_dataset_split_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a data frame containing the information needed to reconstruct the current
train/valid/test or k-fold split.</p>
<dl>
<dt>Returns:</dt><dd><dl>
<dt>split_df (DataFrame): Table with one row per compound in the dataset, with columns:</dt><dd><p>cmpd_id:    Compound ID</p>
<dl class="simple">
<dt>subset:     The subset the compound was assigned to in the split. Either ‘train’, ‘valid’,</dt><dd><p>‘test’, or ‘train_valid’. ‘train_valid’ is used for a k-fold split to indicate
that the compound was rotated between training and validation sets.</p>
</dd>
<dt>fold:       For a k-fold split, an integer indicating the fold in which the compound was in</dt><dd><p>the validation set. Is zero for compounds in the test set and for all compounds
when a train/valid/test split was used.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.get_dataset_tasks">
<code class="sig-name descname"><span class="pre">get_dataset_tasks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.get_dataset_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.get_dataset_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets self.tasks to the list of prediction task columns defined for this dataset. If the dataset is in the datastore,
these should be available in the metadata. Otherwise we guess by looking at the column names in dset_df
and excluding features, compound IDs, SMILES string columns, etc.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dset_df (pd.DataFrame): Dataset as a DataFrame that contains columns for the prediction tasks</p>
</dd>
<dt>Returns:</dt><dd><p>sucess (boolean): True is self.tasks is set. False if not user supplied.</p>
</dd>
<dt>Side effects:</dt><dd><p>Sets the self.tasks attribute to be the list of prediction task columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.get_featurized_data">
<code class="sig-name descname"><span class="pre">get_featurized_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.get_featurized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.get_featurized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Does whatever is necessary to prepare a featurized dataset.
Loads an existing prefeaturized dataset if one exists and if parameter previously_featurized is
set True; otherwise loads a raw dataset and featurizes it. Creates an associated DeepChem Dataset
object.</p>
<dl class="simple">
<dt>Side effects:</dt><dd><dl class="simple">
<dt>Sets the following attributes in the ModelDataset object:</dt><dd><p>dataset: A new featurized DeepChem DiskDataset.
n_features: The count of features (int)
vals: The response col after featurization (np.array)
attr: A pd.dataframe containing the compound ids and smiles</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.get_split_metadata">
<code class="sig-name descname"><span class="pre">get_split_metadata</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.get_split_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.get_split_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dictionary of the parameters related to dataset splitting, to be saved in the model tracker
along with the other metadata needed to reproduce a model run.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>dict: A dictionary containing the data needed to reproduce the current dataset training/validation/test
splits, including the lists of compound IDs for each split subset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.get_subset_responses_and_weights">
<code class="sig-name descname"><span class="pre">get_subset_responses_and_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.get_subset_responses_and_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.get_subset_responses_and_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary mapping compound IDs in the given dataset subset to arrays of response values
and weights.  Used by the perf_data module under k-fold CV.</p>
<dl>
<dt>Args:</dt><dd><p>subset (string): Label of subset, ‘train’, ‘test’, or ‘valid’</p>
<p>transformers: Transformers object for full dataset</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple(response_dict, weight_dict)</dt><dd><p>(response_dict): dictionary mapping compound ids to arrays of per-task untransformed response values
(weight_dict): dictionary mapping compound ids to arrays of per-task weights</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.has_all_feature_columns">
<code class="sig-name descname"><span class="pre">has_all_feature_columns</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.has_all_feature_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.has_all_feature_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the columns in dataframe dset_df against the feature columns required by
the current featurization and descriptor_type param. Returns True if dset_df contains
all the required columns.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dset_df (DataFrame): Feature matrix</p>
</dd>
<dt>Returns:</dt><dd><p>(Boolean): boolean specifying whether there are any missing columns in dset_df</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.load_featurized_data">
<code class="sig-name descname"><span class="pre">load_featurized_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.load_featurized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.load_featurized_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads prefeaturized data from the datastore or filesystem. Returns a data frame,
which is then passed to featurization.extract_prefeaturized_data() for processing.</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.load_full_dataset">
<code class="sig-name descname"><span class="pre">load_full_dataset</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.load_full_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.load_full_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the dataset from the datastore or the file system.</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.load_presplit_dataset">
<code class="sig-name descname"><span class="pre">load_presplit_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.load_presplit_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.load_presplit_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a table of compound IDs assigned to split subsets, and uses them to split
the currently loaded featurized dataset.</p>
<dl>
<dt>Args:</dt><dd><p>directory (str): Optional directory where the split table is stored; used only by FileDataset.</p>
<p>Defaults to the directory containing the current dataset.</p>
</dd>
<dt>Returns:</dt><dd><p>success (boolean): True if the split table was loaded successfully and used to split the dataset.</p>
<dl>
<dt>Side effects:</dt><dd><dl>
<dt>Sets the following attributes of the ModelDataset object</dt><dd><p>train_valid_dsets:  A list of tuples of (training,validation) DeepChem Datasets</p>
<p>test_dset: (dc.data.Dataset): The test dataset to be held out</p>
<p>train_valid_attr: A list of tuples of (training,validation) attribute DataFrames</p>
<p>test_attr: The attribute DataFrame for the test set, containing compound IDs and SMILES strings.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>Exception: Catches exceptions from split.select_dset_by_attr_ids</dt><dd><p>or from other errors while splitting dataset using metadata</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_datasets.ModelDataset.split_dataset">
<code class="sig-name descname"><span class="pre">split_dataset</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#ModelDataset.split_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.ModelDataset.split_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the dataset into paired training/validation and test subsets, according to the split strategy
selected by the model params. For traditional train/valid/test splits, there is only one training/validation
pair. For k-fold cross-validation splits, there are k different train/valid pairs; the validation sets are
disjoint but the training sets overlap.</p>
<dl>
<dt>Side effects:</dt><dd><dl>
<dt>Sets the following attributes in the ModelDataset object:</dt><dd><p>train_valid_dsets:  A list of tuples of (training,validation) DeepChem Datasets</p>
<p>test_dset: (dc.data.Dataset): The test dataset to be held out</p>
<p>train_valid_attr: A list of tuples of (training,validation) attribute DataFrames</p>
<p>test_attr: The attribute DataFrame for the test set, containing compound IDs and SMILES strings.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pipeline.model_datasets.create_minimal_dataset">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">create_minimal_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contains_responses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#create_minimal_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.create_minimal_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a MinimalDataset object for non-persistent data (e.g., a list of compounds or SMILES
strings or a data frame). This object will be suitable for running predictions on a pretrained
model, but not for training.</p>
<dl>
<dt>Args:</dt><dd><p>params (Namespace object): contains all parameter information.</p>
<p>featurization (Featurization object): The featurization object created by ModelDataset or input as an argument
in the factory function.</p>
<p>contains_responses (Boolean): Boolean specifying whether the dataset has a column with response values</p>
</dd>
<dt>Returns:</dt><dd><p>(MinimalDataset): a new MinimalDataset object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_datasets.create_model_dataset">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">create_model_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#create_model_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.create_model_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory function for creating DatastoreDataset or FileDataset objects.</p>
<dl>
<dt>Args:</dt><dd><p>params (Namespace object): contains all parameter information.</p>
<p>featurization (Featurization object): The featurization object created by ModelDataset or input as an argument
in the factory function.</p>
<p>ds_client (Datastore client)</p>
</dd>
<dt>Returns:</dt><dd><p>either (DatastoreDataset) or (FileDataset): instantiated ModelDataset subclass specified by params</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_datasets.create_split_dataset_from_metadata">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">create_split_dataset_from_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#create_split_dataset_from_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.create_split_dataset_from_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that pulls the split metadata from the datastore and then joins that info with the dataset itself.
Args:</p>
<blockquote>
<div><p>model_metadata (Namespace): Namespace object of model metadata</p>
<p>ds_client: datastore client</p>
<p>save_file (Boolean): Boolean specifying whether we want to save split dataset to disk</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>(DataFrame): DataFrame with subset information and response column</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_datasets.key_value_list_to_dict">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">key_value_list_to_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kvp_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#key_value_list_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.key_value_list_to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a key-value pair list from the datastore metadata into a proper dictionary</p>
<dl class="simple">
<dt>Args:</dt><dd><p>kvp_list (list): List of key-value pairs</p>
</dd>
<dt>Returns:</dt><dd><p>(dictionary): the kvp-list reformatted as a dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_datasets.save_joined_dataset">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">save_joined_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">joined_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#save_joined_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.save_joined_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED: Refers to absolute file paths that no longer exist.</p>
<dl>
<dt>Args:</dt><dd><p>joined_dataset (DataFrame): DataFrame containing split information with the response column</p>
<p>split_metadata (dictionary): Dictionary containing metadata with split info</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_datasets.set_group_permissions">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_datasets.</span></code><code class="sig-name descname"><span class="pre">set_group_permissions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_owner_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_datasets.html#set_group_permissions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_datasets.set_group_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Set file group and permissions to standard values for a dataset containing proprietary
or public data, as indicated by ‘data_owner’.</p>
<dl>
<dt>Args:</dt><dd><p>system (string): Determine the group ownership (at the moment ‘LC’, ‘AD’)</p>
<p>path (string): File path</p>
<p>data_owner (string): Who the data belongs to, either ‘public’ or the name of a company (e.g. ‘gsk’) associated
with a restricted access group.</p>
<blockquote>
<div><p>‘username’: group is set to the current user’s username
‘data_owner_group’: group is set to data_owner_group
Otherwise, group is set by hard-coded dictionary.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.model_pipeline">
<span id="pipeline-model-pipeline-module"></span><h2>pipeline.model_pipeline module<a class="headerlink" href="#module-pipeline.model_pipeline" title="Permalink to this headline">¶</a></h2>
<p>Contains class ModelPipeline, which loads in a dataset, splits it, trains a model, and generates predictions and output
metrics for that model. Works for a variety of featurizers, splitters and other parameters on a generic dataset</p>
<dl class="py class">
<dt id="pipeline.model_pipeline.ModelPipeline">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">ModelPipeline</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlmt_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains methods to load in a dataset, split and featurize the data, fit a model to the train dataset,
generate predictions for an input dataset, and generate performance metrics for these predictions.</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>Set in __init__:</dt><dd><p>params (argparse.Namespace): The argparse.Namespace parameter object</p>
<p>log (log): The logger</p>
<p>run_mode (str): A flag determine the mode of model pipeline (eg. training or prediction)</p>
<p>params.dataset_name (argparse.Namespace): The dataset_name parameter of the dataset</p>
<p>ds_client (ac.DatastoreClient): the datastore api token to interact with the datastore</p>
<p>perf_dict (dict): The performance dictionary</p>
<p>output_dir (str): The parent path of the model directory</p>
<p>mlmt_client: The mlmt service client</p>
<p>metric_type (str): Defines the type of metric (e.g. roc_auc_score, r2_score)</p>
</dd>
<dt>set in train_model or run_predictions:</dt><dd><p>run_mode (str): The mode to run the pipeline, set to training</p>
<p>featurziation (Featurization object): The featurization argument or the featurizatioin created from the
input parameters</p>
<p>model_wrapper (ModelWrapper objct): A model wrapper created from the parameters and featurization object.</p>
</dd>
<dt>set in create_model_metadata:</dt><dd><p>model_metadata (dict): The model metadata dictionary that stores the model metrics and metadata</p>
</dd>
<dt>Set in load_featurize_data</dt><dd><p>data (ModelDataset object): A data object that featurizes and splits the dataset</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.calc_train_dset_pair_dis">
<code class="sig-name descname"><span class="pre">calc_train_dset_pair_dis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.calc_train_dset_pair_dis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.calc_train_dset_pair_dis" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the pairwise distance for training set compound feature vectors, needed for AD calculation.</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.create_model_metadata">
<code class="sig-name descname"><span class="pre">create_model_metadata</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.create_model_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.create_model_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a data structure describing the current model, to be saved in the model zoo.
This should include everything necessary to reproduce a model run.</p>
<dl class="simple">
<dt>Side effect:</dt><dd><p>Sets self.model_metadata (dictionary): A dictionary of the model metadata required to recreate the model.
Also contains metadata about the generating dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.create_prediction_metadata">
<code class="sig-name descname"><span class="pre">create_prediction_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_results</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.create_prediction_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.create_prediction_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a data structure to hold performance metrics from a model run on a new dataset,
to be stored in the model tracker DB. Note that this isn’t used
for the training run metadata; the training_metrics section is created by the train_model() function.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>prediction_metadata (dict): A dictionary of the metadata for a model run on a new dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.get_metrics">
<code class="sig-name descname"><span class="pre">get_metrics</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.get_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.get_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the model performance metrics from any previous training and prediction runs
from the model tracker</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.load_featurize_data">
<code class="sig-name descname"><span class="pre">load_featurize_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.load_featurize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.load_featurize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the dataset from the datastore or the file system and featurizes it. If we are training
a new model, split the dataset into training, validation and test sets.</p>
<p>The data is also split into training, validation, and test sets and saved to the filesystem or datastore.</p>
<p>Assumes a ModelWrapper object has already been created.</p>
<dl class="simple">
<dt>Side effects:</dt><dd><dl class="simple">
<dt>Sets the following attributes of the ModelPipeline</dt><dd><dl class="simple">
<dt>data (ModelDataset object): A data object that featurizes and splits the dataset</dt><dd><p>data.dataset(dc.DiskDataset): The transformed, featurized, and split dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.predict_full_dataset">
<code class="sig-name descname"><span class="pre">predict_full_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_featurized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contains_responses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AD_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.predict_full_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.predict_full_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute predicted responses from a pretrained model on a set of compounds listed in
a data frame. The data frame should contain, at minimum, a column of compound IDs; if
SMILES strings are needed to compute features, they should be provided as well. Feature
columns may be provided as well. If response columns are included in the input, they will
be included in the output as well to facilitate performance metric calculations.</p>
<p>This function is similar to predict_on_dataframe, except that it supports multitask models,
and includes class probabilities in the output for classifier models.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (DataFrame): A data frame containing compound IDs (if the compounds are to be
featurized using descriptors) and/or SMILES strings (if the compounds are to be
featurized using ECFP fingerprints or graph convolution) and/or precomputed features.
The column names for the compound ID and SMILES columns should match id_col and smiles_col,
respectively, in the model parameters.</p>
<p>is_featurized (bool): True if dset_df contains precomputed feature columns. If so,
dset_df must contain <em>all</em> of the feature columns defined by the featurizer that was
used when the model was trained.</p>
<p>contains_responses (bool): True if dataframe contains response values</p>
<p>dset_params (Namespace):  Parameters used to interpret dataset, including id_col, smiles_col,
and optionally, response_cols. If not provided, id_col, smiles_col and response_cols are
assumed to be same as in the pretrained model.</p>
<p>AD_method (str): with default, Applicable domain (AD) index will not be calcualted, use 
z_score or local_density to choose the method to calculate AD index.</p>
<p>k (int): number of the neareast neighbors to evaluate the AD index, default is 5.</p>
<p>dist_metric (str): distance metrics, valid values are ‘cityblock’, ‘cosine’, ‘euclidean’, ‘jaccard’, ‘manhattan’</p>
</dd>
<dt>Returns:</dt><dd><p>result_df (DataFrame): Data frame indexed by compound IDs containing a column of SMILES
strings, with additional columns containing the predicted values for each response variable.
If the model was trained to predict uncertainties, the returned data frame will also
include standard deviation columns (named &lt;response_col&gt;_std) for each response variable.
The result data frame may not include all the compounds in the input dataset, because
the featurizer may not be able to featurize all of them.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.predict_on_dataframe">
<code class="sig-name descname"><span class="pre">predict_on_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_featurized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contains_responses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AD_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.predict_on_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.predict_on_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute predicted responses from a pretrained model on a set of compounds listed in
a data frame. the data frame should contain, at minimum, a column of compound IDs; if
SMILES strings are needed to compute features, they should be provided as well.</p>
<dl>
<dt>Args:</dt><dd><p>dset_df (Dataframe): A data frame containing compound IDs (if the compounds are to be
featurized using descriptors) and/or SMILES strings (if the compounds are to be
featurized using ECFP fingerprints or graph convolution) and/or precomputed features.
The column names for the compound ID and SMILES columns should match id_col and smiles_col,
respectively, in the model parameters.</p>
<p>is_featurized (bool): True if dset_df contains precomputed feature columns. If so,
dset_df must contain <em>all</em> of the feature columns defined by the featurizer that was
used when the model was trained.</p>
<p>contains_responses (bool): True if dataframe contains response values</p>
<p>AD_method (str): with default, Applicable domain (AD) index will not be calcualted, use 
z_score or local_density to choose the method to calculate AD index.</p>
<p>k (int): number of the neareast neighbors to evaluate the AD index, default is 5.</p>
<p>dist_metric (str): distance metrics, valid values are ‘cityblock’, ‘cosine’, ‘euclidean’, ‘jaccard’, ‘manhattan’</p>
</dd>
<dt>returns:</dt><dd><p>result_df (dataframe): data frame indexed by compound ids containing a column of smiles
strings, with additional columns containing the predicted values for each response variable.
If the model was trained to predict uncertainties, the returned data frame will also
include standard deviation columns (named &lt;response_col&gt;_std) for each response variable.
The result data frame may not include all the compounds in the input dataset, because
the featurizer may not be able to featurize all of them.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.predict_on_smiles">
<code class="sig-name descname"><span class="pre">predict_on_smiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AD_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.predict_on_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.predict_on_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute predicted responses from a pretrained model on a set of compounds given as a list of SMILES strings.</p>
<dl>
<dt>Args:</dt><dd><p>smiles (list): A list containting valid SMILES strings</p>
<p>verbose (boolean): A switch for disabling informational messages</p>
<p>AD_method (str): with default, Applicable domain (AD) index will not be calcualted, use 
z_score or local_density to choose the method to calculate AD index.</p>
<p>k (int): number of the neareast neighbors to evaluate the AD index, default is 5.</p>
<p>dist_metric (str): distance metrics, valid values are ‘cityblock’, ‘cosine’, ‘euclidean’, ‘jaccard’, ‘manhattan’</p>
</dd>
<dt>Returns:</dt><dd><p>res (DataFrame): Data frame indexed by compound IDs containing a column of SMILES
strings, with additional columns containing the predicted values for each response variable.
If the model was trained to predict uncertainties, the returned data frame will also
include standard deviation columns (named &lt;response_col&gt;_std) for each response variable.
The result data frame may not include all the compounds in the input dataset, because
the featurizer may not be able to featurize all of them.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.run_predictions">
<code class="sig-name descname"><span class="pre">run_predictions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">featurization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.run_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.run_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a previously trained model, and use it to run predictions on a new dataset.</p>
<p>Generate predictions for a specified dataset, and save the predictions and performance
metrics in the model results DB or in a JSON file.</p>
<dl>
<dt>Args:</dt><dd><p>featurization (Featurization Object): An optional featurization object for creating the model wrappr</p>
</dd>
<dt>Side effects:</dt><dd><dl>
<dt>Sets the following attributes of ModelPipeline:</dt><dd><p>run_mode (str): The mode to run the pipeline, set to prediction</p>
<p>featurization (Featurization object): The featurization argument or the featurization created from the
input parameters</p>
<p>model_wrapper (ModelWrapper object): A model wrapper created from the parameters and featurization object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.save_metrics">
<code class="sig-name descname"><span class="pre">save_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sleep_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.save_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.save_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the given model_metrics dictionary either to the model tracker database, or
to a JSON file on disk.</p>
<p>If writing to disk, outputs to a JSON file &lt;prefix&gt;_model_metrics.json in the current output directory.</p>
<dl>
<dt>Args:</dt><dd><p>model_metrics (dict or list): Either a dictionary containing the model performance metrics, or a
list of dictionaries with metrics for each training label and subset.</p>
<p>prefix: An optional prefix to include in the JSON filename, only used if writing to disk (i.e., if
self.params.save_results is False).</p>
<p>retries (int): Number of retries to save to model tracker DB, if save_results is True.</p>
<p>sleep_sec (int): Number of seconds to sleep between retries.</p>
</dd>
<dt>Side effects:</dt><dd><p>Saves the model_metrics dictionary to the model tracker database, or writes out a .json file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.save_model_metadata">
<code class="sig-name descname"><span class="pre">save_model_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sleep_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.save_model_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.save_model_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the data needed to reload the model in the model tracker DB or in a local tarball file.</p>
<p>Inserts the model metadata into the model tracker DB, if self.params.save_results is True.
Otherwise, saves the model metadata to a local .json file. Generates a gzipped tar archive
containing the metadata file, the transformer parameters and the model checkpoint files, and
saves it in the datastore or the filesystem according to the value of save_results.</p>
<dl>
<dt>Args:</dt><dd><p>retries (int): Number of times to retry saving to model tracker DB.</p>
<p>sleep_sec (int): Number of seconds to sleep between retries, if saving to model tracker DB.</p>
</dd>
<dt>Side effects:</dt><dd><p>Saves the model metadata and parameters into the model tracker DB or a local tarball file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.split_dataset">
<code class="sig-name descname"><span class="pre">split_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">featurization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.split_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.split_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Load, featurize and split the dataset according to the current model parameter settings,
but don’t actually train a model. Returns the split_uuid for the dataset split.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>featurization (Featurization object): An optional featurization object.</p>
</dd>
<dt>Return:</dt><dd><p>split_uuid (str): The unique identifier for the dataset split.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_pipeline.ModelPipeline.train_model">
<code class="sig-name descname"><span class="pre">train_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">featurization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ModelPipeline.train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ModelPipeline.train_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build model described by self.params on the training dataset described by self.params.</p>
<p>Generate predictions for the training, validation, and test datasets, and save the predictions and
performance metrics in the model results DB or in a JSON file.</p>
<dl>
<dt>Args:</dt><dd><p>featurization (Featurization object): An optional featurization object for creating models on a
prefeaturized dataset</p>
</dd>
<dt>Side effects:</dt><dd><dl>
<dt>Sets the following attributes of the ModelPipeline object</dt><dd><p>run_mode (str): The mode to run the pipeline, set to training</p>
<p>featurization (Featurization object): The featurization argument or the featurization created from the
input parameters</p>
<p>model_wrapper (ModelWrapper objct): A model wrapper created from the parameters and featurization object.</p>
<p>model_metadata (dict): The model metadata dictionary that stores the model metrics and metadata</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.calc_AD_kmean_dist">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">calc_AD_kmean_dist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dset_pair_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#calc_AD_kmean_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.calc_AD_kmean_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the probability of the prediction dataset fall in the the domain of traning set. Use Euclidean distance of the K nearest neighbours.
train_dset and pred_dset should be in 2D numpy array format where each row is a compound.</p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.calc_AD_kmean_local_density">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">calc_AD_kmean_local_density</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dset_pair_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#calc_AD_kmean_local_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.calc_AD_kmean_local_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the AD of pred data by comparing the distance betweenthe unseen object and its k nearest neighbors in the training set to the distance between these k nearest neighbors and their k nearest neighbors in the training set. Return the distance ratio. Greater than 1 means the pred data is far from the domain.</p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.create_prediction_pipeline">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">create_prediction_pipeline</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_uuid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_bucket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CRADA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#create_prediction_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.create_prediction_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ModelPipeline object to be used for running blind predictions on datasets
where the ground truth is not known, given a pretrained model in the model tracker database.</p>
<dl>
<dt>Args:</dt><dd><p>params (Namespace or dict): A parsed parameters namespace, containing parameters describing how input
datasets should be processed. If a dictionary is passed, it will be parsed to fill in default values
and convert it to a Namespace object.</p>
<p>model_uuid (str): The UUID of a trained model.</p>
<p>collection_name (str): The collection where the model is stored in the model tracker DB.</p>
<p>featurization (Featurization): An optional featurization object to be used for featurizing the input data.
If none is provided, one will be created based on the stored model parameters.</p>
<p>alt_bucket (str): Alternative bucket to search for model tarball and transformer files, if
original bucket no longer exists.</p>
</dd>
<dt>Returns:</dt><dd><p>pipeline (ModelPipeline): A pipeline object to be used for making predictions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.create_prediction_pipeline_from_file">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">create_prediction_pipeline_from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best_model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#create_prediction_pipeline_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.create_prediction_pipeline_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ModelPipeline object to be used for running blind predictions on datasets, given a pretrained model stored
in the filesystem. The model may be stored either as a gzipped tar archive or as a directory.</p>
<dl>
<dt>Args:</dt><dd><p>params (Namespace): A parsed parameters namespace, containing parameters describing how input
datasets should be processed.</p>
<dl class="simple">
<dt>reload_dir (str): The path to the parent directory containing the various model subdirectories</dt><dd><p>(e.g.: ‘/home/cdsw/model/delaney-processed/delaney-processed/pxc50_NN_graphconv_scaffold_regression/’).</p>
</dd>
</dl>
<p>If reload_dir is None, then model_path must be specified. If both are specified, then the tar archive given
by model_path will be unpacked into reload_dir, possibly overwriting existing files in that directory.</p>
<p>model_path (str): Path to a gzipped tar archive containing the saved model metadata and parameters. If specified,
the tar archive is unpacked into reload_dir if that directory is given, or to a temporary directory otherwise.</p>
<p>model_type (str): Name of the subdirectory in reload_dir or in the tar archive where the trained model state parameters
should be loaded from.</p>
<p>featurization (Featurization): An optional featurization object to be used for featurizing the input data.
If none is provided, one will be created based on the stored model parameters.</p>
</dd>
<dt>Returns:</dt><dd><p>pipeline (ModelPipeline): A pipeline object to be used for making predictions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.ensemble_predict">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">ensemble_predict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_uuids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mt_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contains_responses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#ensemble_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.ensemble_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a series of pretrained models and predict responses with each model; then aggregate
the predicted responses into one prediction per compound.</p>
<dl>
<dt>Args:</dt><dd><p>model_uuids (iterable of str): Sequence of UUIDs of trained models.</p>
<p>collections (str or iterable of str): The collection(s) where the models are stored in the
model tracker DB. If a single string, the same collection is assumed to contain all the models.
Otherwise, collections should be of the same length as model_uuids.</p>
<p>dset_df (DataFrame): Dataset to perform predictions on. Should contain compound IDs and
SMILES strings. May contain features.</p>
<p>labels (iterable of str): Optional suffixes for model-specific prediction column names.
If not provided, the columns are labeled ‘pred_&lt;uuid&gt;’ where &lt;uuid&gt; is the model UUID.</p>
<p>dset_params (Namespace): Parameters used to interpret dataset, including id_col and smiles_col.
If not provided, id_col and smiles_col are assumed to be same as in the pretrained model and
the same for all models.</p>
<p>mt_client: Ignored, for backward compatibility only.</p>
<p>aggregate (str): Method to be used to combine predictions.</p>
</dd>
<dt>Returns:</dt><dd><p>pred_df (DataFrame): Table with predicted responses from each model, plus the ensemble prediction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.load_from_tracker">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">load_from_tracker</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_uuid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_bucket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CRADA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#load_from_tracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.load_from_tracker" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ModelPipeline object using the metadata in the  model tracker.</p>
<dl>
<dt>Args:</dt><dd><p>model_uuid (str): The UUID of a trained model.</p>
<p>collection_name (str): The collection where the model is stored in the model tracker DB.</p>
<p>client : Ignored, for backward compatibility only</p>
<p>verbose (bool): A switch for disabling informational messages</p>
<p>alt_bucket (str): Alternative bucket to search for model tarball and transformer files, if
original bucket no longer exists.</p>
</dd>
<dt>Returns:</dt><dd><dl>
<dt>tuple of:</dt><dd><p>pipeline (ModelPipeline): A pipeline object to be used for making predictions.</p>
<p>pparams (Namespace): Parsed parameter namespace from the requested model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.main">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">main</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry point when script is run from a shell</p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.regenerate_results">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">regenerate_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_featurization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'twintron-blue'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#regenerate_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.regenerate_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the model tracker for models matching the criteria in params.model_filter. Run
predictions with each model using the dataset specified by the remaining parameters.</p>
<dl>
<dt>Args:</dt><dd><p>result_dir (str): Parent of directory where result files will be written</p>
<p>params (Namespace): Parsed parameters</p>
<p>metadata_dict (dict): Model metadata</p>
<p>shared_featurization (Featurization): Object to map compounds to features, shared across models.
User is responsible for ensuring that shared_featurization is compatible with all matching models.</p>
<p>system (str): System name</p>
</dd>
<dt>Returns:</dt><dd><p>result_dict (dict): Results from predictions</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.retrain_model">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">retrain_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_uuid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mt_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#retrain_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.retrain_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain model parameters from the metadata in the model tracker, given the model_uuid,
and train a new model using exactly the same parameters (except for result_dir). Returns
the resulting ModelPipeline object. The pipeline object can then be used as input for
performance plots and other analyses that can’t be done using just the metrics stored
in the model tracker; or to make predictions on new data.</p>
<dl>
<dt>Args:</dt><dd><p>model_uuid (str): The UUID of a trained model.</p>
<p>collection_name (str): The collection where the model is stored in the model tracker DB.</p>
<p>result_dir (str): The directory of model results when the model tracker is not available.</p>
<p>mt_client : Ignored</p>
<p>verbose (bool): A switch for disabling informational messages</p>
</dd>
<dt>Returns:</dt><dd><p>pipeline (ModelPipeline): A pipeline object containing data from the model training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_pipeline.run_models">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_pipeline.</span></code><code class="sig-name descname"><span class="pre">run_models</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_featurization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_pipeline.html#run_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_pipeline.run_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the model tracker for models matching the criteria in params.model_filter. Run
predictions with each model using the dataset specified by the remaining parameters.</p>
<dl>
<dt>Args:</dt><dd><p>params (Namespace): Parsed parameters</p>
<p>shared_featurization (Featurization): Object to map compounds to features, shared across models.
User is responsible for ensuring that shared_featurization is compatible with all matching models.</p>
<p>generator (bool): True if run as a generator</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.model_tracker">
<span id="pipeline-model-tracker-module"></span><h2>pipeline.model_tracker module<a class="headerlink" href="#module-pipeline.model_tracker" title="Permalink to this headline">¶</a></h2>
<p>Module to interface model pipeline to model tracker service.</p>
<dl class="py exception">
<dt id="pipeline.model_tracker.DatastoreInsertionException">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">DatastoreInsertionException</span></code><a class="reference internal" href="_modules/pipeline/model_tracker.html#DatastoreInsertionException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.DatastoreInsertionException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="pipeline.model_tracker.MLMTClientInstantiationException">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">MLMTClientInstantiationException</span></code><a class="reference internal" href="_modules/pipeline/model_tracker.html#MLMTClientInstantiationException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.MLMTClientInstantiationException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="pipeline.model_tracker.UnableToTarException">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">UnableToTarException</span></code><a class="reference internal" href="_modules/pipeline/model_tracker.html#UnableToTarException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.UnableToTarException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.convert_metadata">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">convert_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#convert_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.convert_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert model metadata from old format (with camel-case parameter group names) to new format.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>old_metadata (dict): Model metadata in old format</p>
</dd>
<dt>Returns:</dt><dd><p>new_metadata (dict): Model metadata in new format</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.export_model">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">export_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_uuid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_bucket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CRADA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#export_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.export_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the metadata (parameters) and other files needed to recreate a model
from the model tracker database to a gzipped tar archive.</p>
<dl>
<dt>Args:</dt><dd><p>model_uuid (str): Model unique identifier</p>
<p>collection (str): Name of the collection holding the model in the database.</p>
<p>model_dir (str): Path to directory where the model metadata and parameter files will be written. The directory will
be created if it doesn’t already exist. Subsequently, the directory contents will be packed into a gzipped tar archive
named model_dir.tar.gz.</p>
<p>alt_bucket (str): Alternate datastore bucket to search for model tarball and transformer objects.</p>
</dd>
<dt>Returns:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.get_full_metadata">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">get_full_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#get_full_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.get_full_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve relevant full metadata (including training run metrics) of models matching given criteria.</p>
<dl>
<dt>Args:</dt><dd><p>filter_dict (dict): dictionary to filter on</p>
<p>collection_name (str): Name of collection to search</p>
</dd>
<dt>Returns:</dt><dd><p>A list of matching full model metadata (including training run metrics) dictionaries. Raises MongoQueryException if the query fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.get_full_metadata_by_uuid">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">get_full_metadata_by_uuid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_uuid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#get_full_metadata_by_uuid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.get_full_metadata_by_uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve model parameter metadata for the given model_uuid and collection.
The returned metadata dictionary will include training run performance metrics and
training dataset metadata.</p>
<dl>
<dt>Args:</dt><dd><p>model_uuid (str): model unique identifier</p>
<p>collection_name(str): collection to search (optional, searches all collections if not specified)</p>
</dd>
<dt>Returns:</dt><dd><p>Matching metadata dictionary. Raises MongoQueryException if the query fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.get_metadata_by_uuid">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">get_metadata_by_uuid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_uuid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#get_metadata_by_uuid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.get_metadata_by_uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve model parameter metadata by model_uuid. The resulting metadata dictionary can
be passed to parameter_parser.wrapper(); it does not contain performance metrics or
training dataset metadata.</p>
<dl>
<dt>Args:</dt><dd><p>model_uuid (str): model unique identifier</p>
<p>collection_name(str): collection to search (optional, searches all collections if not specified)</p>
</dd>
<dt>Returns:</dt><dd><p>Matching metadata dictionary. Raises MongoQueryException if the query fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.get_model_collection_by_uuid">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">get_model_collection_by_uuid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_uuid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlmt_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#get_model_collection_by_uuid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.get_model_collection_by_uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve model collection given a uuid.</p>
<dl>
<dt>Args:</dt><dd><p>model_uuid (str): model uuid</p>
<p>mlmt_client: Ignored</p>
</dd>
<dt>Returns:</dt><dd><p>Matching collection name</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError if there is no collection containing a model with the given uuid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.get_model_training_data_by_uuid">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">get_model_training_data_by_uuid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uuid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#get_model_training_data_by_uuid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.get_model_training_data_by_uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve data used to train, validate, and test a model given the uuid</p>
<dl class="simple">
<dt>Args:</dt><dd><p>uuid (str): model uuid</p>
</dd>
<dt>Returns:</dt><dd><p>a tuple of datafraes containint training data, validation data, and test data including the compound ID, RDKIT SMILES, and response value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.save_model">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">save_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_tracker'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model.</p>
<p>Save the model files to the datastore and save the model metadata dict to the Mongo database.</p>
<dl>
<dt>Args:</dt><dd><p>pipeline (ModelPipeline object): the pipeline to use</p>
<p>collection_name (str): the name of the Mongo DB collection to use</p>
<p>log (bool): True if logs should be printed, default False</p>
<p>use_personal_client (bool): True if personal client should be used (i.e. for testing), default False</p>
</dd>
<dt>Returns:</dt><dd><p>None if insertion was successful, raises UnableToTarException, DatastoreInsertionException, MLMTClientInstantiationException
or MongoInsertionException otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_tracker.save_model_tarball">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_tracker.</span></code><code class="sig-name descname"><span class="pre">save_model_tarball</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_tarball_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_tracker.html#save_model_tarball"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_tracker.save_model_tarball" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model parameters, metadata and transformers as a portable gzipped tar archive.</p>
</dd></dl>

</div>
<div class="section" id="module-pipeline.model_wrapper">
<span id="pipeline-model-wrapper-module"></span><h2>pipeline.model_wrapper module<a class="headerlink" href="#module-pipeline.model_wrapper" title="Permalink to this headline">¶</a></h2>
<p>Contains class ModelWrapper and its subclasses, which are wrappers for DeepChem and scikit-learn model classes.</p>
<dl class="py class">
<dt id="pipeline.model_wrapper.DCNNModelWrapper">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_wrapper.</span></code><code class="sig-name descname"><span class="pre">DCNNModelWrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.model_wrapper.ModelWrapper" title="pipeline.model_wrapper.ModelWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.model_wrapper.ModelWrapper</span></code></a></p>
<p>Contains methods to load in a dataset, split and featurize the data, fit a model to the train dataset,
generate predictions for an input dataset, and generate performance metrics for these predictions.</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>Set in __init__</dt><dd><p>params (argparse.Namespace): The argparse.Namespace parameter object that contains all parameter information
featurziation (Featurization object): The featurization object created outside of model_wrapper</p>
<p>log (log): The logger</p>
<p>output_dir (str): The parent path of the model directory</p>
<p>transformers (list): Initialized as an empty list, stores the transformers on the response col</p>
<p>transformers_x (list): Initialized as an empty list, stores the transformers on the featurizers</p>
<p>model_dir (str): The subdirectory under output_dir that contains the model. Created in setup_model_dirs.</p>
<p>best_model_dir (str): The subdirectory under output_dir that contains the best model. Created in setup_model_dirs</p>
<p>g: The tensorflow graph object</p>
<p>sess: The tensor flow graph session</p>
<p>model: The dc.models.GraphConvModel, MultitaskRegressor, or MultitaskClassifier object, as specified by the params attribute</p>
</dd>
<dt>Created in train:</dt><dd><p>data (ModelDataset): contains the dataset, set in pipeline</p>
<p>best_epoch (int): Initialized as None, keeps track of the epoch with the best validation score</p>
<dl class="simple">
<dt>train_perf_data (np.array of PerfData): Initialized as an empty array, </dt><dd><p>contains the predictions and performance of the training dataset</p>
</dd>
<dt>valid_perf_data (np.array of PerfData): Initialized as an empty array,</dt><dd><p>contains the predictions and performance of the validation dataset</p>
</dd>
<dt>train_epoch_perfs (np.array of dicts): Initialized as an empty array,</dt><dd><p>contains a list of dictionaries of predicted values and metrics on the training dataset</p>
</dd>
<dt>valid_epoch_perfs (np.array of dicts): Initialized as an empty array,</dt><dd><p>contains a list of dictionaries of predicted values and metrics on the validation dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.generate_predictions">
<code class="sig-name descname"><span class="pre">generate_predictions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.generate_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.generate_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates predictions for specified dataset with current model, as well as standard deviations
if params.uncertainty=True</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset: the deepchem DiskDataset to generate predictions for</p>
</dd>
<dt>Returns:</dt><dd><p>(pred, std): tuple of predictions for compounds and standard deviation estimates, if requested.
Each element of tuple is a numpy array of shape (ncmpds, ntasks, nclasses), where nclasses = 1 for regression
models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.get_model_specific_metadata">
<code class="sig-name descname"><span class="pre">get_model_specific_metadata</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.get_model_specific_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.get_model_specific_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of parameter settings for this ModelWrapper object that are specific
to neural network models.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>model_spec_metdata (dict): A dictionary of the parameter sets for the DCNNModelWrapper object.</dt><dd><p>Parameters are saved under the key ‘nn_specific’ as a subdictionary.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.get_perf_data">
<code class="sig-name descname"><span class="pre">get_perf_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.get_perf_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.get_perf_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics from a training, validation or test subset
of the current dataset, or the full dataset. subset may be ‘train’, ‘valid’, ‘test’ or ‘full’,
epoch_label indicates the training epoch we want results for; currently the
only option for this is ‘best’. Results are returned as a PerfData object of the appropriate class 
for the model’s split strategy and prediction type.</p>
<dl>
<dt>Args:</dt><dd><p>subset (str): Label for the current subset of the dataset (choices [‘train’,’valid’,’test’,’full’])</p>
<p>epoch_label (str): Label for the training epoch we want results for (choices [‘best’])</p>
</dd>
<dt>Returns:</dt><dd><p>PerfData object: Performance object pulled from the appropriate subset</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if epoch_label not in [‘best’]</p>
<p>ValueError: If subset not in [‘train’,’valid’,’test’,’full’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.get_pred_results">
<code class="sig-name descname"><span class="pre">get_pred_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.get_pred_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.get_pred_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics from a training, validation or test subset
of the current dataset, or the full dataset. subset may be ‘train’, ‘valid’, ‘test’
accordingly.  epoch_label indicates the training epoch we want results for; currently the
only option for this is ‘best’.  Results are returned as a dictionary of parameter, value pairs.</p>
<dl>
<dt>Args:</dt><dd><p>subset (str): Label for the current subset of the dataset (choices [‘train’,’valid’,’test’,’full’])</p>
<p>epoch_label (str): Label for the training epoch we want results for (choices [‘best’])</p>
</dd>
<dt>Returns:</dt><dd><p>dict: A dictionary of parameter/ value pairs of the prediction values and results of the dataset subset</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if epoch_label not in [‘best’]</p>
<p>ValueError: If subset not in [‘train’,’valid’,’test’,’full’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.recreate_model">
<code class="sig-name descname"><span class="pre">recreate_model</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.recreate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.recreate_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new DeepChem Model object of the correct type for the requested featurizer and prediction type 
and returns it.</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.reload_model">
<code class="sig-name descname"><span class="pre">reload_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reload_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.reload_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.reload_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved neural net model from the specified directory.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>reload_dir (str): Directory where saved model is located.
model_dataset (ModelDataset Object): contains the current full dataset</p>
</dd>
<dt>Side effects:</dt><dd><p>Resets the value of model, transformers, and transformers_x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.train">
<code class="sig-name descname"><span class="pre">train</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a neural net model for multiple epochs, choose the epoch with the best validation
set performance, refits the model for that number of epochs, and saves the tuned model.</p>
<dl>
<dt>Args:</dt><dd><p>pipeline (ModelPipeline): The ModelPipeline instance for this model run.</p>
</dd>
<dt>Side effects:</dt><dd><dl>
<dt>Sets the following attributes for DCNNModelWrapper:</dt><dd><p>data (ModelDataset): contains the dataset, set in pipeline</p>
<p>best_epoch (int): Initialized as None, keeps track of the epoch with the best validation score</p>
<dl class="simple">
<dt>train_perf_data (list of PerfData): Initialized as an empty array, </dt><dd><p>contains the predictions and performance of the training dataset</p>
</dd>
<dt>valid_perf_data (list of PerfData): Initialized as an empty array,</dt><dd><p>contains the predictions and performance of the validation dataset</p>
</dd>
<dt>train_epoch_perfs (np.array): Initialized as an empty array,</dt><dd><p>contains a list of dictionaries of predicted values and metrics on the training dataset</p>
</dd>
<dt>valid_epoch_perfs (np.array of dicts): Initialized as an empty array,</dt><dd><p>contains a list of dictionaries of predicted values and metrics on the validation dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.train_kfold_cv">
<code class="sig-name descname"><span class="pre">train_kfold_cv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.train_kfold_cv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.train_kfold_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a neural net model with K-fold cross-validation for a specified number of epochs.
Finds the epoch with the best validation set performance averaged over folds, then refits 
a model for the same number of epochs to the combined training and validation data.</p>
<dl>
<dt>Args:</dt><dd><p>pipeline (ModelPipeline): The ModelPipeline instance for this model run.</p>
</dd>
<dt>Side effects:</dt><dd><dl>
<dt>Sets the following attributes for DCNNModelWrapper:</dt><dd><p>data (ModelDataset): contains the dataset, set in pipeline</p>
<p>best_epoch (int): Initialized as None, keeps track of the epoch with the best validation score</p>
<dl class="simple">
<dt>train_perf_data (list of PerfData): Initialized as an empty array, </dt><dd><p>contains the predictions and performance of the training dataset</p>
</dd>
<dt>valid_perf_data (list of PerfData): Initialized as an empty array,</dt><dd><p>contains the predictions and performance of the validation dataset</p>
</dd>
<dt>train_epoch_perfs (np.array): Contains a standard training set performance metric (r2_score or roc_auc), averaged over folds,</dt><dd><p>at the end of each epoch.</p>
</dd>
<dt>valid_epoch_perfs (np.array): Contains a standard validation set performance metric (r2_score or roc_auc), averaged over folds,</dt><dd><p>at the end of each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCNNModelWrapper.train_with_early_stopping">
<code class="sig-name descname"><span class="pre">train_with_early_stopping</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCNNModelWrapper.train_with_early_stopping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCNNModelWrapper.train_with_early_stopping" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a neural net model for up to self.params.max_epochs epochs, while tracking the validation
set metric given by params.model_choice_score_type. Saves a model checkpoint each time the metric
is improved over its previous saved value by more than a threshold percentage. If the metric fails to
improve for more than a specified ‘patience’ number of epochs, stop training and revert the model state
to the last saved checkpoint.</p>
<dl>
<dt>Args:</dt><dd><p>pipeline (ModelPipeline): The ModelPipeline instance for this model run.</p>
</dd>
<dt>Side effects:</dt><dd><dl>
<dt>Sets the following attributes for DCNNModelWrapper:</dt><dd><p>data (ModelDataset): contains the dataset, set in pipeline</p>
<p>best_epoch (int): Initialized as None, keeps track of the epoch with the best validation score</p>
<p>best_validation_score (float): The best validation model choice score attained during training.</p>
<dl class="simple">
<dt>train_perf_data (list of PerfData): Initialized as an empty array, </dt><dd><p>contains the predictions and performance of the training dataset</p>
</dd>
<dt>valid_perf_data (list of PerfData): Initialized as an empty array,</dt><dd><p>contains the predictions and performance of the validation dataset</p>
</dd>
</dl>
<p>train_epoch_perfs (np.array): A standard training set performance metric (r2_score or roc_auc), at the end of each epoch.</p>
<p>valid_epoch_perfs (np.array): A standard validation set performance metric (r2_score or roc_auc), at the end of each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.model_wrapper.DCRFModelWrapper">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_wrapper.</span></code><code class="sig-name descname"><span class="pre">DCRFModelWrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCRFModelWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCRFModelWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.model_wrapper.ModelWrapper" title="pipeline.model_wrapper.ModelWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.model_wrapper.ModelWrapper</span></code></a></p>
<p>Contains methods to load in a dataset, split and featurize the data, fit a model to the train dataset,
generate predictions for an input dataset, and generate performance metrics for these predictions.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>Set in __init__</dt><dd><p>params (argparse.Namespace): The argparse.Namespace parameter object that contains all parameter information
featurization (Featurization object): The featurization object created outside of model_wrapper
log (log): The logger
output_dir (str): The parent path of the model directory
transformers (list): Initialized as an empty list, stores the transformers on the response col
transformers_x (list): Initialized as an empty list, stores the transformers on the featurizers
model_dir (str): The subdirectory under output_dir that contains the model. Created in setup_model_dirs.
best_model_dir (str): The subdirectory under output_dir that contains the best model. Created in setup_model_dirs
model: The dc.models.sklearn_models.SklearnModel as specified by the params attribute</p>
</dd>
<dt>Created in train:</dt><dd><p>data (ModelDataset): contains the dataset, set in pipeline
best_epoch (int): Set to 0, not applicable to deepchem random forest models
train_perf_data (PerfData): Contains the predictions and performance of the training dataset
valid_perf_data (PerfData): Contains the predictions and performance of the validation dataset
train_perfs (dict): A dictionary of predicted values and metrics on the training dataset
valid_perfs (dict): A dictionary of predicted values and metrics on the training dataset</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.model_wrapper.DCRFModelWrapper.generate_predictions">
<code class="sig-name descname"><span class="pre">generate_predictions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCRFModelWrapper.generate_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCRFModelWrapper.generate_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates predictions for specified dataset, as well as uncertainty values if params.uncertainty=True</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset: the deepchem DiskDataset to generate predictions for</p>
</dd>
<dt>Returns:</dt><dd><p>(pred, std): numpy arrays containing predictions for compounds and the standard error estimates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCRFModelWrapper.get_model_specific_metadata">
<code class="sig-name descname"><span class="pre">get_model_specific_metadata</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCRFModelWrapper.get_model_specific_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCRFModelWrapper.get_model_specific_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of parameter settings for this ModelWrapper object that are specific
to random forest models.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>model_spec_metadata (dict): Returns random forest specific metadata as a subdict under the key ‘rf_specific’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCRFModelWrapper.get_perf_data">
<code class="sig-name descname"><span class="pre">get_perf_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCRFModelWrapper.get_perf_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCRFModelWrapper.get_perf_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics from a training, validation or test subset
of the current dataset, or the full dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>subset (str): may be ‘train’, ‘valid’, ‘test’ or ‘full’
epoch_label (not used in random forest, but kept as part of the method structure)</p>
</dd>
<dt>Results:</dt><dd><p>PerfData object: Subclass of perfdata object associated with the appropriate subset’s split strategy and prediction type.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if subset not in [‘train’,’valid’,’test’,’full’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCRFModelWrapper.get_pred_results">
<code class="sig-name descname"><span class="pre">get_pred_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCRFModelWrapper.get_pred_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCRFModelWrapper.get_pred_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics from a training, validation or test subset
of the current dataset, or the full dataset.</p>
<dl>
<dt>Args:</dt><dd><p>subset: ‘train’, ‘valid’, ‘test’ or ‘full’ accordingly.</p>
<p>epoch_label: ignored; this function always returns the results for the current model.</p>
</dd>
<dt>Returns:</dt><dd><p>A dictionary of parameter, value pairs, in the format expected by the
prediction_results element of the ModelMetrics data.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if subset not in [‘train’,’valid’,’test’,’full’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCRFModelWrapper.reload_model">
<code class="sig-name descname"><span class="pre">reload_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reload_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCRFModelWrapper.reload_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCRFModelWrapper.reload_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved random forest model from the specified directory. Also loads any transformers that
were saved with it.</p>
<dl>
<dt>Args:</dt><dd><p>reload_dir (str): Directory where saved model is located.</p>
<p>model_dataset (ModelDataset Object): contains the current full dataset</p>
</dd>
<dt>Side effects:</dt><dd><p>Resets the value of model, transformers, and transformers_x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCRFModelWrapper.train">
<code class="sig-name descname"><span class="pre">train</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCRFModelWrapper.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCRFModelWrapper.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a random forest model and saves the trained model.</p>
<dl>
<dt>Args:</dt><dd><p>pipeline (ModelPipeline): The ModelPipeline instance for this model run.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Side effects:</dt><dd><p>data (ModelDataset): contains the dataset, set in pipeline</p>
<p>best_epoch (int): Set to 0, not applicable to deepchem random forest models</p>
<p>train_perf_data (PerfData): Contains the predictions and performance of the training dataset</p>
<p>valid_perf_data (PerfData): Contains the predictions and performance of the validation dataset</p>
<p>train_perfs (dict): A dictionary of predicted values and metrics on the training dataset</p>
<p>valid_perfs (dict): A dictionary of predicted values and metrics on the training dataset</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.model_wrapper.DCxgboostModelWrapper">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_wrapper.</span></code><code class="sig-name descname"><span class="pre">DCxgboostModelWrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCxgboostModelWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCxgboostModelWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.model_wrapper.ModelWrapper" title="pipeline.model_wrapper.ModelWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.model_wrapper.ModelWrapper</span></code></a></p>
<p>Contains methods to load in a dataset, split and featurize the data, fit a model to the train dataset,
generate predictions for an input dataset, and generate performance metrics for these predictions.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>Set in __init__</dt><dd><p>params (argparse.Namespace): The argparse.Namespace parameter object that contains all parameter information
featurization (Featurization object): The featurization object created outside of model_wrapper
log (log): The logger
output_dir (str): The parent path of the model directory
transformers (list): Initialized as an empty list, stores the transformers on the response col
transformers_x (list): Initialized as an empty list, stores the transformers on the featurizers
model_dir (str): The subdirectory under output_dir that contains the model. Created in setup_model_dirs.
best_model_dir (str): The subdirectory under output_dir that contains the best model. Created in setup_model_dirs
model: The dc.models.sklearn_models.SklearnModel as specified by the params attribute</p>
</dd>
<dt>Created in train:</dt><dd><p>data (ModelDataset): contains the dataset, set in pipeline
best_epoch (int): Set to 0, not applicable
train_perf_data (PerfObjects): Contains the predictions and performance of the training dataset
valid_perf_data (PerfObjects): Contains the predictions and performance of the validation dataset
train_perfs (dict): A dictionary of predicted values and metrics on the training dataset
valid_perfs (dict): A dictionary of predicted values and metrics on the validation dataset</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.model_wrapper.DCxgboostModelWrapper.generate_predictions">
<code class="sig-name descname"><span class="pre">generate_predictions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCxgboostModelWrapper.generate_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCxgboostModelWrapper.generate_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates predictions for specified dataset, as well as uncertainty values if params.uncertainty=True</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset: the deepchem DiskDataset to generate predictions for</p>
</dd>
<dt>Returns:</dt><dd><p>(pred, std): numpy arrays containing predictions for compounds and the standard error estimates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCxgboostModelWrapper.get_model_specific_metadata">
<code class="sig-name descname"><span class="pre">get_model_specific_metadata</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCxgboostModelWrapper.get_model_specific_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCxgboostModelWrapper.get_model_specific_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of parameter settings for this ModelWrapper object that are specific
to xgboost models.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>model_spec_metadata (dict): Returns xgboost specific metadata as a subdict under the key ‘xgb_specific’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCxgboostModelWrapper.get_perf_data">
<code class="sig-name descname"><span class="pre">get_perf_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCxgboostModelWrapper.get_perf_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCxgboostModelWrapper.get_perf_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics from a training, validation or test subset
of the current dataset, or the full dataset.</p>
<dl>
<dt>Args:</dt><dd><p>subset (str): may be ‘train’, ‘valid’, ‘test’ or ‘full’</p>
<p>epoch_label (not used in random forest, but kept as part of the method structure)</p>
</dd>
<dt>Results:</dt><dd><p>PerfData object: Subclass of perfdata object associated with the appropriate subset’s split strategy and prediction type.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if subset not in [‘train’,’valid’,’test’,’full’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCxgboostModelWrapper.get_pred_results">
<code class="sig-name descname"><span class="pre">get_pred_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCxgboostModelWrapper.get_pred_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCxgboostModelWrapper.get_pred_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics from a training, validation or test subset
of the current dataset, or the full dataset.</p>
<dl>
<dt>Args:</dt><dd><p>subset: ‘train’, ‘valid’, ‘test’ or ‘full’ accordingly.</p>
<p>epoch_label: ignored; this function always returns the results for the current model.</p>
</dd>
<dt>Returns:</dt><dd><p>A dictionary of parameter, value pairs, in the format expected by the
prediction_results element of the ModelMetrics data.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if subset not in [‘train’,’valid’,’test’,’full’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCxgboostModelWrapper.reload_model">
<code class="sig-name descname"><span class="pre">reload_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reload_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCxgboostModelWrapper.reload_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCxgboostModelWrapper.reload_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved xgboost model from the specified directory. Also loads any transformers that
were saved with it.</p>
<dl>
<dt>Args:</dt><dd><p>reload_dir (str): Directory where saved model is located.</p>
<p>model_dataset (ModelDataset Object): contains the current full dataset</p>
</dd>
<dt>Side effects:</dt><dd><p>Resets the value of model, transformers, and transformers_x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.DCxgboostModelWrapper.train">
<code class="sig-name descname"><span class="pre">train</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#DCxgboostModelWrapper.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.DCxgboostModelWrapper.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a xgboost model and saves the trained model.</p>
<dl>
<dt>Args:</dt><dd><p>pipeline (ModelPipeline): The ModelPipeline instance for this model run.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Side effects:</dt><dd><p>data (ModelDataset): contains the dataset, set in pipeline</p>
<p>best_epoch (int): Set to 0, not applicable to deepchem xgboost models</p>
<p>train_perf_data (PerfData): Contains the predictions and performance of the training dataset</p>
<p>valid_perf_data (PerfData): Contains the predictions and performance of the validation dataset</p>
<p>train_perfs (dict): A dictionary of predicted values and metrics on the training dataset</p>
<p>valid_perfs (dict): A dictionary of predicted values and metrics on the training dataset</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.model_wrapper.ModelWrapper">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.model_wrapper.</span></code><code class="sig-name descname"><span class="pre">ModelWrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wrapper for DeepChem and sklearn model objects. Provides methods to train and test a model,
generate predictions for an input dataset, and generate performance metrics for these predictions.</p>
<blockquote>
<div><p>Attributes:
Set in __init__</p>
<blockquote>
<div><p>params (argparse.Namespace): The argparse.Namespace parameter object that contains all parameter information</p>
<p>featurziation (Featurization object): The featurization object created outside of model_wrapper</p>
<p>log (log): The logger</p>
<p>output_dir (str): The parent path of the model directory</p>
<p>transformers (list): Initialized as an empty list, stores the transformers on the response col</p>
<p>transformers_x (list): Initialized as an empty list, stores the transformers on the featurizers</p>
</div></blockquote>
<dl class="simple">
<dt>set in setup_model_dirs:</dt><dd><p>best_model_dir (str): The subdirectory under output_dir that contains the best model. Created in setup_model_dirs</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.create_transformers">
<code class="sig-name descname"><span class="pre">create_transformers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.create_transformers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.create_transformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize transformers for responses and/or features, and persist them for later.</p>
<dl>
<dt>Args:</dt><dd><p>model_dataset: The ModelDataset object that handles the current dataset</p>
</dd>
<dt>Side effects</dt><dd><dl>
<dt>Overwrites the attributes:</dt><dd><p>transformers: A list of deepchem transformation objects on response_col, only if conditions are met</p>
<p>transformers_x: A list of deepchem transformation objects on featurizers, only if conditions are met.</p>
<p>params.transformer_key: A string pointing to the dataset key containing the transformer in the datastore, or the path to the transformer</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.generate_predictions">
<code class="sig-name descname"><span class="pre">generate_predictions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.generate_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.generate_predictions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><p>dataset:</p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.get_full_dataset_perf_data">
<code class="sig-name descname"><span class="pre">get_full_dataset_perf_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.get_full_dataset_perf_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.get_full_dataset_perf_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the predicted values and metrics from the current model for the full current dataset,
as a PerfData object.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model_dataset (DiskDataset): Stores the current dataset and related methods</p>
</dd>
<dt>Returns:</dt><dd><p>perf_data: PerfData object containing the predicted values and metrics for the current full dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.get_full_dataset_pred_results">
<code class="sig-name descname"><span class="pre">get_full_dataset_pred_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.get_full_dataset_pred_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.get_full_dataset_pred_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics from the current model for the full current dataset,
as a dictionary in the format expected by the model tracker.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model_dataset (DiskDataset): Stores the current dataset and related methods</p>
</dd>
<dt>Returns:</dt><dd><p>dict: A dictionary containing predicted values and metrics for the current full dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.get_model_specific_metadata">
<code class="sig-name descname"><span class="pre">get_model_specific_metadata</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.get_model_specific_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.get_model_specific_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of parameter settings for this ModelWrapper object that are specific
to the model type.</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.get_num_features">
<code class="sig-name descname"><span class="pre">get_num_features</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.get_num_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.get_num_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of dimensions of the feature space, taking both featurization method
and transformers into account.</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.get_test_perf_data">
<code class="sig-name descname"><span class="pre">get_test_perf_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.get_test_perf_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.get_test_perf_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the predicted values and metrics for the current test dataset against
the version of the model stored in model_dir, as a PerfData object.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model_dir (str): Directory where the saved model is stored
model_dataset (DiskDataset): Stores the current dataset and related methods</p>
</dd>
<dt>Returns:</dt><dd><p>perf_data: PerfData object containing the predicted values and metrics for the current test dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.get_test_pred_results">
<code class="sig-name descname"><span class="pre">get_test_pred_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.get_test_pred_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.get_test_pred_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics for the current test dataset against the version
of the model stored in model_dir, as a dictionary in the format expected by the model tracker.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model_dir (str): Directory where the saved model is stored
model_dataset (DiskDataset): Stores the current dataset and related methods</p>
</dd>
<dt>Returns:</dt><dd><p>dict: A dictionary containing the prediction values and metrics for the current dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.get_train_valid_pred_results">
<code class="sig-name descname"><span class="pre">get_train_valid_pred_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perf_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.get_train_valid_pred_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.get_train_valid_pred_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns predicted values and metrics for the training, validation or test set
associated with the PerfData object perf_data. Results are returned as a dictionary 
of parameter, value pairs in the format expected by the model tracker.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>perf_data: A PerfData object that stores the predicted values and metrics</p>
</dd>
<dt>Returns:</dt><dd><p>dict: A dictionary of the prediction results</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.model_save">
<code class="sig-name descname"><span class="pre">model_save</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.model_save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.model_save" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper function to save a model  due to the <cite>DeepChem model.save()</cite> has inconsistent implementation.</p>
<p>The <cite>SKlearnModel()</cite> class and xgboost model in DeepChem use <cite>model.save()</cite>,
while the <cite>MultitaskRegressor</cite> class uses <cite>model.save_checkpoint()</cite>. The
workaround is to try <cite>model.save()</cite> first. If failed, then try <cite>model.save_checkpoint()</cite></p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.reload_model">
<code class="sig-name descname"><span class="pre">reload_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reload_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.reload_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.reload_model" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><p>reload_dir:</p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.setup_model_dirs">
<code class="sig-name descname"><span class="pre">setup_model_dirs</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.setup_model_dirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.setup_model_dirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up paths and directories for persisting models at particular training epochs, used by
the DeepChem model classes.</p>
<dl class="simple">
<dt>Side effects:</dt><dd><dl class="simple">
<dt>Sets the following attributes of ModelWrapper:</dt><dd><p>best_model_dir (str): The subdirectory under output_dir that contains the best model. Created in setup_model_dirs</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.train">
<code class="sig-name descname"><span class="pre">train</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a model (for multiple epochs if applicable), and saves the tuned model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>pipeline (ModelPipeline): The ModelPipeline instance for this model run.</p>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.model_wrapper.ModelWrapper.transform_dataset">
<code class="sig-name descname"><span class="pre">transform_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#ModelWrapper.transform_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.ModelWrapper.transform_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the responses and/or features in the given DeepChem dataset using the current transformers.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset: The DeepChem DiskDataset that contains a dataset</p>
</dd>
<dt>Returns:</dt><dd><p>transformed_dataset: The transformed DeepChem DiskDataset</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pipeline.model_wrapper.create_model_wrapper">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_wrapper.</span></code><code class="sig-name descname"><span class="pre">create_model_wrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#create_model_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.create_model_wrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory function for creating Model objects of the correct subclass for params.model_type.</p>
<dl>
<dt>Args:</dt><dd><p>params (Namespace): Parameters passed to the model pipeline</p>
<p>featurizer (Featurization): Object managing the featurization of compounds</p>
<p>ds_client (DatastoreClient): Interface to the file datastore</p>
</dd>
<dt>Returns:</dt><dd><p>model (pipeline.Model): Wrapper for DeepChem, sklearn or other model.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: Only params.model_type = ‘NN’, ‘RF’ or ‘xgboost’ is supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.model_wrapper.dc_restore">
<code class="sig-prename descclassname"><span class="pre">pipeline.model_wrapper.</span></code><code class="sig-name descname"><span class="pre">dc_restore</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/model_wrapper.html#dc_restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.model_wrapper.dc_restore" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload the values of all variables from a checkpoint file.</p>
<p>copied from DeepChem 2.3 keras_model.py to silence warnings caused
when a model is loaded in inference mode.</p>
<dl>
<dt>Args:</dt><dd><p>model (DeepChem.KerasModel: keras model to restore</p>
<dl class="simple">
<dt>checkpoint (str): the path to the checkpoint file to load.  If this is None, the most recent</dt><dd><p>checkpoint will be chosen automatically.  Call get_checkpoints() to get a
list of all available checkpoints.</p>
</dd>
<dt>model_dir (str): default None</dt><dd><p>Directory to restore checkpoint from. If None, use model.model_dir.</p>
</dd>
<dt>session (tf.Session()) default None</dt><dd><p>Session to run restore ops under. If None, model.session is used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.parameter_parser">
<span id="pipeline-parameter-parser-module"></span><h2>pipeline.parameter_parser module<a class="headerlink" href="#module-pipeline.parameter_parser" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pipeline.parameter_parser.dict_to_list">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">dict_to_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp_dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_spaces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#dict_to_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.dict_to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to convert dictionary to a modified list of strings for input to argparse. Adds a ‘–’ in front of keys
in the dictionary.</p>
<dl>
<dt>Args:</dt><dd><p>inp_dictionary (dict): Flat dictionary of parameters</p>
<p>replae_spaces (bool): A flag for replace spaces with replace_spaces_str for handling spaces in command line.</p>
</dd>
<dt>Returns:</dt><dd><p>(list): a list of default parameters + user specified parameters</p>
<p>None if inp_dictionary is None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.flatten_dict">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">flatten_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#flatten_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.flatten_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to flatten a hierarchical dictionary. Used in parse_config_file(). Throws error if there are duplicated
keys in the dictionary. WARNING: immediately throws error upon first detection of duplications.</p>
<dl>
<dt>Args:</dt><dd><p>inp_dict(dict): hierarchical dictionary</p>
<p>newdict(empty dict): empty dictionary, name of output flattened dictionary</p>
</dd>
<dt>Returns:</dt><dd><p>newdict(dict): Flattened dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.get_parser">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">get_parser</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#get_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.get_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that performs the actual parsing of pre-processed parameters. Modify this method to add/change/remove
parameters</p>
<p>Args: None</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>parser (argparse.Namespace): an object containing default parameters + user specific parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.list_defaults">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">list_defaults</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyperparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#list_defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.list_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates temporary required variables, to generate a Namespace.argparse object of defaults.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>argparse.Namespace: a Namespace.argparse object containing default parameters + user specified parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.main">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">main</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argument</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry point when script is run from a shell</p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.parse_command_line">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">parse_command_line</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#parse_command_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.parse_command_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a command line argument or a specifically formatted list of strings into a Namespace.argparse object.</p>
<dl class="simple">
<dt>String input is in the following format:</dt><dd><p>args = [‘–arg1’,’val1’,’–arg2’,’val2’,’–arg3’,’val3’]</p>
</dd>
<dt>Args:</dt><dd><p>args(None or list): If args is none, parse_command_line parses sys.argv if it . If args is a list, the list is
parsed</p>
</dd>
<dt>Returns:</dt><dd><p>parsed_args (argparse.Namespace): an object containing default parameters + user specific parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.parse_config_file">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">parse_config_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#parse_config_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.parse_config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>“Method to convert a .json configuration file to a Namespace object. Does the following conversions:
.json -&gt; hierarchical dict -&gt; flat dict -&gt; dict_to_list.
WARNING: if there are two identical parameters on the same hierarchical level in the config.json, the .json will
inherently silence the parameter higher up on the list without flagging a duplication. However, duplicate
parameters in two different hierarchies or subdictionaries will be flagged by this parser.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>config_file_path(str): PATH to configuration .json file</p>
</dd>
<dt>Returns:</dt><dd><p>argparse.Namespace: a Namespace.argparse object containing default parameters + user specified parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.parse_namespace">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">parse_namespace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">namespace_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#parse_namespace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.parse_namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to convert namespace object to dictionary, then pass the value to dict_to_list. Will simply pass a
dictionary</p>
<dl class="simple">
<dt>Args:</dt><dd><p>namespace_params(dictionary or namespace.argparse object)</p>
</dd>
<dt>Returns:</dt><dd><p>argparse.Namespace: a Namespace.argparse object containing default parameters + user specified parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.postprocess_args">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">postprocess_args</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#postprocess_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.postprocess_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Postprocessing for the parsed arguments.
Replaces any string in null_options with a NoneType</p>
<p>Replaces any string that matches replace_with_space with whitespace.</p>
<p>Parses arguments in convert_to_float_list into a list of floats, if the hyperparams option is True.
E.g. parsed_args.dropouts = “0.001,0.001 0.002,0.002 0.03,003”</p>
<blockquote>
<div><p>-&gt; parsed_args.dropouts = [[0.001,0.001], [0.002,0.002], [0.03,003]]</p>
</div></blockquote>
<p>Parses arguments in convert_to_int_list into a list of ints, if the hyperparams options is True.
E.g. parsed_args.layer_sizes = “10,100 20,200 30,300”</p>
<blockquote>
<div><p>-&gt; parsed_args.layer_sizes = [[10,100], [20,200], [30,300]]</p>
</div></blockquote>
<p>Parameters in keep_as_list are kept as lists, even if there is a single item in the list.</p>
<p>Parameters in convert_to_str_list are converted to a list of strings.
E.g. parsed_args.model_type = “NN,RF”</p>
<blockquote>
<div><p>-&gt; parsed_args.model_type = [‘NN’,’RF’].</p>
</div></blockquote>
<p>If there is a single item in the list (no commas), the repsonse is kept as a StringType, unless it is in
response_cols, which is passed as a list</p>
<p>Setting conditional options for descriptor_key.</p>
<dl>
<dt>Args:</dt><dd><p>parsed_args (argparse.Namespace): Raw parsed arguments.</p>
</dd>
<dt>Returns:</dt><dd><p>parsed_args (argparse.Namespace): a argparse.Namespace object containing properly processed arguments.</p>
</dd>
<dt>Raises:</dt><dd><p>Exception: layer_sizes, dropouts, weight_init_stddevs and bias_init_consts arguments must be the same length</p>
<p>Exception: parameters within not_a_list_outside_of_hyperparams are not accepted as a list if hyperparams
is False</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.prune_defaults">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">prune_defaults</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#prune_defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.prune_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes parameters that are not in keep_params or in get_defaults</p>
<dl>
<dt>Args:</dt><dd><p>params (argparse.Namespace): Raw parsed arguments.</p>
<p>keep_params (list): List of parameters to keep</p>
</dd>
<dt>Returns:</dt><dd><p>new_dict (dict): Pruned argument dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.to_str">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">to_str</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#to_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.to_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a namespace.argparse object or a dict into a string for command line input</p>
<dl>
<dt>Args:</dt><dd><p>params_obj (argparse.Namespace or dict): an argparse namespace object or dict to be converted into a
command line input.</p>
<blockquote>
<div><p>E.g. params_obj = argparse.Namespace(arg1 = val1, arg2 = val2, arg3 = val3) OR
params_obj = {‘arg1’:val1, ‘arg2’:val2, ‘arg3’:val3}</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>str_params (str): parameters in string format</dt><dd><p>E.g. str_params = ‘–arg1 val1 –arg2 val2 –arg3 val3’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.parameter_parser.wrapper">
<code class="sig-prename descclassname"><span class="pre">pipeline.parameter_parser.</span></code><code class="sig-name descname"><span class="pre">wrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">any_arg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/parameter_parser.html#wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.parameter_parser.wrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>“Wrapper to handle the ParseParams class. Calls the correct method depending on the input argument type</p>
<dl class="simple">
<dt>Args:</dt><dd><p><a href="#id1"><span class="problematic" id="id2">*</span></a>any_arg: any single input of a str, dict, argparse.Namespace, or list</p>
</dd>
<dt>Returns:</dt><dd><p>argparse.Namespace: a Namespace.argparse object containing default parameters + user specified parameters</p>
</dd>
<dt>Raises:</dt><dd><p>TypeError: Input argument must be a configuration file (str), dict, argparse.Namespace, or list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.perf_data">
<span id="pipeline-perf-data-module"></span><h2>pipeline.perf_data module<a class="headerlink" href="#module-pipeline.perf_data" title="Permalink to this headline">¶</a></h2>
<p>Contains class PerfData and its subclasses, which are objects for collecting and computing model performance metrics
and predictions</p>
<dl class="py class">
<dt id="pipeline.perf_data.ClassificationPerfData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">ClassificationPerfData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#ClassificationPerfData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.ClassificationPerfData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.perf_data.PerfData" title="pipeline.perf_data.PerfData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.perf_data.PerfData</span></code></a></p>
<p>Class with methods for accumulating classification model prediction data over multiple
cross-validation folds and computing performance metrics after all folds have been run.
Abstract class with concrete subclasses for different split strategies.</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>set in __init__</dt><dd><p>num_tasks (int): Set to None, the number of tasks</p>
<p>num_cmpds (int): Set to None, the number of compounds</p>
<p>num_classes (int): Set to None, the number of classes</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.perf_data.ClassificationPerfData.accumulate_preds">
<code class="sig-name descname"><span class="pre">accumulate_preds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_stds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#ClassificationPerfData.accumulate_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.ClassificationPerfData.accumulate_preds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.ClassificationPerfData.get_pred_values">
<code class="sig-name descname"><span class="pre">get_pred_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#ClassificationPerfData.get_pred_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.ClassificationPerfData.get_pred_values" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.ClassificationPerfData.get_prediction_results">
<code class="sig-name descname"><span class="pre">get_prediction_results</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#ClassificationPerfData.get_prediction_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.ClassificationPerfData.get_prediction_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of performance metrics for a classification model.
The dictionary values will contain only primitive Python types, so that it can
be easily JSONified.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>per_task (bool): True if calculating per-task metrics, False otherwise.</p>
</dd>
<dt>Returns:</dt><dd><p>pred_results (dict): dictionary of performance metrics for a classification model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.ClassificationPerfData.model_choice_score">
<code class="sig-name descname"><span class="pre">model_choice_score</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'roc_auc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#ClassificationPerfData.model_choice_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.ClassificationPerfData.model_choice_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a score function based on the accumulated predicted values, to be used for selecting
the best training epoch and other hyperparameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>score_type (str): The name of the scoring metric to be used, e.g. ‘roc_auc’, ‘precision’,</dt><dd><p>‘recall’, ‘f1’; see 
<a class="reference external" href="https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter">https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</a>
and sklearn.metrics.SCORERS.keys() for a complete list of options.
Larger values of the score function indicate better models.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>score (float): A score function value. For multitask models, this will be averaged</dt><dd><p>over tasks.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.perf_data.KFoldClassificationPerfData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">KFoldClassificationPerfData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldClassificationPerfData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldClassificationPerfData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.perf_data.ClassificationPerfData" title="pipeline.perf_data.ClassificationPerfData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.perf_data.ClassificationPerfData</span></code></a></p>
<p>Class with methods for accumulating classification model performance data over multiple
cross-validation folds and computing performance metrics after all folds have been run.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>Set in __init__:</dt><dd><p>subset (str): Label of the type of subset of dataset for tracking predictions
num_cmps (int): The number of compounds in the dataset
num_tasks (int): The number of tasks in the dataset
pred-vals (dict): The dictionary of prediction results
folds (int): Initialized at zero, flag for determining which k-fold is being assessed 
transformers (list of Transformer objects): from input arguments
real_vals (dict): The dictionary containing the origin response column values
class_names (np.array): Assumes the classes are of deepchem index type (e.g. 0,1,2,…)
num_classes (int): The number of classes to predict on</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.perf_data.KFoldClassificationPerfData.accumulate_preds">
<code class="sig-name descname"><span class="pre">accumulate_preds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_stds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldClassificationPerfData.accumulate_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldClassificationPerfData.accumulate_preds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add training, validation or test set predictions from the current fold to the data structure
where we keep track of them.</p>
<dl>
<dt>Args:</dt><dd><p>predicted_vals (np.array): Array of the predicted values for the current dataset</p>
<p>ids (np.array): An np.array of compound ids for the current dataset</p>
<p>pred_stds (np.array): An array of the standard deviation in the predictions, not used in this method</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Side effects:</dt><dd><p>Overwrites the attribute pred_vals</p>
<p>Increments folds by 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.KFoldClassificationPerfData.compute_perf_metrics">
<code class="sig-name descname"><span class="pre">compute_perf_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldClassificationPerfData.compute_perf_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldClassificationPerfData.compute_perf_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the ROC AUC metrics for each task based on the accumulated values, averaged over
training folds, along with standard deviations of the scores. If per_task is False, the scores 
are averaged over tasks and the overall standard deviation is reported instead.</p>
<dl>
<dt>Args:</dt><dd><p>per_task (bool): True if calculating per-task metrics, False otherwise.</p>
</dd>
<dt>Returns:</dt><dd><p>A tuple (roc_auc_mean, roc_auc_std):</p>
<blockquote>
<div><p>roc_auc_mean: A numpy array of mean ROC AUC scores for each task, averaged over folds, if per_task is
True.</p>
<blockquote>
<div><p>Otherwise, a float giving the ROC AUC score averaged over both folds and tasks.</p>
</div></blockquote>
<dl class="simple">
<dt>roc_auc_std:  A numpy array of standard deviations over folds of ROC AUC values, if per_task is True.</dt><dd><p>Otherwise, a float giving the overall standard deviation.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.KFoldClassificationPerfData.get_pred_values">
<code class="sig-name descname"><span class="pre">get_pred_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldClassificationPerfData.get_pred_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldClassificationPerfData.get_pred_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the predicted values accumulated over training, with any transformations undone.  If self.subset 
is ‘train’, ‘train_valid’ or ‘test’, the function will return the means and standard deviations of the class probabilities 
over the training folds for each compound, for each task.  Otherwise, returns a single set of predicted probabilites for 
each validation set compound. For all subsets, returns the compound IDs and the most probable classes for each task.</p>
<dl>
<dt>Returns:</dt><dd><p>ids (list): list of compound IDs.</p>
<p>pred_classes (np.array): an (ncmpds, ntasks) array of predicted classes.</p>
<p>class_probs (np.array): a (ncmpds, ntasks, nclasses) array of predicted probabilities for the classes, and</p>
<p>prob_stds (np.array): a (ncmpds, ntasks, nclasses) array of standard errors over folds for the class
probability estimates (only available for the ‘train’ and ‘test’ subsets; None otherwise).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.KFoldClassificationPerfData.get_real_values">
<code class="sig-name descname"><span class="pre">get_real_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldClassificationPerfData.get_real_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldClassificationPerfData.get_real_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the real dataset response values as an (ncmpds, ntasks, nclasses) array of indicator bits
(if nclasses &gt; 2) or an (ncmpds, ntasks) array of binary classes (if nclasses == 2),
with compound IDs in the same order as in the return from get_pred_values() (unless ids is specified).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ids (list of str): Optional list of compound IDs to return values for.</p>
</dd>
<dt>Returns:</dt><dd><p>np.array of shape (ncmpds, tasks, nclasses): of either indicator bits or a 2D array of binary classes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.KFoldClassificationPerfData.get_weights">
<code class="sig-name descname"><span class="pre">get_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldClassificationPerfData.get_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldClassificationPerfData.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dataset response weights, as an (ncmpds, ntasks) array
in the same ID order as get_pred_values() (unless ids is specified).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ids (list of str): Optional list of compound IDs to return values for.</p>
</dd>
<dt>Returns:</dt><dd><p>np.array (ncmpds, ntasks) of the real dataset response weights, in the same
ID order as get_pred_values().</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.perf_data.KFoldRegressionPerfData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">KFoldRegressionPerfData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldRegressionPerfData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldRegressionPerfData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.perf_data.RegressionPerfData" title="pipeline.perf_data.RegressionPerfData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.perf_data.RegressionPerfData</span></code></a></p>
<p>Class with methods for accumulating regression model prediction data over multiple
cross-validation folds and computing performance metrics after all folds have been run.</p>
<dl>
<dt>Arguments:</dt><dd><dl>
<dt>Set in __init__:</dt><dd><p>subset (str): Label of the type of subset of dataset for tracking predictions</p>
<p>num_cmps (int): The number of compounds in the dataset</p>
<p>num_tasks (int): The number of tasks in the dataset</p>
<p>pred-vals (dict): The dictionary of prediction results</p>
<p>folds (int): Initialized at zero, flag for determining which k-fold is being assessed</p>
<p>transformers (list of Transformer objects): from input arguments</p>
<p>real_vals (dict): The dictionary containing the origin response column values</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.perf_data.KFoldRegressionPerfData.accumulate_preds">
<code class="sig-name descname"><span class="pre">accumulate_preds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_stds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldRegressionPerfData.accumulate_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldRegressionPerfData.accumulate_preds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add training, validation or test set predictions from the current fold to the data structure
where we keep track of them.</p>
<dl>
<dt>Args:</dt><dd><p>predicted_vals (np.array): Array of the predicted values for the current dataset</p>
<p>ids (np.array): An np.array of compound ids for the current dataset</p>
<p>pred_stds (np.array): An array of the standard deviation in the predictions, not used in this method</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If Predicted value dimensions don’t match num_tasks for RegressionPerfData</p>
</dd>
<dt>Side effects:</dt><dd><p>Overwrites the attribute pred_vals</p>
<p>Increments folds by 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.KFoldRegressionPerfData.compute_perf_metrics">
<code class="sig-name descname"><span class="pre">compute_perf_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldRegressionPerfData.compute_perf_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldRegressionPerfData.compute_perf_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the R-squared metrics for each task based on the accumulated values, averaged over
training folds, along with standard deviations of the scores. If per_task is False, the scores 
are averaged over tasks and the overall standard deviation is reported instead.</p>
<dl>
<dt>Args:</dt><dd><p>per_task (bool): True if calculating per-task metrics, False otherwise.</p>
</dd>
<dt>Returns:</dt><dd><p>A tuple (r2_mean, r2_std):</p>
<blockquote>
<div><dl class="simple">
<dt>r2_mean: A numpy array of mean R^2 scores for each task, averaged over folds, if per_task is True.</dt><dd><p>Otherwise, a float giving the R^2 score averaged over both folds and tasks.</p>
</dd>
<dt>r2_std:  A numpy array of standard deviations over folds of R^2 values, if per_task is True.</dt><dd><p>Otherwise, a float giving the overall standard deviation.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.KFoldRegressionPerfData.get_pred_values">
<code class="sig-name descname"><span class="pre">get_pred_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldRegressionPerfData.get_pred_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldRegressionPerfData.get_pred_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the predicted values accumulated over training, with any transformations undone.
If self.subset is ‘train’ or ‘test’, the function will return averages over the training folds for each compound
along with standard deviations when there are predictions from multiple folds. Otherwise, returns a
single predicted value for each compound.</p>
<dl>
<dt>Returns:</dt><dd><p>ids (np.array): list of compound IDs</p>
<p>vals (np.array): (ncmpds, ntasks) array of mean predicted values</p>
<p>fold_stds (np.array): (ncmpds, ntasks) array of standard deviations over folds if applicable, and None
otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.KFoldRegressionPerfData.get_real_values">
<code class="sig-name descname"><span class="pre">get_real_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldRegressionPerfData.get_real_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldRegressionPerfData.get_real_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the real dataset response values, with any transformations undone, as an (ncmpds, ntasks) array
in the same ID order as get_pred_values() (unless ids is specified).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ids (list of str): Optional list of compound IDs to return values for.</p>
</dd>
<dt>Returns:</dt><dd><p>np.array (ncmpds, ntasks) of the real dataset response values, with any transformations undone, in the same
ID order as get_pred_values().</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.KFoldRegressionPerfData.get_weights">
<code class="sig-name descname"><span class="pre">get_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#KFoldRegressionPerfData.get_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.KFoldRegressionPerfData.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dataset response weights, as an (ncmpds, ntasks) array
in the same ID order as get_pred_values() (unless ids is specified).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ids (list of str): Optional list of compound IDs to return values for.</p>
</dd>
<dt>Returns:</dt><dd><p>np.array (ncmpds, ntasks) of the real dataset response weights, in the same
ID order as get_pred_values().</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.perf_data.PerfData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">PerfData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#PerfData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.PerfData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class with methods for accumulating prediction data over multiple cross-validation folds
and computing performance metrics after all folds have been run. Abstract class with
concrete subclasses for classification and regression models.</p>
<dl class="py method">
<dt id="pipeline.perf_data.PerfData.accumulate_preds">
<code class="sig-name descname"><span class="pre">accumulate_preds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_stds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#PerfData.accumulate_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.PerfData.accumulate_preds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.PerfData.compute_perf_metrics">
<code class="sig-name descname"><span class="pre">compute_perf_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#PerfData.compute_perf_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.PerfData.compute_perf_metrics" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.PerfData.get_pred_values">
<code class="sig-name descname"><span class="pre">get_pred_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#PerfData.get_pred_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.PerfData.get_pred_values" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.PerfData.get_prediction_results">
<code class="sig-name descname"><span class="pre">get_prediction_results</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#PerfData.get_prediction_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.PerfData.get_prediction_results" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.PerfData.get_real_values">
<code class="sig-name descname"><span class="pre">get_real_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#PerfData.get_real_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.PerfData.get_real_values" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.PerfData.get_weights">
<code class="sig-name descname"><span class="pre">get_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#PerfData.get_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.PerfData.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dataset response weights as an (ncmpds, ntasks) array</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.perf_data.RegressionPerfData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">RegressionPerfData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#RegressionPerfData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.RegressionPerfData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.perf_data.PerfData" title="pipeline.perf_data.PerfData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.perf_data.PerfData</span></code></a></p>
<p>Class with methods for accumulating regression model prediction data over multiple
cross-validation folds and computing performance metrics after all folds have been run.
Abstract class with concrete subclasses for different split strategies.</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>set in __init__</dt><dd><p>num_tasks (int): Set to None, the number of tasks</p>
<p>num_cmpds (int): Set to None, the number of compounds</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.perf_data.RegressionPerfData.accumulate_preds">
<code class="sig-name descname"><span class="pre">accumulate_preds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_stds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#RegressionPerfData.accumulate_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.RegressionPerfData.accumulate_preds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.RegressionPerfData.compute_perf_metrics">
<code class="sig-name descname"><span class="pre">compute_perf_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#RegressionPerfData.compute_perf_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.RegressionPerfData.compute_perf_metrics" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.RegressionPerfData.get_pred_values">
<code class="sig-name descname"><span class="pre">get_pred_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#RegressionPerfData.get_pred_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.RegressionPerfData.get_pred_values" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.RegressionPerfData.get_prediction_results">
<code class="sig-name descname"><span class="pre">get_prediction_results</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#RegressionPerfData.get_prediction_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.RegressionPerfData.get_prediction_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of performance metrics for a regression model.
The dictionary values should contain only primitive Python types, so that it can
be easily JSONified.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>per_task (bool): True if calculating per-task metrics, False otherwise.</p>
</dd>
<dt>Returns:</dt><dd><p>pred_results (dict): dictionary of performance metrics for a regression model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.RegressionPerfData.model_choice_score">
<code class="sig-name descname"><span class="pre">model_choice_score</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#RegressionPerfData.model_choice_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.RegressionPerfData.model_choice_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a score function based on the accumulated predicted values, to be used for selecting
the best training epoch and other hyperparameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>score_type (str): The name of the scoring metric to be used, e.g. ‘r2’,</dt><dd><p>‘neg_mean_squared_error’, ‘neg_mean_absolute_error’, etc.; see
<a class="reference external" href="https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter">https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</a>
and sklearn.metrics.SCORERS.keys() for a complete list of options.
Larger values of the score function indicate better models.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>score (float): A score function value. For multitask models, this will be averaged</dt><dd><p>over tasks.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.perf_data.SimpleClassificationPerfData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">SimpleClassificationPerfData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleClassificationPerfData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleClassificationPerfData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.perf_data.ClassificationPerfData" title="pipeline.perf_data.ClassificationPerfData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.perf_data.ClassificationPerfData</span></code></a></p>
<p>Class with methods for collecting classification model prediction and performance data from single-fold
training and prediction runs.</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>Set in __init__:</dt><dd><p>subset (str): Label of the type of subset of dataset for tracking predictions</p>
<p>num_cmps (int): The number of compounds in the dataset</p>
<p>num_tasks (int): The number of tasks in the dataset</p>
<p>pred-vals (dict): The dictionary of prediction results</p>
<p>folds (int): Initialized at zero, flag for determining which k-fold is being assessed</p>
<p>transformers (list of Transformer objects): from input arguments</p>
<p>real_vals (dict): The dictionary containing the origin response column values</p>
<p>class_names (np.array): Assumes the classes are of deepchem index type (e.g. 0,1,2,…)</p>
<p>num_classes (int): The number of classes to predict on</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.perf_data.SimpleClassificationPerfData.accumulate_preds">
<code class="sig-name descname"><span class="pre">accumulate_preds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_stds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleClassificationPerfData.accumulate_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleClassificationPerfData.accumulate_preds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add training, validation or test set predictions from the current dataset to the data structure
where we keep track of them.</p>
<dl>
<dt>Arguments:</dt><dd><p>predicted_vals (np.array): Array of predicted values (class probabilities)</p>
<p>ids (list): List of the compound ids of the dataset</p>
<p>pred_stds (np.array): Optional np.array of the prediction standard deviations</p>
</dd>
<dt>Side effects:</dt><dd><p>Updates self.pred_vals and self.perf_metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.SimpleClassificationPerfData.compute_perf_metrics">
<code class="sig-name descname"><span class="pre">compute_perf_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleClassificationPerfData.compute_perf_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleClassificationPerfData.compute_perf_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ROC_AUC metrics for each task based on the accumulated predictions. If
per_task is False, returns the average ROC AUC over tasks.</p>
<dl>
<dt>Args:</dt><dd><p>per_task (bool): Whether to return individual ROC AUC scores for each task</p>
</dd>
<dt>Returns:</dt><dd><dl>
<dt>A tuple (roc_auc, std):</dt><dd><dl class="simple">
<dt>roc_auc: A numpy array of ROC AUC scores, if per_task is True. Otherwise,</dt><dd><p>a float giving the mean ROC AUC score over tasks.</p>
</dd>
</dl>
<p>std:     Placeholder for an array of standard deviations. Always None for this class.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.SimpleClassificationPerfData.get_pred_values">
<code class="sig-name descname"><span class="pre">get_pred_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleClassificationPerfData.get_pred_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleClassificationPerfData.get_pred_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the predicted values accumulated over training, with any transformations undone.
If self.subset is ‘train’, the function will average class probabilities over the k-1 folds in which each
compound was part of the training set, and return the most probable class. Otherwise, there should be a
single set of predicted probabilites for each validation or test set compound. Returns a tuple (ids,
pred_classes, class_probs, prob_stds), where ids is the list of compound IDs, pred_classes is an
(ncmpds, ntasks) array of predicted classes, class_probs is a (ncmpds, ntasks, nclasses) array of predicted
probabilities for the classes, and prob_stds is a (ncmpds, ntasks, nclasses) array of standard errors for the
class probability estimates.</p>
<dl>
<dt>Returns:</dt><dd><dl>
<dt>Tuple (ids, pred_classes, class_probs, prob_stds)</dt><dd><p>ids (list): Contains the dataset compound ids</p>
<p>pred_classes (np.array): Contains (ncmpds, ntasks) array of prediction classes</p>
<p>class_probs (np.array): Contains (ncmpds, ntasks, nclasses) array of predict class probabilities</p>
<p>prob_stds (np.array): Contains (ncmpds, ntasks, nclasses) array of standard errors for the class
probability estimates</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.SimpleClassificationPerfData.get_real_values">
<code class="sig-name descname"><span class="pre">get_real_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleClassificationPerfData.get_real_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleClassificationPerfData.get_real_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the real dataset response values as an (ncmpds, ntasks, nclasses) array of indicator bits.
If nclasses == 2, the returned array has dimension (ncmpds, ntasks).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ids: Ignored for this class</p>
</dd>
<dt>Returns:</dt><dd><p>np.array of the response values of the real dataset as indicator bits</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.SimpleClassificationPerfData.get_weights">
<code class="sig-name descname"><span class="pre">get_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleClassificationPerfData.get_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleClassificationPerfData.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dataset response weights</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ids: Ignored for this class</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: Containing the dataset response weights</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.perf_data.SimpleRegressionPerfData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">SimpleRegressionPerfData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleRegressionPerfData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleRegressionPerfData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.perf_data.RegressionPerfData" title="pipeline.perf_data.RegressionPerfData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.perf_data.RegressionPerfData</span></code></a></p>
<p>Class with methods for accumulating regression model prediction data from training,
validation or test sets and computing performance metrics.</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>Set in __init__:</dt><dd><p>subset (str): Label of the type of subset of dataset for tracking predictions</p>
<p>num_cmps (int): The number of compounds in the dataset</p>
<p>num_tasks (int): The number of tasks in the dataset</p>
<p>pred-vals (dict): The dictionary of prediction results</p>
<p>folds (int): Initialized at zero, flag for determining which k-fold is being assessed</p>
<p>transformers (list of Transformer objects): from input arguments</p>
<p>real_vals (dict): The dictionary containing the origin response column values</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.perf_data.SimpleRegressionPerfData.accumulate_preds">
<code class="sig-name descname"><span class="pre">accumulate_preds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_stds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleRegressionPerfData.accumulate_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleRegressionPerfData.accumulate_preds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add training, validation or test set predictions to the data structure
where we keep track of them.</p>
<dl>
<dt>Args:</dt><dd><p>predicted_vals (np.array): Array of predicted values</p>
<p>ids (list): List of the compound ids of the dataset</p>
<p>pred_stds (np.array): Optional np.array of the prediction standard deviations</p>
</dd>
<dt>Side effects:</dt><dd><p>Reshapes the predicted values and the standard deviations (if they are given)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.SimpleRegressionPerfData.compute_perf_metrics">
<code class="sig-name descname"><span class="pre">compute_perf_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleRegressionPerfData.compute_perf_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleRegressionPerfData.compute_perf_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the R-squared metrics for each task or averaged over tasks based on the accumulated values</p>
<dl>
<dt>Args:</dt><dd><p>per_task (bool): True if calculating per-task metrics, False otherwise.</p>
</dd>
<dt>Returns:</dt><dd><dl>
<dt>A tuple (r2_score, std): </dt><dd><p>r2_score (np.array): An array of scores for each task, if per_task is True.
Otherwise, it is a float containing the average R^2 score over tasks.</p>
<p>std: Always None for this class.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.SimpleRegressionPerfData.get_pred_values">
<code class="sig-name descname"><span class="pre">get_pred_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleRegressionPerfData.get_pred_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleRegressionPerfData.get_pred_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the predicted values accumulated over training, with any transformations undone.  Returns
a tuple (ids, values, stds), where ids is the list of compound IDs, values is a (ncmpds, ntasks) array
of predictions, and stds is always None for this class.</p>
<dl>
<dt>Returns:</dt><dd><dl>
<dt>Tuple (ids, vals, stds)</dt><dd><p>ids (list): Contains the dataset compound ids</p>
<p>vals (np.array): Contains (ncmpds, ntasks) array of prediction</p>
<p>stds (np.array): Contains (ncmpds, ntasks) array of prediction standard deviations</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.SimpleRegressionPerfData.get_real_values">
<code class="sig-name descname"><span class="pre">get_real_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleRegressionPerfData.get_real_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleRegressionPerfData.get_real_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the real dataset response values, with any transformations undone, as an (ncmpds, ntasks) array
with compounds in the same ID order as in the return from get_pred_values().</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ids: Ignored for this class</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: Containing the real dataset response values with transformations undone.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.perf_data.SimpleRegressionPerfData.get_weights">
<code class="sig-name descname"><span class="pre">get_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#SimpleRegressionPerfData.get_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.SimpleRegressionPerfData.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dataset response weights as an (ncmpds, ntasks) array</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ids: Ignored for this class</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: Containing the dataset response weights</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pipeline.perf_data.create_perf_data">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">create_perf_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#create_perf_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.create_perf_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory function that creates the right kind of PerfData object for the given subset,
prediction_type (classification or regression) and split strategy (k-fold or train/valid/test).</p>
<dl>
<dt>Args:</dt><dd><p>prediction_type (str): classification or regression.</p>
<p>model_dataset (ModelDataset): Object representing the full dataset.</p>
<p>transformers (list): A list of transformer objects.</p>
<p>subset (str): Label in [‘train’, ‘valid’, ‘test’, ‘full’], indicating the type of subset of dataset for tracking predictions</p>
<p><a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs: Additional PerfData subclass arguments</p>
</dd>
<dt>Returns:</dt><dd><p>PerfData object</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if split_strategy not in [‘train_valid_test’,’k_fold_cv’]
ValueError: prediction_type not in [‘regression’,’classification’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.perf_data.negative_predictive_value">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">negative_predictive_value</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#negative_predictive_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.negative_predictive_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes negative predictive value of a binary classification model: NPV = TN/(TN+FN).</p>
<dl>
<dt>Args:</dt><dd><p>y_real (np.array): Array of ground truth values</p>
<p>y_pred (np.array): Array of predicted values</p>
</dd>
<dt>Returns:</dt><dd><p>(float): The negative predictive value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.perf_data.rms_error">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_data.</span></code><code class="sig-name descname"><span class="pre">rms_error</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_data.html#rms_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_data.rms_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the root mean squared error. Score function used for model selection.</p>
<dl>
<dt>Args:</dt><dd><p>y_real (np.array): Array of ground truth values</p>
<p>y_pred (np.array): Array of predicted values</p>
</dd>
<dt>Returns:</dt><dd><p>(np.array): root mean squared error of the input</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.perf_plots">
<span id="pipeline-perf-plots-module"></span><h2>pipeline.perf_plots module<a class="headerlink" href="#module-pipeline.perf_plots" title="Permalink to this headline">¶</a></h2>
<p>Plotting routines for visualizing performance of regression and classification models</p>
<dl class="py function">
<dt id="pipeline.perf_plots.plot_ROC_curve">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_plots.</span></code><code class="sig-name descname"><span class="pre">plot_ROC_curve</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_plots.html#plot_ROC_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_plots.plot_ROC_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot ROC curves for a classification model.</p>
<dl>
<dt>Args:</dt><dd><p>MP (<cite>ModelPipeline</cite>): Pipeline object for a model that was trained in the current Python session.</p>
<p>epoch_label (str): Label for training epoch to draw predicted values from. Currently ‘best’ is the only allowed value.</p>
<p>pdf_dir (str): If given, output the plots to a PDF file in the given directory.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.perf_plots.plot_perf_vs_epoch">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_plots.</span></code><code class="sig-name descname"><span class="pre">plot_perf_vs_epoch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_plots.html#plot_perf_vs_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_plots.plot_perf_vs_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the current NN model’s standard performance metric (r2_score or roc_auc_score) vs epoch number for the training,
validation and test subsets. If the model was trained with k-fold CV, plot shading for the validation set out to += 1 SD from the mean
score metric values, and plot the training and test set metrics from the final model retraining rather than the cross-validation
phase. Make a second plot showing the validation set model choice score used for ranking training epochs and other hyperparameters
against epoch number.</p>
<dl>
<dt>Args:</dt><dd><p>MP (<cite>ModelPipeline</cite>): Pipeline object for a model that was trained in the current Python session.</p>
<p>pdf_dir (str): If given, output the plots to a PDF file in the given directory.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.perf_plots.plot_prec_recall_curve">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_plots.</span></code><code class="sig-name descname"><span class="pre">plot_prec_recall_curve</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_plots.html#plot_prec_recall_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_plots.plot_prec_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot precision-recall curves for a classification model.</p>
<dl>
<dt>Args:</dt><dd><p>MP (<cite>ModelPipeline</cite>): Pipeline object for a model that was trained in the current Python session.</p>
<p>epoch_label (str): Label for training epoch to draw predicted values from. Currently ‘best’ is the only allowed value.</p>
<p>pdf_dir (str): If given, output the plots to a PDF file in the given directory.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.perf_plots.plot_pred_vs_actual">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_plots.</span></code><code class="sig-name descname"><span class="pre">plot_pred_vs_actual</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_bars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_plots.html#plot_pred_vs_actual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_plots.plot_pred_vs_actual" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot predicted vs actual values from a trained regression model for each split subset (train,
valid, and test).</p>
<dl>
<dt>Args:</dt><dd><p>MP (<cite>ModelPipeline</cite>): Pipeline object for a model that was trained in the current Python session.</p>
<p>epoch_label (str): Label for training epoch to draw predicted values from. Currently ‘best’ is the only allowed value.</p>
<p>threshold (float): Threshold activity value to mark on plot with dashed lines.</p>
<dl class="simple">
<dt>error_bars (bool): If true and if uncertainty estimates are included in the model predictions, draw error bars</dt><dd><p>at +- 1 SD from the predicted y values.</p>
</dd>
</dl>
<p>pdf_dir (str): If given, output the plots to a PDF file in the given directory.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.perf_plots.plot_umap_feature_projections">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_plots.</span></code><code class="sig-name descname"><span class="pre">plot_umap_feature_projections</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_to_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_plots.html#plot_umap_feature_projections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_plots.plot_umap_feature_projections" title="Permalink to this definition">¶</a></dt>
<dd><p>Projects features of a model’s input dataset using UMAP to 2D or 3D coordinates and draws a scatterplot.
Shape-codes plot markers to indicate whether the associated compound was in the training, validation or
test set. For classification models, also uses the marker shape to indicate whether the compound’s class was correctly
predicted, and uses color to indicate whether the true class was active or inactive. For regression models, uses
the marker color to indicate the discrepancy between the predicted and actual values.</p>
<dl>
<dt>Args:</dt><dd><p>MP (<cite>ModelPipeline</cite>): Pipeline object for a model that was trained in the current Python session.</p>
<p>ndim (int): Number of dimensions (2 or 3) to project features into.</p>
<dl class="simple">
<dt>num_neighbors (int): Number of nearest neighbors used by UMAP for manifold approximation.</dt><dd><p>Larger values give a more global view of the data, while smaller values preserve more local detail.</p>
</dd>
</dl>
<p>min_dist (float): Parameter used by UMAP to set minimum distance between projected points.</p>
<dl class="simple">
<dt>fit_to_train (bool): If true (the default), fit the UMAP projection to the training set feature vectors only.</dt><dd><p>Otherwise, fit it to the entire dataset.</p>
</dd>
<dt>dist_metric (str): Name of metric to use for initial distance matrix computation. Check UMAP documentation</dt><dd><p>for supported values. The metric should be appropriate for the type of features used in the model (fingerprints
or descriptors); note that <cite>jaccard</cite> is equivalent to Tanimoto distance for ECFP fingerprints.</p>
</dd>
<dt>dist_metric_kwds (dict): Additional key-value pairs used to parameterize dist_metric; see the UMAP documentation.</dt><dd><p>In particular, dist_metric_kwds[‘p’] specifies the power/exponent for the Minkowski metric.</p>
</dd>
<dt>target_weight (float): Weighting factor determining balance between activities and feature values in determining topology</dt><dd><p>of projected points. A weight of zero prioritizes the feature vectors; weight = 1 prioritizes the activity values,
so that compounds with the same activity tend to be clustered together.</p>
</dd>
</dl>
<p>random_seed (int): Seed for random number generator.</p>
<p>pdf_dir (str): If given, output the plot to a PDF file in the given directory.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.perf_plots.plot_umap_train_set_neighbors">
<code class="sig-prename descclassname"><span class="pre">pipeline.perf_plots.</span></code><code class="sig-name descname"><span class="pre">plot_umap_train_set_neighbors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_metric_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/perf_plots.html#plot_umap_train_set_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.perf_plots.plot_umap_train_set_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Project features of whole dataset to 2 dimensions, without regard to response values. Plot training &amp; validation set
or training and test set compounds, color- and symbol-coded according to actual classification and split set.
The plot does not take predicted values into account at all. Does not work with regression data.</p>
<dl>
<dt>Args:</dt><dd><p>MP (<cite>ModelPipeline</cite>): Pipeline object for a model that was trained in the current Python session.</p>
<dl class="simple">
<dt>num_neighbors (int): Number of nearest neighbors used by UMAP for manifold approximation.</dt><dd><p>Larger values give a more global view of the data, while smaller values preserve more local detail.</p>
</dd>
</dl>
<p>min_dist (float): Parameter used by UMAP to set minimum distance between projected points.</p>
<dl class="simple">
<dt>dist_metric (str): Name of metric to use for initial distance matrix computation. Check UMAP documentation</dt><dd><p>for supported values. The metric should be appropriate for the type of features used in the model (fingerprints
or descriptors); note that <cite>jaccard</cite> is equivalent to Tanimoto distance for ECFP fingerprints.</p>
</dd>
<dt>dist_metric_kwds (dict): Additional key-value pairs used to parameterize dist_metric; see the UMAP documentation.</dt><dd><p>In particular, dist_metric_kwds[‘p’] specifies the power/exponent for the Minkowski metric.</p>
</dd>
</dl>
<p>random_seed (int): Seed for random number generator.</p>
<p>pdf_dir (str): If given, output the plot to a PDF file in the given directory.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.splitting">
<span id="pipeline-splitting-module"></span><h2>pipeline.splitting module<a class="headerlink" href="#module-pipeline.splitting" title="Permalink to this headline">¶</a></h2>
<p>Encapsulates everything that depends on how datasets are split: the splitting itself, training, validation,
testing, generation of predicted values and performance metrics.</p>
<dl class="py class">
<dt id="pipeline.splitting.KFoldSplitting">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">KFoldSplitting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#KFoldSplitting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.KFoldSplitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.splitting.Splitting" title="pipeline.splitting.Splitting"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.splitting.Splitting</span></code></a></p>
<p>Subclass to deal with everything related to k-fold cross-validation splits</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>Set in __init__:</dt><dd><p>params (Namespace object): contains all parameter information</p>
<p>split (str): Type of splitter in [‘index’,’random’,’scaffold’,’butina’,’ave_min’,’stratified’]</p>
<p>splitter (Deepchem split object): A splitting object of the subtype specified by split</p>
<p>num_folds (int): The number of k-fold splits to perform</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.splitting.KFoldSplitting.get_split_prefix">
<code class="sig-name descname"><span class="pre">get_split_prefix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#KFoldSplitting.get_split_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.KFoldSplitting.get_split_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string identifying the split strategy (TVT or k-fold) and the splitting method (index, scaffold,
etc.) for use in filenames, dataset keys, etc.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>parent (str): Default to empty string. Sets the parent directory for the output string</p>
</dd>
<dt>Returns:</dt><dd><p>(str): A string that identifies the split strategy and the splitting method. Appends a parent directory in
front of the fold description</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.splitting.KFoldSplitting.split_dataset">
<code class="sig-name descname"><span class="pre">split_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#KFoldSplitting.split_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.KFoldSplitting.split_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits dataset into training, testing and validation sets.</p>
<dl>
<dt>Args:</dt><dd><p>dataset (deepchem Dataset): full featurized dataset</p>
<p>attr_df (Pandas DataFrame): dataframe containing SMILES strings indexed by compound IDs,</p>
<p>smiles_col (string): name of SMILES column (hack for now until deepchem fixes scaffold and butina splitters)</p>
</dd>
<dt>Returns:</dt><dd><p>[(train, valid)], test, [(train_attr, valid_attr)], test_attr:</p>
<p>train (deepchem Dataset): training dataset.</p>
<p>valid (deepchem Dataset): validation dataset.</p>
<p>test (deepchem Dataset): testing dataset.</p>
<p>train_attr (Pandas DataFrame): dataframe of SMILES strings indexed by compound IDs for training set.</p>
<p>valid_attr (Pandas DataFrame): dataframe of SMILES strings indexed by compound IDs for validation set.</p>
<p>test_attr (Pandas DataFrame): dataframe of SMILES strings indexed by compound IDs for test set.</p>
</dd>
<dt>Raises:</dt><dd><p>Exception if there are duplicate ids or smiles strings in the dataset or the attr_df</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.splitting.Splitting">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">Splitting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#Splitting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.Splitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for train/validation/test and k-fold dataset splitting. Wrapper for DeepChem Splitter
classes that handle the specific splitting methods (e.g. random, scaffold, etc.).</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>Set in __init__:</dt><dd><p>params (Namespace object): contains all parameter information</p>
<p>split (str): Type of splitter in [‘index’,’random’,’scaffold’,’butina’,’ave_min’,’stratified’]</p>
<p>splitter (Deepchem split object): A splitting object of the subtype specified by split</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.splitting.Splitting.get_split_prefix">
<code class="sig-name descname"><span class="pre">get_split_prefix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#Splitting.get_split_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.Splitting.get_split_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Must be implemented by subclasses</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.splitting.Splitting.needs_smiles">
<code class="sig-name descname"><span class="pre">needs_smiles</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#Splitting.needs_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.Splitting.needs_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if underlying DeepChem splitter requires compound IDs to be SMILES strings</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>(bool): True if Deepchem splitter requires SMILES strings as compound IDs, currently only true if
using scaffold or butina splits</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.splitting.Splitting.split_dataset">
<code class="sig-name descname"><span class="pre">split_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#Splitting.split_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.Splitting.split_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Must be implemented by subclasses</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>NotImplementedError: The method is implemented by subclasses</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.splitting.TrainValidTestSplitting">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">TrainValidTestSplitting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#TrainValidTestSplitting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.TrainValidTestSplitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.splitting.Splitting" title="pipeline.splitting.Splitting"><code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline.splitting.Splitting</span></code></a></p>
<p>Subclass to deal with everything related to standard train/validation/test splits</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>Set in __init__:</dt><dd><p>params (Namespace object): contains all parameter information</p>
<p>split (str): Type of splitter in [‘index’,’random’,’scaffold’,’butina’,’ave_min’,’temporal’,’stratified’]</p>
<p>splitter (Deepchem split object): A splitting object of the subtype specified by split</p>
<p>num_folds (int): The number of k-fold splits to perform</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.splitting.TrainValidTestSplitting.get_split_prefix">
<code class="sig-name descname"><span class="pre">get_split_prefix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#TrainValidTestSplitting.get_split_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.TrainValidTestSplitting.get_split_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string identifying the split strategy (TVT or k-fold) and the splitting method
(index, scaffold, etc.) for use in filenames, dataset keys, etc.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>parent (str): Default to empty string. Sets the parent directory for the output string</p>
</dd>
<dt>Returns:</dt><dd><p>(str): A string that identifies the split strategy and the splitting method.
Appends a parent directory in front of the fold description</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pipeline.splitting.TrainValidTestSplitting.split_dataset">
<code class="sig-name descname"><span class="pre">split_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#TrainValidTestSplitting.split_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.TrainValidTestSplitting.split_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits dataset into training, testing and validation sets.</p>
<dl>
<dt>For ave_min, random, scaffold, index splits</dt><dd><p>self.params.split_valid_frac &amp; self.params.split_test_frac should be defined and 
train_frac = 1.0 - self.params.split_valid_frac - self.params.split_test_frac</p>
</dd>
<dt>For butina split, test size is not user defined, and depends on available clusters that qualify for placement in the test set</dt><dd><p>train_frac = 1.0 - self.params.split_valid_frac</p>
</dd>
<dt>For temporal split, test size is also not user defined, and depends on number of compounds with dates after cutoff date.</dt><dd><p>train_frac = 1.0 - self.params.split_valid_frac</p>
</dd>
<dt>Args:</dt><dd><p>dataset (deepchem Dataset): full featurized dataset</p>
<p>attr_df (Pandas DataFrame): dataframe containing SMILES strings indexed by compound IDs,</p>
<p>smiles_col (string): name of SMILES column (hack for now until deepchem fixes scaffold and butina splitters)</p>
</dd>
<dt>Returns:</dt><dd><p>[(train, valid)], test, [(train_attr, valid_attr)], test_attr:
train (deepchem Dataset): training dataset.</p>
<p>valid (deepchem Dataset): validation dataset.</p>
<p>test (deepchem Dataset): testing dataset.</p>
<p>train_attr (Pandas DataFrame): dataframe of SMILES strings indexed by compound IDs for training set.</p>
<p>valid_attr (Pandas DataFrame): dataframe of SMILES strings indexed by compound IDs for validation set.</p>
<p>test_attr (Pandas DataFrame): dataframe of SMILES strings indexed by compound IDs for test set.</p>
</dd>
<dt>Raises:</dt><dd><p>Exception if there are duplicate ids or smiles strings in the dataset or the attr_df</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pipeline.splitting.check_if_dupe_smiles_dataset">
<code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">check_if_dupe_smiles_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#check_if_dupe_smiles_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.check_if_dupe_smiles_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a boolean. True if there are duplication within the deepchem Dataset dataset.ids or if there are
duplicates in the smiles_col of the attr_df</p>
<dl>
<dt>Args:</dt><dd><p>dataset (deepchem Dataset): full featurized dataset</p>
<p>attr_df (Pandas DataFrame): dataframe containing SMILES strings indexed by compound IDs,</p>
<p>smiles_col (string): name of SMILES column (hack for now until deepchem fixes scaffold and butina splitters)</p>
</dd>
<dt>Returns:</dt><dd><p>(bool): True if there duplicates in the ids of the dataset or if there are duplicates in the smiles_col
of the attr_df. False if there are no duplicates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.splitting.create_splitting">
<code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">create_splitting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#create_splitting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.create_splitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory function to create appropriate type of Splitting object, based on dataset parameters</p>
<dl class="simple">
<dt>Args:</dt><dd><p>params (Namespace object): contains all parameter information.</p>
</dd>
<dt>Returns:</dt><dd><p>(Splitting object): Splitting subtype (TrainValidTestSplitting or KFoldSplitting)
determined by params.split_strategy</p>
</dd>
<dt>Raises:</dt><dd><p>Exception: If params.split_strategy not in [‘train_valid_test’,’k_fold_cv’]. Unsupported split strategy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.splitting.select_attrs_by_dset_ids">
<code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">select_attrs_by_dset_ids</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#select_attrs_by_dset_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.select_attrs_by_dset_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a subset of the data frame attr_df selected by matching compound IDs in the index of attr_df
against the ids in the dc.data.Dataset object dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dataset (DiskDataset): The deepchem dataset, should have matching ids with ids in attr_df</p>
<p>attr_df (DataFrame): Contains the compound ids. Ids should match with dataset</p>
</dd>
<dt>Returns:</dt><dd><p>subattr_df (DataFrame): A subset of attr_df as determined by the ids in dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.splitting.select_attrs_by_dset_smiles">
<code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">select_attrs_by_dset_smiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#select_attrs_by_dset_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.select_attrs_by_dset_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a subset of the data frame attr_df selected by matching SMILES strings in attr_df
against the ids in the dc.data.Dataset object dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dataset (DiskDataset): The deepchem dataset, should have matching ids with ids in attr_df</p>
<p>attr_df (DataFrame): Contains the compound ids. Ids should match with dataset. Should contain a column
of SMILES strings under the smiles_col</p>
<p>smiles_col (str): Name of the column containing smiles strings</p>
</dd>
<dt>Returns:</dt><dd><p>subattr_df (DataFrame): A subset of attr_df as determined by the ids in dataset. Selected by matching SMILES
strings in attr_df to the ids in the dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.splitting.select_dset_by_attr_ids">
<code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">select_dset_by_attr_ids</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#select_dset_by_attr_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.select_dset_by_attr_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a subset of the given dc.data.Dataset object selected by matching compound IDs in the index of attr_df
against the ids in the dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dataset (DiskDataset): The deepchem dataset, should have matching ids with ids in attr_df</p>
<p>attr_df (DataFrame): Contains the compound ids to subset the dataset. Ids should match with dataset</p>
</dd>
<dt>Returns:</dt><dd><p>subset (DiskDataset): A subset of the deepchem dataset as determined by the ids in attr_df</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.splitting.select_dset_by_id_list">
<code class="sig-prename descclassname"><span class="pre">pipeline.splitting.</span></code><code class="sig-name descname"><span class="pre">select_dset_by_id_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/splitting.html#select_dset_by_id_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.splitting.select_dset_by_id_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a subset of the given dc.data.Dataset object selected by matching compound IDs in the given list
against the ids in the dataset.</p>
<dl>
<dt>Args:</dt><dd><p>dataset (DiskDataset): The deepchem dataset, should have matching ids with ids in id_list</p>
<p>id_list (list): Contains a list of compound ids to subset the dataset. Ids should match with dataset</p>
</dd>
<dt>Returns:</dt><dd><p>subset (DiskDataset): A subset of the deepchem dataset as determined by the ids in id_list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline.transformations">
<span id="pipeline-transformations-module"></span><h2>pipeline.transformations module<a class="headerlink" href="#module-pipeline.transformations" title="Permalink to this headline">¶</a></h2>
<p>Classes providing different methods of transforming response data and/or features in datasets, beyond those
provided by DeepChem.</p>
<dl class="py class">
<dt id="pipeline.transformations.NormalizationTransformerMissingData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.transformations.</span></code><code class="sig-name descname"><span class="pre">NormalizationTransformerMissingData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform_X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#NormalizationTransformerMissingData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.NormalizationTransformerMissingData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">deepchem.trans.transformers.NormalizationTransformer</span></code></p>
<p>Test extension to check for missing data</p>
<dl class="py method">
<dt id="pipeline.transformations.NormalizationTransformerMissingData.transform">
<code class="sig-name descname"><span class="pre">transform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#NormalizationTransformerMissingData.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.NormalizationTransformerMissingData.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms all internally stored data.
Adds X-transform, y-transform columns to metadata.</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.transformations.NormalizationTransformerMissingData.transform_array">
<code class="sig-name descname"><span class="pre">transform_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#NormalizationTransformerMissingData.transform_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.NormalizationTransformerMissingData.transform_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the data in a set of (X, y, w) arrays.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pipeline.transformations.UMAPTransformer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pipeline.transformations.</span></code><code class="sig-name descname"><span class="pre">UMAPTransformer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#UMAPTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.UMAPTransformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">transformers.Transformer</span></code></p>
<p>Dimension reduction transformations using the UMAP algorithm.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>mapper (UMAP) : UMAP transformer
scaler (RobustScaler): Centering/scaling transformer</p>
</dd>
</dl>
<dl class="py method">
<dt id="pipeline.transformations.UMAPTransformer.transform">
<code class="sig-name descname"><span class="pre">transform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#UMAPTransformer.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.UMAPTransformer.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms all internally stored data.
Adds X-transform, y-transform columns to metadata.</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.transformations.UMAPTransformer.transform_array">
<code class="sig-name descname"><span class="pre">transform_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#UMAPTransformer.transform_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.UMAPTransformer.transform_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the data in a set of (X, y, w) arrays.</p>
</dd></dl>

<dl class="py method">
<dt id="pipeline.transformations.UMAPTransformer.untransform">
<code class="sig-name descname"><span class="pre">untransform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#UMAPTransformer.untransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.UMAPTransformer.untransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses stored transformation on provided data.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pipeline.transformations.create_feature_transformers">
<code class="sig-prename descclassname"><span class="pre">pipeline.transformations.</span></code><code class="sig-name descname"><span class="pre">create_feature_transformers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#create_feature_transformers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.create_feature_transformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a scaling and centering transformation to the feature matrix of the given dataset, and return a
DeepChem transformer object holding its parameters.</p>
<dl>
<dt>Args:</dt><dd><p>params (argparse.namespace: Object containing the parameter list</p>
<p>model_dataset (ModelDataset): Contains the dataset to be transformed.</p>
</dd>
<dt>Returns:</dt><dd><p>(list of DeepChem transformer objects): list of transformers for the feature matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.transformations.get_statistics_missing_ydata">
<code class="sig-prename descclassname"><span class="pre">pipeline.transformations.</span></code><code class="sig-name descname"><span class="pre">get_statistics_missing_ydata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#get_statistics_missing_ydata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.get_statistics_missing_ydata" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return statistics of this dataset.</p>
<p>This updated version gives the option to check for and ignore missing
values for the y variable only. The x variable still assumes no
missing values.</p>
</dd></dl>

<dl class="py function">
<dt id="pipeline.transformations.get_transformer_specific_metadata">
<code class="sig-prename descclassname"><span class="pre">pipeline.transformations.</span></code><code class="sig-name descname"><span class="pre">get_transformer_specific_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#get_transformer_specific_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.get_transformer_specific_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of parameters related to the currently selected transformer(s).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>params (argparse.namespace: Object containing the parameter list</p>
</dd>
<dt>Returns:</dt><dd><p>meta_dict (dict): Nested dictionary of parameters and values for each currently active
transformer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pipeline.transformations.transformers_needed">
<code class="sig-prename descclassname"><span class="pre">pipeline.transformations.</span></code><code class="sig-name descname"><span class="pre">transformers_needed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pipeline/transformations.html#transformers_needed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.transformations.transformers_needed" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a boolean indicating whether response and/or feature transformers would be
created for a model with the given parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>params (argparse.namespace: Object containing the parameter list</p>
</dd>
<dt>Returns:</dt><dd><p>boolean: True if transformers are required given the model parameters.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pipeline">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pipeline" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="utils.html" class="btn btn-neutral float-right" title="utils package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="modules.html" class="btn btn-neutral float-left" title="atomsci" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, ATOM DDM Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>